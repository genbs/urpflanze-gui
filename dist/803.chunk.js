(self.webpackChunk_genbs_urpflanze_gui=self.webpackChunk_genbs_urpflanze_gui||[]).push([[803],{25995:(e,t,n)=>{"use strict";function r(e){var t=a(e);if(t){if("hsl"===t.type){var n=function(e,t,n){var r,a,i;if(e/=360,n/=100,0==(t/=100))r=a=i=n;else{var o=function(e,t,n){return(n+=n<0?1:n>1?-1:0)<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},s=n<.5?n*(1+t):n+t-n*t,c=2*n-s;r=o(c,s,e+1/3),a=o(c,s,e),i=o(c,s,e-1/3)}return[.5+255*r<<0,.5+255*a<<0,.5+255*i<<0]}(t.a,t.b,t.c);return{r:n[0],g:n[1],b:n[2],h:t.a,s:t.b,l:t.c,alpha:t.alpha}}var r=function(e,t,n){e/=255,t/=255,n/=255;var r,a,i=Math.max(e,t,n),o=Math.min(e,t,n),s=(i+o)/2;if(i==o)r=a=0;else{var c=i-o;switch(a=s>.5?c/(2-i-o):c/(i+o),i){case e:r=(t-n)/c+(t<n?6:0);break;case t:r=(n-e)/c+2;break;case n:r=(e-t)/c+4}r/=6}return[.5+360*r<<0,.5+100*a<<0,.5+100*s<<0]}(t.a,t.b,t.c);return{h:r[0],s:r[1],l:r[2],r:t.a,g:t.b,b:t.c,alpha:t.alpha}}}function a(e){if("number"==typeof e)return e>16777215?{type:"rgb",a:e>>24&255,b:e>>16&255,c:e>>8&255,alpha:(255&e)/255}:{type:"rgb",a:e>>16&255,b:e>>8&255,c:255&e,alpha:1};e=e.replace(/\s/g,"");var t=/^#([0-9a-f]{3,8})$/i.exec(e);if(t){var n=t[1];return 3===n.length?{type:"rgb",a:parseInt(n[0]+n[0],16),b:parseInt(n[1]+n[1],16),c:parseInt(n[2]+n[2],16),alpha:1}:{type:"rgb",a:parseInt(n[0]+n[1],16),b:parseInt(n[2]+n[3],16),c:parseInt(n[4]+n[5],16),alpha:n.length>6?parseInt(n.substring(6),16)/255:1}}if(t=/^((hsl|rgb)a?)\((\d+),(\d+)%?,(\d+)%?,?(.+)?\)$/i.exec(e)){var r=t,a=r[2],i=r[3],o=r[4],s=r[5],c=r[6];return{type:a,a:+i,b:+o,c:+s,alpha:c?+c:1}}}n.d(t,{k0:()=>r,lu:()=>a})},66222:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{dL:()=>parseFunction,Oi:()=>cancelablePromise,zO:()=>now,Ux:()=>toDegrees,Yr:()=>toRadians,qo:()=>toArray,uZ:()=>clamp});var parseFunction={suffix:"$fn:",parse:function(e){return"function"==typeof e&&"SimpleAnimation"!==e.name?parseFunction.suffix+e.toString():e},unparse:function(data){return"string"==typeof data&&0===data.indexOf(parseFunction.suffix)?eval(data.substr(parseFunction.suffix.length)):data}};function cancelablePromise(e){var t=!1,n=!1;return{promise:new Promise((function(r,a){e.then((function(e){t=!0,n?a("canceled"):r(e)})).catch((function(e){t=!0,a(n?"canceled":e)}))})),resolved:function(){return t},canceled:function(){return n},cancel:function(){n=!0}}}function now(){return performance.now()}function toDegrees(e){return 180*e/Math.PI}function toRadians(e){return e*Math.PI/180}function toArray(e){return Array.isArray(e)?e:[e,e]}function lerp(e,t,n){return(1-n)*e+n*t}function clamp(e,t,n){return n<=e?e:n>=t?t:n}function relativeClamp(e,t,n,r,a){return clamp(r,a,(n-e)/(t-e)*(a-r)+r)}},5260:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(84041),a=n.n(r),i=n(67442),o=n(36554),s={random:new(a())(Math.random)};const c={noise:function(e,t,n,r){return void 0===e&&(e="random"),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),s[e]||(s[e]=new(a())(e)),s[e].noise3D(t,n,r)},angle:function(e,t){if(void 0===t&&(t=[0,0]),e.type==i.i.Matrix){var n=o.al((e.col.count-1)/2,(e.row.count-1)/2);n[0]+=n[0]*t[0],n[1]+=n[1]*t[1];var r=e.col.index-1-n[0],a=e.row.index-1-n[1];return 0===r?0:Math.atan(a/r)}return e.angle},angle2:function(e,t){if(void 0===t&&(t=[0,0]),e.type==i.i.Matrix){var n=o.al((e.col.count-1)/2,(e.row.count-1)/2);n[0]+=n[0]*t[0],n[1]+=n[1]*t[1];var r=e.col.index-1-n[0],a=e.col.index-1-n[1];return 0===r?0:Math.atan2(a,r)}return e.angle},distance:function(e,t){if(void 0===t&&(t=[0,0]),e.type==i.i.Matrix){var n=o.al(.5,.5);n[0]+=n[0]*t[0],n[1]+=n[1]*t[1];var r=o.al(e.col.offset-.5/e.col.count,e.row.offset-.5/e.row.count);return o.TE(r,n)}return 1}}},31324:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=0;const a=function(){function e(e){var t;this.id=null!==(t=e.id)&&void 0!==t?t:++r,this.type=e.type||"SceneChild",this.name=e.name||this.type+"_"+this.id,this.data=e.data||{},this.props={}}return e.prototype.find=function(e){return this.id===e||this.name===e?this:null},e.prototype.getProps=function(){return this.props},e.prototype.getProp=function(e,t,n){var r;return null!==(r=this.props[e])&&void 0!==r?r:n},e.prototype.setPropUnsafe=function(e,t){var n=this;"string"==typeof e?this.props[e]=t:Object.keys(e).forEach((function(t){return n.props[t]=e[t]}))},e}()},90667:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=new Array(4),a={create:function(e,t){void 0===e&&(e=0);var n=new Array(2);return"number"==typeof e?(n[0]=e,n[1]=null!=t?t:e):(n[0]=e[0],n[1]=e[1]),n},normalize:function(e){var t=a.length(e);return 0!==t?[e[0]/t,e[1]/t]:[0,0]},distance:function(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1])},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]},length:function(e){return Math.hypot(e[0],e[1])},angle:function(e,t){return e=a.normalize(e),t=a.normalize(t),Math.acos(a.dot(e,t))},skewX:function(e,t){e[0]+=Math.tan(t)*e[1]},skewY:function(e,t){e[1]+=Math.tan(t)*e[0]},squeezeX:function(e,t){e[1]+=e[1]*(e[0]*-t)},squeezeY:function(e,t){e[0]+=e[0]*(e[1]*t)},rotate:function(e,t,n){var r=e[0]-n[0],a=e[1]-n[1];e[0]=r*t[0]+a*t[1]+n[0],e[1]=r*t[2]+a*t[3]+n[1]},rotateX:function(e,t,n){r[0]=1,r[1]=0,r[2]=0,r[3]=Math.cos(n),a.rotate(e,r,t)},rotateY:function(e,t,n){r[0]=Math.cos(n),r[1]=0,r[2]=0,r[3]=1,a.rotate(e,r,t)},rotateZ:function(e,t,n){r[0]=Math.cos(n),r[1]=-Math.sin(n),r[2]=Math.sin(n),r[3]=Math.cos(n),a.rotate(e,r,t)},translate:function(e,t){e[0]+=t[0],e[1]+=t[1]},scale:function(e,t){e[0]*=t[0],e[1]*=t[1]},divide:function(e,t){e[0]/=t[0],e[1]/=t[1]},toString:function(e){return"x: "+e[0]+", y: "+e[1]},ZERO:Array.from([0,0]),ONE:Array.from([1,1])};const i=a},75154:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={empty:function(){return{cx:0,cy:0,x:-1,y:-1,width:2,height:2}},clear:function(e){e[0]=void 0,e[1]=void 0,e[2]=void 0,e[3]=void 0},add:function(e,t,n){(void 0===e[0]||t<e[0])&&(e[0]=t),(void 0===e[2]||t>e[2])&&(e[2]=t),(void 0===e[1]||n<e[1])&&(e[1]=n),(void 0===e[3]||n>e[3])&&(e[3]=n)},sum:function(e,t){void 0!==t[0]&&void 0!==t[1]&&void 0!==t[2]&&void 0!==t[3]?void 0===e[0]||void 0===e[1]||void 0===e[2]||void 0===e[3]?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]):(e[0]<t[0]&&(e[0]=t[0]),e[2]>t[2]&&(e[2]=t[2]),e[1]<t[1]&&(e[1]=t[1]),e[3]>t[3]&&(e[3]=t[3])):console.warn("[Urplfanze:Bounding] cannot sum bounding")},bind:function(e,t){void 0!==t[0]&&void 0!==t[1]&&void 0!==t[2]&&void 0!==t[3]?(e.x=t[0],e.y=t[1],e.width=t[2]-t[0],e.height=t[3]-t[1],e.cx=e.x+e.width/2,e.cy=e.y+e.height/2):console.warn("[Urplfanze:Bounding] cannot bind bounding")}}},69678:(e,t,n)=>{"use strict";n.d(t,{Gt:()=>a,hp:()=>i,uP:()=>o,s8:()=>s,pn:()=>c,$2:()=>l});var r=n(54294),a=[0,0,0],i=[0,0],o=[1,1];function s(e,t){return e[0]=1,e[1]=Math.tan(t[1]),e[2]=0,e[3]=0,e[4]=Math.tan(t[0]),e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function c(e){return Array.isArray(e)?[e[0],e[1]]:[e,e]}function l(e,t){return void 0===t&&(t=0),Array.isArray(e)?[e[0],e[1],t]:[e,e,t]}r.ZR(Array)},135:(e,t,n)=>{"use strict";n.d(t,{yo:()=>r,$B:()=>a});var r=2*Math.PI,a=(Math.sqrt(5),function(e,t){var n=e%t;return n<0?n+t:n})},11673:(e,t,n)=>{"use strict";n.d(t,{Z:()=>x});var r,a=n(54294),i=n(27730),o=n(36554),s=n(91025),c=n(67442),l=n(31324),d=n(5260),u=n(69678),p=n(66222),h=n(90667),f=n(75154),m=n(135),g=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),v=function(){return(v=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};a.ZR(Array);var y=i.Ue(),b=i.Ue(),w=i.Ue(),_=i.Ue();const x=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.generateId=-1,n.bIndexed=!1,n.indexedBuffer=[],n.bounding={cx:0,cy:0,x:-1,y:-1,width:2,height:2},n.props={distance:t.distance,repetitions:t.repetitions,rotateX:t.rotateX,rotateY:t.rotateY,rotateZ:t.rotateZ,skewX:t.skewX,skewY:t.skewY,squeezeX:t.squeezeX,squeezeY:t.squeezeY,displace:t.displace,translate:t.translate,scale:t.scale,transformOrigin:t.transformOrigin,perspective:t.perspective,perspectiveOrigin:t.perspectiveOrigin},n.bUseParent=!!t.bUseParent,n.bUseRecursion=!!t.bUseRecursion,n.vertexCallback=t.vertexCallback,n}return g(t,e),t.prototype.isStatic=function(){var e=this.props;return"function"!=typeof e.distance&&"function"!=typeof e.repetitions&&"function"!=typeof e.rotateX&&"function"!=typeof e.rotateY&&"function"!=typeof e.rotateZ&&"function"!=typeof e.displace&&"function"!=typeof e.skewX&&"function"!=typeof e.skewY&&"function"!=typeof e.squeezeX&&"function"!=typeof e.squeezeY&&"function"!=typeof e.translate&&"function"!=typeof e.scale&&"function"!=typeof e.transformOrigin},t.prototype.isStaticIndexed=function(){return"function"!=typeof this.props.repetitions},t.prototype.getProp=function(e,n,r){var a,i=this.props[e];return"function"==typeof i&&((n=n||t.EMPTY_PROP_ARGUMENTS).shape=this,n.time=(null===(a=this.scene)||void 0===a?void 0:a.currentTime)||0,i=i(n)),void 0===i||Number.isNaN(i)?r:i},t.prototype.setProp=function(e,t,n){var r=this;void 0===n&&(n=!1),"string"==typeof e?(n=n||"repetitions"==e,this.props[e]=t):(n=n||"repetitions"in e,Object.keys(e).forEach((function(t){return r.props[t]=e[t]}))),this.clearBuffer(n)},t.prototype.clearBuffer=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!0),this.buffer=void 0,e&&(this.bIndexed=!1),this.bStatic=this.isStatic(),this.bStaticIndexed=this.isStaticIndexed(),t&&this.scene&&!this.scene.isFirstLevelChild(this)){var n=this.scene.getParentsOfSceneChild(this);n.length>0&&n[n.length-1].clearBuffer(e,t)}},t.prototype.generate=function(e,t,n){var r,a,l;if(void 0===t&&(t=!1),!this.buffer||!this.bStatic&&(e!==this.generateId||this.bUseParent||this.bUseRecursion)){this.generateId=e,this.bStaticIndexed&&this.bIndexed||(this.indexedBuffer=[]);var g={type:c.i.Ring,angle:0,index:1,offset:1,count:1,row:{index:1,offset:1,count:1},col:{index:1,offset:1,count:1}},v=this.getProp("repetitions",{parent:n,repetition:g,time:1,context:d.Z},1),x=Array.isArray(v)?c.i.Matrix:c.i.Ring,E=Array.isArray(v)?v[0]*(null!==(r=v[1])&&void 0!==r?r:v[0]):v,Z=Array.isArray(v)?v[0]:E,k=Array.isArray(v)?null!==(a=v[1])&&void 0!==a?a:v[0]:1,S=g.row;S.count=Z;var C=g.col;C.count=k,g.count=E,g.col.count=k,g.row.count=Z,g.type=x;for(var O={repetition:g,context:d.Z,time:(null===(l=this.scene)||void 0===l?void 0:l.currentTime)||0,shape:this,parent:n},P=0,A=[],j=0,M=o.al((k-1)/2,(Z-1)/2),T=this.scene?[this.scene.center[0],this.scene.center[1],0]:[0,0,0],I=[void 0,void 0,void 0,void 0],L=[void 0,void 0,void 0,void 0],$=0;$<Z;$++)for(var R=0;R<k;R++,j++){g.index=j+1,g.offset=E>1?j/(E-1):1,g.angle=x===c.i.Ring?m.yo/E*j:0,C.index=R+1,C.offset=k>1?R/(k-1):1,S.index=$+1,S.offset=Z>1?$/(Z-1):1;var D=this.generateBuffer(e,O),B=D.length,z=this.getShapeBounding();A[j]=new Float32Array(B),P+=B;var F=u.pn(this.getProp("distance",O,u.hp)),q=this.getProp("displace",O,0),U=u.$2(this.getProp("scale",O,u.uP),1),N=u.$2(this.getProp("translate",O,u.hp),0),V=this.getProp("skewX",O,0),G=this.getProp("skewY",O,0),H=this.getProp("squeezeX",O,0),Y=this.getProp("squeezeY",O,0),W=this.getProp("rotateX",O,0),X=this.getProp("rotateY",O,0),K=this.getProp("rotateZ",O,0),J=(0,p.uZ)(0,1,this.getProp("perspective",O,0)),Q=u.$2(this.getProp("perspectiveOrigin",O,u.hp),0),ee=u.$2(this.getProp("transformOrigin",O,u.hp),0),te=void 0;switch(x){case c.i.Ring:te=s.al(F[0],0,0),s.jI(te,te,u.Gt,g.angle+q);break;case c.i.Matrix:te=s.al(F[1]*(R-M[0]),F[0]*($-M[1]),0)}var ne=J>0?Math.max(z.width,z.height)/2:1,re=J>0?ne+10*ne*(1-J):0,ae=0!==J||0!==ee[0]||0!==ee[1],ie=0!==Q[0]||0!==Q[1];ae&&(ee[0]*=z.width/2,ee[1]*=z.height/2,ee[2]=re),i.yR(b),ae&&i.Iu(b,b,ee),0===N[0]&&0===N[1]||i.Iu(b,b,N),0===V&&0===G||(u.s8(y,[V,G]),i.Jp(b,b,y)),0!==W&&i.lM(b,b,W),0!==X&&i.uD(b,b,X),0!==K&&i.jI(b,b,K),1===U[0]&&1===U[1]||i.bA(b,b,U),ae&&i.Iu(b,b,s.bA(ee,ee,-1)),re>0&&(ie&&(Q[0]*=z.width/2,Q[1]*=z.height/2,Q[2]=0),i.G3(w,-Math.PI/2,1,0,1/0)),i.yR(_),i.Iu(_,_,te),t&&i.Iu(_,_,T),x===c.i.Ring&&i.jI(_,_,g.angle+q),f.Z.clear(L);for(var oe=0;oe<B;oe+=2){var se=[D[oe],D[oe+1],re];if(0!==H&&h.Z.squeezeX(se,H),0!==Y&&h.Z.squeezeY(se,Y),s.fF(se,se,b),re>0&&(ie&&s.IH(se,se,Q),s.fF(se,se,w),s.bA(se,se,re),ie&&s.lu(se,se,Q)),this.vertexCallback){var ce=oe/2,le=B/2,de={index:ce+1,count:le,offset:le>1?ce/(le-1):1};this.vertexCallback(se,de,O)}s.fF(se,se,_),A[j][oe]=se[0],A[j][oe+1]=se[1],f.Z.add(I,se[0],se[1])}this.bStaticIndexed&&this.bIndexed||this.addIndex(B,g)}f.Z.bind(this.bounding,I),this.buffer=new Float32Array(P);for(var ue=0,pe=(te=0,A.length);ue<pe;te+=A[ue].length,ue++)this.buffer.set(A[ue],te);this.bIndexed=!0}},t.prototype.getBounding=function(){return this.bounding},t.prototype.getRepetitionCount=function(){var e,t=this.getProp("repetitions",void 0,1);return Array.isArray(t)?t[0]*(null!==(e=t[1])&&void 0!==e?e:t[0]):t},t.prototype.getBuffer=function(){return this.buffer},t.prototype.getIndexedBuffer=function(){return this.indexedBuffer},t.getIndexParentLevel=function(e){if(void 0===e.parent)return 0;for(var t=e.parent,n=1;void 0!==t.parent;)n++,t=t.parent;return n},t.prototype.stream=function(e){if(this.buffer&&this.indexedBuffer)for(var t=0,n=0,r=this.indexedBuffer.length;t<r;t++){var a=this.indexedBuffer[t];e({buffer:this.buffer,frameLength:a.frameLength,frameBufferIndex:n,currentIndexing:a,currentShapeIndex:t,totalShapes:r}),n+=a.frameLength}},t.EMPTY_BUFFER=new Float32Array(0),t.getEmptySimpleRepetition=function(){return{index:1,offset:1,count:1}},t.getEmptyRepetition=function(){return v(v({type:c.i.Ring,angle:0},t.getEmptySimpleRepetition()),{row:t.getEmptySimpleRepetition(),col:t.getEmptySimpleRepetition()})},t.EMPTY_PROP_ARGUMENTS={time:0,context:d.Z,repetition:t.getEmptyRepetition()},t}(l.Z)},99814:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r,a=n(50607),i=n(75154),o=n(135),s=n(11673),c=n(76403),l=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(){return(d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const u=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n=!1);var r=this;return t.type=t.type||"ShapeLoop",(r=e.call(this,t)||this).loopDependencies=(t.loopDependencies||[]).concat("sideLength"),r.props.loop=t.loop,n||(r.loop={start:0,end:o.yo,inc:o.yo/10,vertex:function(){return[0,0]}},r.bStaticLoop=r.isStaticLoop(),r.bStatic=r.isStatic(),r.bStaticIndexed=r.isStaticIndexed()),r}return l(t,e),t.prototype.isStaticLoop=function(){if(this.loopDependencies.includes("propArguments"))return!1;for(var e=0,t=this.loopDependencies.length;e<t;e++)if("function"==typeof this.props[this.loopDependencies[e]])return!1;return!0},t.prototype.isStatic=function(){return this.bStaticLoop&&e.prototype.isStatic.call(this)},t.prototype.isStaticIndexed=function(){return this.bStaticLoop&&e.prototype.isStaticIndexed.call(this)},t.prototype.clearBuffer=function(t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),e.prototype.clearBuffer.call(this,t,n),this.bStaticLoop=this.isStaticLoop(),t&&(this.currentOrSingleLoopBuffer=void 0)},t.prototype.setProp=function(t,n){for(var r,a=!1,i="string"==typeof t?((r={})[t]=n,r):t,o=this.loopDependencies.length-1;o>=0;o--)if(this.loopDependencies[o]in i){a=!0;break}"loop"in i&&(i.loop=d(d({},this.props.loop),i.loop),a=!0),e.prototype.setProp.call(this,i,n,a)},t.prototype.getBufferLength=function(e){if(this.bStatic&&void 0!==this.buffer)return this.buffer.length;if(this.bStaticLoop&&void 0!==this.currentOrSingleLoopBuffer)return this.currentOrSingleLoopBuffer.length*this.getRepetitionCount();var t=this.getLoop(e).count;return this.getRepetitionCount()*t*2},t.prototype.generateBuffer=function(e,t){return this.bStaticLoop?("function"!=typeof this.props.sideLength&&void 0!==this.currentOrSingleLoopBuffer||(this.currentOrSingleLoopBuffer=this.generateLoopBuffer(t)),this.currentOrSingleLoopBuffer):this.generateLoopBuffer(t)},t.prototype.generateLoopBuffer=function(e){for(var t=this.getLoop(e),n=t.start,r=t.inc,o=(t.end,t.count),s=this.getRepetitionSideLength(e),l=this.props.loop&&this.props.loop.vertex?this.props.loop.vertex:this.loop.vertex,d={index:0,offset:0,angle:0,count:o},u=d.count,p=2*u,h=new Float32Array(p),f=this.adaptMode===a._.None,m=[void 0,void 0,void 0,void 0],g=0,v=0;g<u;g++,v+=2){var y=n+r*g,b=d.count>1?g/(d.count-1):1;d.angle=y,d.index=g+1,d.offset=b;var w=Float32Array.from(l(d,e));h[v]=w[0],h[v+1]=w[1],f&&(h[v]*=s[0],h[v+1]*=s[1],i.Z.add(m,h[v],h[v+1]))}if(!f){var _=c.Z.adaptBuffer(h,this.adaptMode);i.Z.clear(m);for(g=0;g<p;g+=2)_[g]=_[g]*s[0],_[g+1]=_[g+1]*s[1],i.Z.add(m,_[g],_[g+1]);return i.Z.bind(this.currentGenerationPrimitiveBounding,m),_}return i.Z.bind(this.currentGenerationPrimitiveBounding,m),h},t.prototype.getLoop=function(e){var t,n,r,a,i,o,c;void 0===e&&(e=s.Z.EMPTY_PROP_ARGUMENTS),e.time=(null===(t=this.scene)||void 0===t?void 0:t.currentTime)||0;var l=null!==(r=null===(n=this.props.loop)||void 0===n?void 0:n.start)&&void 0!==r?r:this.loop.start,d=null!==(i=null===(a=this.props.loop)||void 0===a?void 0:a.end)&&void 0!==i?i:this.loop.end,u=null!==(c=null===(o=this.props.loop)||void 0===o?void 0:o.inc)&&void 0!==c?c:this.loop.inc;l="function"==typeof l?l(e):l,d="function"==typeof d?d(e):d,u="function"==typeof u?u(e):u;var p=Math.ceil((d-l)/u);return{start:l,end:d,inc:u,count:p<=0?0:p}},t.prototype.setShape=function(e){this.setProp("loop",e)},t.PId2=Math.PI/2,t}(c.Z)},76403:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r,a=n(11673),i=n(50607),o=n(69678),s=n(75154),c=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});const l=function(e){function t(t){var n,r;void 0===t&&(t={});var a=e.call(this,t)||this;return a.currentGenerationPrimitiveBounding=s.Z.empty(),a.props.sideLength=void 0===t.sideLength?void 0:"function"==typeof t.sideLength?t.sideLength:o.pn(t.sideLength),a.style=t.style||{},a.adaptMode=null!==(n=t.adaptMode)&&void 0!==n?n:i._.None,a.bClosed=null===(r=t.bClosed)||void 0===r||r,a}return c(t,e),t.prototype.isStatic=function(){return"function"!=typeof this.props.sideLength&&e.prototype.isStatic.call(this)},t.prototype.getRepetitionSideLength=function(e){return this.bStatic?(void 0===this.props.sideLength?this.props.sideLength=[50,50]:"number"==typeof this.props.sideLength&&(this.props.sideLength=[this.props.sideLength,this.props.sideLength]),this.props.sideLength):o.pn(this.getProp("sideLength",e,[50,50]))},t.prototype.getShapeBounding=function(){return this.currentGenerationPrimitiveBounding},t.prototype.addIndex=function(e,t){this.indexedBuffer.push({shape:this,frameLength:e,repetition:{type:t.type,angle:t.angle,index:t.index,count:t.count,offset:t.offset,row:{index:t.row.index,count:t.row.count,offset:t.row.offset},col:{index:t.col.index,count:t.col.count,offset:t.col.offset}}})},t.prototype.isClosed=function(){return this.bClosed},t.prototype.setClosed=function(e){this.bClosed=e},t.prototype.getAdaptMode=function(){return this.adaptMode},t.prototype.adapt=function(e){this.adaptMode=e,this.clearBuffer(!0)},t.getBounding=function(e,t){void 0===t&&(t=s.Z.empty());for(var n=[void 0,void 0,void 0,void 0],r=0,a=e.length;r<a;r+=2)s.Z.add(n,e[r],e[r+1]);return s.Z.bind(t,n),t},t.adaptBuffer=function(e,n,r){if(n===i._.None)return Float32Array.from(e);var a=new Float32Array(e.length);r||(r=t.getBounding(e));for(var o=r.width>=2||r.height>=2||n>=i._.Fill&&(r.width<2||r.height<2)?2/Math.max(r.width,r.height):1,s=n>=i._.Center?r.cx:0,c=n>=i._.Center?r.cy:0,l=0,d=e.length;l<d;l+=2)a[l]=(e[l]-s)*o,a[l+1]=(e[l+1]-c)*o;return a},t}(a.Z)},68530:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r,a=n(99814),i=n(50607),o=n(135),s=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});const c=function(e){function t(n){var r,a,s,c;void 0===n&&(n={});var l=this;return n.type="Spiral",n.bClosed=!1,n.adaptMode=null!==(r=n.adaptMode)&&void 0!==r?r:i._.None,n.loopDependencies=(n.loopDependencies||[]).concat(["twists","twistsStart","spiral"]),(l=e.call(this,n,!0)||this).props.spiral=null!==(a=n.spiral)&&void 0!==a?a:t.types.ARCHIMEDE,l.props.twists=null!==(s=n.twists)&&void 0!==s?s:2,l.props.twistsStart=null!==(c=n.twistsStart)&&void 0!==c?c:0,l.loop={start:function(e){return o.yo*l.getProp("twistsStart",e)},end:function(e){return o.yo*(l.getProp("twistsStart",e)+l.getProp("twists",e))},inc:function(e){var t=l.getProp("twists",e),n=o.yo*t,r=l.getRepetitionSideLength(e);return n/((4+Math.sqrt(r[0]*r[1]))*t)},vertex:function(e){var t=l.r(e.angle);return[t*Math.cos(e.angle),t*Math.sin(e.angle)]}},l.bStaticLoop=l.isStaticLoop(),l.bStatic=l.isStatic(),l.bStaticIndexed=l.isStaticIndexed(),l}return s(t,e),t.prototype.generateLoopBuffer=function(n){return this.spiral=this.getProp("spiral",n),this.r=t.getRFromTSpiralType(this.spiral),e.prototype.generateLoopBuffer.call(this,n)},t.getRFromTSpiralType=function(e){switch(e){case t.types.ARCHIMEDE:return function(e){return e/10};case t.types.HYPERBOLIC:return function(e){return 1/e*3};case t.types.FERMAT:return function(e){return Math.pow(e,.5)/3};case t.types.LITUUS:return function(e){return Math.pow(e,-.5)};case t.types.LOGARITHMIC:return function(e){return Math.pow(Math.E,.2*e)/10}}return function(e){return e}},t.types={ARCHIMEDE:"ARCHIMEDE",HYPERBOLIC:"HYPERBOLIC",FERMAT:"FERMAT",LITUUS:"LITUUS",LOGARITHMIC:"LOGARITHMIC"},t}(a.Z)},67442:(e,t,n)=>{"use strict";var r;n.d(t,{i:()=>r}),function(e){e[e.Ring=1]="Ring",e[e.Matrix=2]="Matrix"}(r||(r={}))},50607:(e,t,n)=>{"use strict";var r;n.d(t,{_:()=>r}),function(e){e[e.None=0]="None",e[e.Scale=2]="Scale",e[e.Center=4]="Center",e[e.Fill=8]="Fill"}(r||(r={}))},27927:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _Simple__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(39022),_scene_utilities_SceneUtilitiesExtended__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(94176),__assign=function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Animation={composeAnimation:function(scene,prop_name,animation){switch(animation.type){case"simple":var simpleAnimation=__assign({},animation.value);return simpleAnimation.from=_scene_utilities_SceneUtilitiesExtended__WEBPACK_IMPORTED_MODULE_1__.Z.getTransformedValue(scene,prop_name,simpleAnimation.from),simpleAnimation.to=_scene_utilities_SceneUtilitiesExtended__WEBPACK_IMPORTED_MODULE_1__.Z.getTransformedValue(scene,prop_name,simpleAnimation.to),_Simple__WEBPACK_IMPORTED_MODULE_0__.Z.compose(simpleAnimation);case"raw":var rawValue=animation.value;return eval(rawValue.raw)}}};const __WEBPACK_DEFAULT_EXPORT__=Animation},55389:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r={linear:function(e,t,n,r){return n*e/r+t},quadraticIn:function(e,t,n,r){return n*(e/=r)*e+t},quadraticOut:function(e,t,n,r){return-n*(e/=r)*(e-2)+t},quadraticInOut:function(e,t,n,r){return(e/=r/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},cubicIn:function(e,t,n,r){return n*(e/=r)*e*e+t},cubicOut:function(e,t,n,r){return e/=r,n*(--e*e*e+1)+t},cubicInOut:function(e,t,n,r){return(e/=r/2)<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t},quarticIn:function(e,t,n,r){return n*(e/=r)*e*e*e+t},quarticOut:function(e,t,n,r){return e/=r,-n*(--e*e*e*e-1)+t},quarticInOut:function(e,t,n,r){return(e/=r/2)<1?n/2*e*e*e*e+t:-n/2*((e-=2)*e*e*e-2)+t},quinticIn:function(e,t,n,r){return n*(e/=r)*e*e*e*e+t},quinticOut:function(e,t,n,r){return e/=r,n*(--e*e*e*e*e+1)+t},quinticInOut:function(e,t,n,r){return(e/=r/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t},sinusoidalIn:function(e,t,n,r){return-n*Math.cos(e/r*(Math.PI/2))+n+t},sinusoidalOut:function(e,t,n,r){return n*Math.sin(e/r*(Math.PI/2))+t},sinusoidalInOut:function(e,t,n,r){return-n/2*(Math.cos(Math.PI*e/r)-1)+t},exponentialIn:function(e,t,n,r){return n*Math.pow(2,10*(e/r-1))+t},exponentialOut:function(e,t,n,r){return n*(1-Math.pow(2,-10*e/r))+t},exponentialInOut:function(e,t,n,r){return(e/=r/2)<1?n/2*Math.pow(2,10*(e-1))+t:(e--,n/2*(2-Math.pow(2,-10*e))+t)},circularIn:function(e,t,n,r){return e/=r,-n*(Math.sqrt(1-e*e)-1)+t},circularOut:function(e,t,n,r){return e/=r,e--,n*Math.sqrt(1-e*e)+t},circularInOut:function(e,t,n,r){return(e/=r/2)<1?-n/2*(Math.sqrt(1-e*e)-1)+t:(e-=2,n/2*(Math.sqrt(1-e*e)+1)+t)},elasticIn:function(e,t,n,r,a,i){if(0==e)return t;if(1==(e/=r))return t+n;i||(i=.3*r);var o=0;return!a||a<Math.abs(n)?(a=n,o=i/4):o=i/(2*Math.PI)*Math.asin(n/a),-a*Math.pow(2,10*(e-=1))*Math.sin((e*r-o)*(2*Math.PI)/i)+t},elasticOut:function(e,t,n,r,a,i){if(0==e)return t;if(1==(e/=r))return t+n;i||(i=.3*r);var o=0;return!a||a<Math.abs(n)?(a=n,o=i/4):o=i/(2*Math.PI)*Math.asin(n/a),a*Math.pow(2,-10*e)*Math.sin((e*r-o)*(2*Math.PI)/i)+n+t},elasticInOut:function(e,t,n,r,a,i){if(0==e)return t;if(2==(e/=r/2))return t+n;i||(i=r*(.3*1.5));var o=0;return!a||a<Math.abs(n)?(a=n,o=i/4):o=i/(2*Math.PI)*Math.asin(n/a),e<1?a*Math.pow(2,10*(e-=1))*Math.sin((e*r-o)*(2*Math.PI)/i)*-.5+t:a*Math.pow(2,-10*(e-=1))*Math.sin((e*r-o)*(2*Math.PI)/i)*.5+n+t},backIn:function(e,t,n,r,a){return void 0===a&&(a=1.70158),n*(e/=r)*e*((a+1)*e-a)+t},backOut:function(e,t,n,r,a){return void 0===a&&(a=1.70158),n*((e=e/r-1)*e*((a+1)*e+a)+1)+t},backInOut:function(e,t,n,r,a){return void 0===a&&(a=1.70158),(e/=r/2)<1?n/2*(e*e*((1+(a*=1.525))*e-a))+t:n/2*((e-=2)*e*((1+(a*=1.525))*e+a)+2)+t},bounceIn:function(e,t,n,a){return n-r.bounceOut(a-e,0,n,a)+t},bounceOut:function(e,t,n,r){return(e/=r)<1/2.75?n*(7.5625*e*e)+t:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t},bounceInOut:function(e,t,n,a){return e<a/2?.5*r.bounceIn(2*e,0,n,a)+t:.5*r.bounceOut(2*e-a,0,n,a)+.5*n+t}};const a=r},39022:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(25995),a=n(66222),i=n(55389),o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},s={loop:function(e){return s.compose(o(o({mode:"sinusoidal",modeFunction:"cos"},e),{type:"loop",delay:void 0}))},uncontrolledLoop:function(e){return s.compose(o(o({mode:"easing",modeFunction:"linear"},e),{type:"uncontrolled-loop"}))},static:function(e){return s.compose(o(o({mode:"easing",modeFunction:"linear"},e),{type:"static"}))},compose:function(e){if("string"!=typeof e.from&&"string"!=typeof e.to){var t=Array.isArray(e.from)||Array.isArray(e.to),n=t?(0,a.qo)(e.from):e.from,i=t?(0,a.qo)(e.to):e.to,o=t?function(t,r){var a=e.invertOdd&&t%2==1?i:n,o=e.invertOdd&&t%2==1?n:i;return"int"===e.typeValue?[Math.round(a[0]+r*(o[0]-a[0])),Math.round(a[1]+r*(o[1]-a[1]))]:[a[0]+r*(o[0]-a[0]),a[1]+r*(o[1]-a[1])]}:function(t,r){var a=e.invertOdd&&t%2==1?i:n,o=e.invertOdd&&t%2==1?n:i;return"int"===e.typeValue?Math.round(a+r*(o-a)):a+r*(o-a)};return c(e,(function(e,t){return o(e.repetition.index,t)}))}var s=(0,r.k0)(e.from),u=(0,r.k0)(e.to),p="hue"==e.colorTransitionMode?d:l;return void 0!==s&&void 0!==u?c(e,(function(t,n){var r=e.invertOdd&&t.repetition.index%2==1?u:s,a=e.invertOdd&&t.repetition.index%2==1?s:u;return p(r,a,n)})):function(){return 0}}};function c(e,t){var n=e,r=n.duration,a=n.type,o=n.mode,s=n.modeFunction,c=n.delay;return"static"===a?c&&c>0?function(e){return t(e,e.time<=c?0:e.time-c>=r?1:i.Z[s](e.time-c,0,1,r))}:function(e){return t(e,e.time<=r?i.Z[s](e.time,0,1,r):1)}:"loop"===a?"sinusoidal"==o?function(e){var n=2*(e.time||0)*Math.PI/r;return t(e,.5+.5*Math[s](n))}:function(e){var n=r/2,a=e.time%r;return t(e,a<=n?i.Z[s](a,0,1,n):i.Z[s](n-(a-n),0,1,n))}:"sinusoidal"==o?function(e){var n=e.time%(r+c),a=2*((n=n<=c?0:n-c)||0)*Math.PI/r;return t(e,.5+.5*Math[s](a))}:c&&c>0?function(e){var n=e.time%(r+c);return t(e,n<=c?0:n-c>=r?1:i.Z[s](n-c,0,1,r))}:function(e){var n=e.time%r;return t(e,n<=r?i.Z[s](n,0,1,r):1)}}function l(e,t,n){var r=e.r+n*(t.r-e.r),a=e.g+n*(t.g-e.g),i=e.b+n*(t.b-e.b),o=e.alpha+n*(t.alpha-e.alpha);return"rgba("+Math.floor(r)+","+Math.floor(a)+","+Math.floor(i)+","+o+")"}function d(e,t,n){return"hsla("+(e.h+n*(t.h-e.h))+","+(e.s+n*(t.s-e.s))+"%,"+(e.l+n*(t.l-e.l))+"%,"+(e.alpha+n*(t.alpha-e.alpha))+")"}const u=s},30824:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(68530),a=n(50607);const i={repetitions:{animable:!0,name:"repetitions",label:"Repetitions",type:"range",min:1,max:200,step:1,default:1,default_animate:20,canBArray:!0,transformation:"none",dataType:"props",type_value:"int"},distance:{animable:!0,name:"distance",label:"Distance",type:"range",min:-100,max:100,step:.1,default:0,canBArray:!0,default_animate:25,transformation:"scene-size-percentage",dataType:"props"},displace:{animable:!0,name:"displace",label:"Displace",type:"range",min:-360,max:360,step:1,default:0,default_animate:360,transformation:"angle",dataType:"props"},squeezeX:{animable:!0,name:"squeezeX",label:"SqueezeX",type:"range",min:-.2,max:.2,step:.01,default:0,default_animate:.1,transformation:"scene-size-percentage-inverse",dataType:"props"},squeezeY:{animable:!0,name:"squeezeY",label:"SqueezeY",type:"range",min:-.2,max:.2,step:.01,default:0,default_animate:.1,transformation:"scene-size-percentage-inverse",dataType:"props"},rotateX:{animable:!0,name:"rotateX",label:"RotateX",type:"range",min:-360,max:360,step:1,default:0,default_animate:360,transformation:"angle",dataType:"props"},rotateY:{animable:!0,name:"rotateY",label:"RotateY",type:"range",min:-360,max:360,step:1,default:0,default_animate:360,transformation:"angle",dataType:"props"},rotateZ:{animable:!0,name:"rotateZ",label:"RotateZ",type:"range",min:-360,max:360,step:1,default:0,default_animate:360,transformation:"angle",dataType:"props"},skewX:{animable:!0,name:"skewX",label:"SkewX",type:"range",min:-90,max:90,step:1,default:0,default_animate:1,transformation:"angle",dataType:"props"},skewY:{animable:!0,name:"skewY",label:"SkewY",type:"range",min:-90,max:90,step:1,default:0,default_animate:1,transformation:"angle",dataType:"props"},translate:{animable:!0,name:"translate",label:"Translate",type:"multiple-range",min:-100,max:100,step:.1,default:[0,0],default_animate:0,initialArray:!0,transformation:"scene-size-percentage",dataType:"props"},scale:{animable:!0,name:"scale",label:"Scale",type:"multiple-range",min:-5,max:5,step:.01,default:[1,1],default_animate:3,transformation:"none",dataType:"props"},transformOrigin:{animable:!0,name:"transformOrigin",label:"Transform Origin",type:"multiple-range",min:-1,max:1,step:.01,default:[0,0],default_animate:[-1,1],initialArray:!0,transformation:"none",dataType:"props"},perspective:{animable:!0,name:"perspective",label:"Perspective",type:"range",min:0,max:1,step:.01,default:0,default_animate:.8,transformation:"none",dataType:"props"},perspectiveOrigin:{animable:!0,name:"perspectiveOrigin",label:"Perspective Origin",type:"multiple-range",min:-1,max:1,step:.01,default:[0,0],default_animate:[-1,1],initialArray:!0,transformation:"none",dataType:"props"},fill:{animable:!0,name:"fill",label:"Fill",type:"color",default:"#000",default_animate:"#fff",transformation:"none",dataType:"drawer"},stroke:{animable:!0,name:"stroke",label:"Stroke",type:"color",default:"#fff",default_animate:"#000",transformation:"none",dataType:"drawer"},lineWidth:{animable:!0,name:"lineWidth",label:"Stroke weight",type:"slider",min:0,max:30,step:.1,default:1,default_animate:3,transformation:"none",dataType:"drawer"},bClosed:{name:"bClosed",label:"Closed",type:"checkbox",default:void 0,transformation:"none",dataType:"settings"},bUseParent:{name:"bUseParent",label:"Use parent repetition",type:"checkbox",default:!1,transformation:"none",dataType:"settings"},bUseRecursion:{name:"bUseRecursion",label:"Use recursion repetition",type:"checkbox",default:!1,transformation:"none",dataType:"settings"},vertexCallback:{name:"vertexCallback",label:"vertexCallback",type:"function",default:void 0,transformation:"none",dataType:"settings"},adaptMode:{name:"adaptMode",label:"Adapt",type:"radio",options:[{key:"None",value:a._.None},{key:"Scale",value:a._.Scale},{key:"Center",value:a._.Center},{key:"Fill",value:a._.Fill}],default:void 0,transformation:"none",dataType:"settings"},sideLength:{animable:!0,name:"sideLength",label:"Side Length",type:"multiple-range",min:.01,max:100,step:.1,default:[10,10],default_animate:20,transformation:"scene-size-percentage",dataType:"props"},sideNumber:{animable:!0,name:"sideNumber",label:"Side Number",type:"range",min:1,max:20,step:1,default:5,default_animate:2,transformation:"none",dataType:"props"},n:{animable:!0,name:"n",label:"n",type:"range",min:1,max:10,step:1,default:1,default_animate:3,transformation:"none",dataType:"props"},d:{animable:!0,name:"d",label:"d",type:"range",min:1,max:10,step:1,default:2,default_animate:4,transformation:"none",dataType:"props"},wx:{animable:!0,name:"wx",label:"wx",type:"range",min:1,max:10,step:1,default:1,default_animate:3,transformation:"none",dataType:"props"},wy:{animable:!0,name:"wy",label:"wy",type:"range",min:1,max:10,step:1,default:2,default_animate:4,transformation:"none",dataType:"props"},wz:{animable:!0,name:"wz",label:"wz",type:"range",min:-360,max:360,step:1,default:0,default_animate:360,transformation:"angle",dataType:"props"},twists:{animable:!0,name:"twists",label:"Twists",type:"range",min:1,max:60,step:.1,default:1,default_animate:3,transformation:"none",dataType:"props"},twistsStart:{animable:!0,name:"twists_start",label:"Twists start",type:"range",min:0,max:60,step:.1,default:0,default_animate:1,transformation:"none",dataType:"props"},spiral:{name:"spiral",label:"Spiral type",type:"select",options:[{key:"ARCHIMEDE",value:r.Z.types.ARCHIMEDE},{key:"FERMAT",value:r.Z.types.FERMAT},{key:"HYPERBOLIC",value:r.Z.types.HYPERBOLIC},{key:"LITUUS",value:r.Z.types.LITUUS},{key:"LOGARITHMIC",value:r.Z.types.LOGARITHMIC}],default:r.Z.types.ARCHIMEDE,transformation:"none",dataType:"props"},a:{animable:!0,name:"a",label:"A",type:"range",min:-5,max:5,step:.1,default:1,default_animate:.1,transformation:"none",dataType:"props"},b:{animable:!0,name:"b",label:"B",type:"range",min:-5,max:5,step:.1,default:1,default_animate:.1,transformation:"none",dataType:"props"},m:{animable:!0,name:"m",label:"m",type:"range",min:1,max:20,step:1,default:1,default_animate:6,transformation:"none",dataType:"props",type_value:"int"},n1:{animable:!0,name:"n1",label:"n1",type:"range",min:-3,max:3,step:.1,default:1,default_animate:.1,transformation:"none",dataType:"props"},n2:{animable:!0,name:"n2",label:"n2",type:"range",min:-3,max:3,step:.1,default:1,default_animate:.1,transformation:"none",dataType:"props"},n3:{animable:!0,name:"n3",label:"n3",type:"range",min:-3,max:3,step:.1,default:1,default_animate:.1,transformation:"none",dataType:"props"},"loop.start":{name:"loop.start",label:"start",type:"range",default:void 0,min:0,max:100,step:.01,transformation:"none",dataType:"props"},"loop.end":{name:"loop.end",label:"end",type:"range",default:void 0,min:0,max:100,step:.01,transformation:"none",dataType:"props"},"loop.inc":{name:"loop.inc",label:"inc",type:"range",default:void 0,min:.01,max:100,step:.01,transformation:"none",dataType:"props"}}},94176:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(66222),a=n(30824);const i=function(){function e(){}return e.bValueLoop=function(e){return"object"==typeof e&&"start"in e&&"end"in e&&"inc"in e&&"vertex"in e&&e.vertex.raw&&e.vertex.raw.length>0},e.bValueVertexCallback=function(e){return e&&e.raw&&e.raw.length>0},e.composeVertexCallback=function(t){if(t&&t.raw)return new Function("vertex","vertexRepetition",e.RAW_ARGUMENTS,"return "+t.raw)},e.composeLoop=function(t){var n=t.vertex.raw?new Function("shapeLoopRepetition",e.RAW_ARGUMENTS,"return "+t.vertex.raw):void 0;return{start:t.start,end:t.end,inc:t.inc,vertex:n}},e.bValueAnimation=function(e){return e&&"object"==typeof e&&e.type&&("simple"===e.type||"raw"===e.type)},e.bValueTransformable=function(e){return null!==e&&"object"==typeof e&&"string"==typeof e.type&&"transformable-prop"===e.type},e.bPropInSceneChildUtilitiesData=function(e){return void 0!==a.Z[e]&&"none"!==a.Z[e].transformation},e.getTransformedValue=function(t,n,i){var o=a.Z[n];if(e.bPropInSceneChildUtilitiesData(n)&&e.bValueTransformable(i)){i=i.value;var s="distance"===n?t.height:t.width,c="distance"===n?t.width:t.height;switch(o.transformation){case"angle":return Array.isArray(i)?[(0,r.Yr)(i[0]),(0,r.Yr)(i[1])]:(0,r.Yr)(i);case"scene-size-percentage":if(void 0!==t)return Array.isArray(i)?[i[0]*s/100,i[1]*c/100]:i*(t.center[0]+t.center[1])/100;break;case"scene-size-percentage-inverse":if(void 0!==t)return Array.isArray(i)?[100*i[0]/s,100*i[1]/c]:100*i/(t.center[0]+t.center[1])}}return i},e.getTransformedValueInverse=function(t,n,i){var o=a.Z[n];if(e.bPropInSceneChildUtilitiesData(n)&&e.bValueTransformable(i)){i=i.value;var s="distance"===n?t.height:t.width,c="distance"===n?t.width:t.height;switch(o.transformation){case"angle":return Array.isArray(i)?[(0,r.Ux)(i[0]),(0,r.Ux)(i[1])]:(0,r.Ux)(i);case"scene-size-percentage":if(void 0!==t)return Array.isArray(i)?[100*i[0]/s,100*i[1]/c]:100*i/(t.center[0]+t.center[1]);break;case"scene-size-percentage-inverse":if(void 0!==t)return Array.isArray(i)?[i[0]*s/100,i[1]*c/100]:i*(t.center[0]+t.center[1])/100}}return i},e.RAW_ARGUMENTS="{ context, repetition, time, shape, shape_loop, data }",e.RAW_ARGUMENTS_WITH_PARENT="{ context, repetition, parent, time, shape, shape_loop, data }",e}()},21680:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(67294),a=n(29163),i=n(76383);const o=e=>{const t=e.id||"cb_"+e.name;return r.createElement(s,null,r.createElement(c,{size:e.size||0,id:t,type:"checkbox",onChange:t=>e.onChange(t.target.checked),checked:e.checked}),e.name&&r.createElement("label",{htmlFor:t},e.name))},s=a.ZP.div`
    display: flex;
    align-items: center;
    > label { margin-left: ${i.Z.ms(-1)}; }
    > * { 
        cursor: pointer; 
    }
`,c=a.ZP.input`
    position: relative;
    appearance: none;
    margin: 0;
    border-radius: 2px;
    width: ${e=>i.Z.ms(e.size)};
    height: ${e=>i.Z.ms(e.size)};
    
    border: 1px solid ${i.Z.color("gray-dark")};
    transition: 0.1s border-color ease-out;

    &:after{
        position: absolute;
        width: 100%;
        height: 100%;
        display: block;
        content: ' ';
        background: ${i.Z.color("gray-dark")};
        transform: scale(.7);
        transform-origin: center center;
        transition: 0.1s background ease-out;
        border-radius: 2px;
    }

    &:checked {
        border-color: ${i.Z.color("primary")};

        &:after{ 
            background: ${i.Z.color("primary")}; 
        }
    }
`},47790:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var r=n(67294),a=n(29163),i=n(76383),o=n(100),s=n(99011),c=n(38166),l=n(62957);const d=a.ZP.div`
	display: none;
	position: absolute;
	z-index: 100;
	height: 100%;
	top: 0;
	background: ${i.Z.palette.get("dark-lighten","hex").lighten(5)};
	cursor: pointer;
`,u=a.ZP.div`
	position: relative;
	height: ${e=>e.small?i.Z.ms(0):e.size?"string"==typeof e.size?e.size:i.Z.ms(e.size):"100%"};
	line-height: ${e=>e.small?i.Z.ms(0):e.size?"string"==typeof e.size?e.size:i.Z.ms(e.size):"inherit"};
	font-size: ${e=>e.small?i.Z.sub(-1):null};
	background: ${i.Z.palette.get("dark","hex")};

	width: 100%;
	&:hover ${d} {
		display: block;
	}
`,p=a.ZP.input`
	display: inline-block;
	width: 100%;
	height: 100%;
	padding: 0 ${i.Z.ms(-1)};
	background: ${i.Z.palette.get("dark","hex").darken(5)};
	border: none;
	color: #fff;
`,h=a.ZP.div`
	position: relative;
	height: 100%;
	opacity: ${e=>e.bDefaultValue?.3:1};
	cursor: ew-resize;

	&:hover {
		background: rgba(255, 255, 255, 0.2);
	}
`,f=a.ZP.div`
	height: 100%;
	background: ${i.Z.palette.get("primary","hex")};
	pointer-events: none;
`,m=a.ZP.div`
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	pointer-events: none;
`,g=r.memo((({min:e,max:t,step:n,value:a,small:i,size:g,onChange:v,bDefaultValue:y})=>{const[b]=(0,l.Z)(),[w,_]=r.useState(!1),x=n.toExponential(1).match(/e(-?[0-9]+)/),E=Math.pow(10,x?-x[1]:0);function Z(n,r){return n=(0,o.clamp)(e,t,n),v(n,r),n!==a}function k(r,i=1){Z((0,o.clamp)(e,t,Math.round((a+i*n*r)*E)/E),"none")}function S(e){const t=parseFloat(e.replace(/,/g,"."));return!Number.isNaN(t)&&(t==a||Z(t,"none"))}const[C,O]=(0,c.Z)({value:a,min:e,max:t,step:n,exp:E,onChange:Z,events:{notDrag:()=>{b.current&&S(b.current.value)&&_(!1)},dragEnd:e=>{!e&&_(!0)}}});return r.createElement(u,{small:i,size:g},w?r.createElement(p,{ref:b,defaultValue:a,autoFocus:!0,onKeyDown:e=>"Enter"===e.key&&S(e.target.value)&&_(!1),onFocus:e=>e.target.select()}):r.createElement(r.Fragment,null,r.createElement(d,{style:{left:0},onClick:e=>k(-1,e.shiftKey?10:1)},r.createElement(s.Z,{size:0,rotate:180,name:"arrow-right"})),r.createElement(h,{ref:O,bDefaultValue:y&&C.value===a},r.createElement(f,{style:{width:C.valuePercentage+"%"}}),r.createElement(m,null,C.value.toFixed(Math.log10(E)))),r.createElement(d,{style:{right:0},onClick:e=>k(1,e.shiftKey?10:1)},r.createElement(s.Z,{size:0,name:"arrow-right"}))))}))},84581:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(67294),a=n(62957),i=n(27722);const o=function(e){const[t]=(0,a.Z)();e=e||{};const[n,o]=r.useState({coords:{x:0,y:0},bDrag:!1,time:0}),s=r.useCallback((({target:r,clientX:a,clientY:s})=>{const c=r===(null==t?void 0:t.current);c&&c!=n.bDrag&&(o({coords:{x:a,y:s},bDrag:!0,time:(0,i.zO)()}),e.onDragStart&&e.onDragStart()),c||e.onNotDrag&&e.onNotDrag()}),[t.current,n.bDrag]),c=r.useCallback((({clientX:t,clientY:r})=>{if(n.bDrag){const a=(0,i.zO)()-n.time,s={x:t-n.coords.x,y:r-n.coords.y};a<300&&0==s.x&&0==s.y&&e.onClick&&e.onClick({x:t,y:r}),o({coords:s,bDrag:!1,time:0}),e.onDragEnd&&e.onDragEnd(s,{x:t,y:r},a)}}),[t.current,n.bDrag]),l=r.useCallback((({clientX:t,clientY:r})=>{if(n.bDrag){const a={x:t-n.coords.x,y:r-n.coords.y};o({coords:a,bDrag:!0,time:0}),e.onDrag&&e.onDrag(a,{x:t,y:r})}}),[t.current,n.bDrag]);return r.useEffect((()=>(document.addEventListener("mousedown",s,{passive:!0}),document.addEventListener("mouseup",c,{passive:!0}),document.addEventListener("mousemove",l,{passive:!0}),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("mouseup",c),document.removeEventListener("mousemove",l)})),[t.current,s,l,c]),t}},62957:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(67294);const a=function(e=null){const t=r.useRef(e),n=r.useCallback((e=>{t.current,t.current=e}),[]);return[t,n]}},38166:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(67294),a=n(84581),i=n(27106),o=n(73259),s=n(58416);const c=function({value:e,step:t,vertical:n,exp:c,min:l,max:d,onChange:u,events:p}){const h=(0,s.Sr)(l,d,e,0,100),[f,m]=r.useState({value:e,valuePercentage:h}),g=(0,a.Z)({onNotDrag:()=>{p&&p.notDrag&&p.notDrag()},onDragStart:()=>{p&&p.dragStart&&p.dragStart()},onDrag:e=>{const t=y(e);t.value!=f.value&&(m(t),u(t.value,"slider")),p&&p.drag&&p.drag(e)},onDragEnd:e=>{const t=Math.abs(n?e.y:e.x)>0;t&&u(y(e).value,"none"),p&&p.dragEnd&&p.dragEnd(t)}}),v=(0,i.Z)(g);function y(e){const r=(d-l)/t,a=n?100*-e.y/v.height:100*e.x/v.width,i=(0,s.uZ)(0,100,a+h),o=Math.round(i/100*r);return{value:(0,s.uZ)(l,d,Math.round((l+o*t)*c)/c),valuePercentage:i}}return(0,o.Z)(g,((e,n)=>{const r=-1*Math.sign(e),a=n.shiftKey?10:1,i=(0,s.uZ)(l,d,Math.round((f.value+a*t*r)*c)/c);u(i,"none")})),r.useEffect((()=>{m({value:e,valuePercentage:(0,s.Sr)(l,d,e,0,100)})}),[e]),[f,g,v]}},73259:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(67294);const a=function(e,t){r.useEffect((()=>{function n(n){n.target===e.current&&(n.preventDefault(),t(n.deltaY,n))}return document.addEventListener("wheel",n,{passive:!1}),()=>document.removeEventListener("wheel",n)}),[e.current,t])}},12803:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Yi});var r=n(67294),a=n(51512),i=n(76383),o=n(29163),s=n(8211),c=n(74600),l=n(25999),d=n(4127),u=n(58321),p=n(25448),h=n(27722),f=n(16973),m=n(85763),g=n(22367);class v extends d.Z{constructor(e,t,n,r,a,i,o=!1){var s,c,l;super(e,t,n,r,a,i,o),this.drawerOptions.scale=null!==(s=null==n?void 0:n.scale)&&void 0!==s?s:1,this.drawerOptions.fixedLineWidth=null!==(c=null==n?void 0:n.fixedLineWidth)&&void 0!==c&&c,this.drawerOptions.translate=null!==(l=null==n?void 0:n.translate)&&void 0!==l?l:[0,0]}setOption(e,t){super.setOption(e,t)}applyDraw(e){var t,n,r,a;const i=(0,h.zO)(),o=this.scene,s=this.context;if(!s)return 0;s.globalCompositeOperation="source-over";const c=null!==(t=e.scale)&&void 0!==t?t:1,l=null!==(n=e.translate)&&void 0!==n?n:[0,0],d=null!==(r=e.time)&&void 0!==r?r:0,u=null!==(a=e.simmetricLines)&&void 0!==a?a:0,p=e.fixedLineWidth,g=e.clear,y=e.noBackground,b=e.backgroundImage,w=void 0!==e.ghosts&&e.ghosts>0&&void 0!==e.ghostIndex&&e.ghostIndex>0,_=w?1-e.ghostIndex/(e.ghosts+.5):0,x=!0===e.ghostAlpha,E=o.width,Z=o.height,k=E/Z,S=[c,c],C=[E/2-(c>1?l[0]*E/(1/((c-1)/2)):0),Z/2-(c>1?l[1]*Z/(1/((c-1)/2)):0)];if(g){if(y)s.clearRect(0,0,E,Z);else if(s.fillStyle=o.background,s.fillRect(0,0,E,Z),b){const t=b instanceof SVGImageElement?b.width.baseVal.value:b.width,n=b instanceof SVGImageElement?b.height.baseVal.value:b.height,r=t/n;let a=0,i=0,o=E,c=Z;r!==k&&("contain"===e.backgroundImageFit?(o=k>r?t*Z/n:E,c=k>r?Z:n*E/t):(o=k<r?t*Z/n:E,c=k<r?Z:n*E/t),a=(E-o)/2,i=(Z-c)/2),s.drawImage(b,a,i,o,c)}u>0&&v.drawSimmetricLinesWithScaleAndTranslate(s,u,E,Z,o.color,S,C)}{let e=!1,t=!1;o.currentTime=d,o.getChildren().forEach((n=>{n.data&&(!1===n.data.visible||w&&!0===n.data.disableGhost)||(n.generate(d,!0),s.save(),n.stream((n=>{const r=n.currentIndexing,a=r.shape,i=a.data||{},l={canvasContext:s,shape:a,repetition:r.repetition,parent:r.parent,time:o.currentTime,context:m.Z};s.beginPath(),s.moveTo((n.buffer[n.frameBufferIndex]-E/2)*S[0]+C[0],(n.buffer[n.frameBufferIndex+1]-Z/2)*S[1]+C[1]);for(let e=2;e<n.frameLength;e+=2)s.lineTo((n.buffer[n.frameBufferIndex+e]-E/2)*S[0]+C[0],(n.buffer[n.frameBufferIndex+e+1]-Z/2)*S[1]+C[1]);if(r.shape.isClosed()&&s.closePath(),i&&i.highlighted){const e=f.Z.getStreamDrawerProp(a,"lineWidth",l,1);return s.lineWidth=3*e*c,s.strokeStyle=o.color,void s.stroke()}let d=f.Z.getStreamDrawerProp(a,"fill",l);if(void 0!==d){if(w&&x){const t=f.Z.ghostifyColor(d,_);t?d=t:e||(console.warn(`[Urpflanze:DrawerCanvas] Unable ghost fill color '${d}',\n\t\t\t\t\t\t\t\tplease enter a rgba or hsla color`),e=!0)}s.fillStyle=d,s.fill()}let u=f.Z.getStreamDrawerProp(a,"stroke",l,void 0===d?o.color:void 0),h=f.Z.getStreamDrawerProp(a,"lineWidth",l,1);if(u){if(w&&x){const e=f.Z.ghostifyColor(u,_);e?u=e:t||(console.warn(`[Urpflanze:DrawerCanvas] Unable ghost stroke color '${u}',\n\t\t\t\t\t\t\t\tplease enter a rgba or hsla color`),t=!0),h*=_}s.lineWidth=p?h:h*c,s.strokeStyle=u,s.stroke()}})),s.restore())}))}return(0,h.zO)()-i}static generateImage(e,t=800,n=800,r,a){const i=new s.Z({width:t,height:n,background:r,color:a}),o=p.Z.create(e);if(o){const e=p.Z.copy(o,i,!0);if(e){i.add(e),i.update(0);const r=!1,a=v.adaptShapeToScene(e,i);return v.getSceneImage(i,t,n,r,a).then((e=>e.length?e:"/assets/images/broken-shape.png"))}}return Promise.resolve("/assets/images/broken-shape.png")}static adaptShapeToScene(e,t,n=1){t.update(0);const r=u.Z.getBounding(e.getBuffer());return.9*(n=Math.min(t.width,t.height)/Math.max(r.width,r.height)*n)}static getSceneImage(e,t=800,n=800,r=!1,a){return new Promise((i=>{if("undefined"!=typeof OffscreenCanvas){const o=new OffscreenCanvas(t,n);new v(e,o).applyDraw({time:0,fixedLineWidth:r,scale:a}),o.convertToBlob({type:"image/png",quality:.95}).then((e=>{const t=new FileReader;t.addEventListener("load",(()=>t.result?i(t.result):i("")),{passive:!0}),t.readAsDataURL(e)}))}else{const o=document.createElement("canvas");o.width=t,o.height=n,o.style.width=t+"px",o.style.height=n+"px";new v(e,o,{time:0,fixedLineWidth:r,scale:a}).applyDraw({time:0,fixedLineWidth:r,scale:a}),i(o.toDataURL())}}))}static drawSimmetricLinesWithScaleAndTranslate(e,t,n,r,a,i,o){const s=Math.PI/t,c=Math.max(n,r),l=[c/2,c/2];for(let n=0;n<t;n++){const t=[-c,-c],r=[2*c,2*c],d=n*s+Math.PI/4;g.Z.rotateZ(t,l,d),g.Z.rotateZ(r,l,d),e.beginPath(),e.strokeStyle=a,e.lineWidth=1,e.moveTo((t[0]-c/2)*i[0]+o[0],(t[1]-c/2)*i[1]+o[1]),e.lineTo((r[0]-c/2)*i[0]+o[0],(r[1]-c/2)*i[1]+o[1]),e.stroke()}}}const y=v;var b;!function(e){e[e.UNDO=0]="UNDO",e[e.REDO=1]="REDO",e[e.NONE=2]="NONE"}(b||(b={}));var w=n(58416);const _=class{constructor(e,t={},n=!1,r){this.id=e,this.preventPushToHistory=n||!1,this.data=t,this.setDescriptor()}redo(e){if(!this.passive){if(this.status!=b.REDO)try{(this.handleRedo(e)||!1)&&(this.status=b.REDO)}catch(e){return console.error(e),b.NONE}return this.status}return b.NONE}undo(e){if(!this.passive){if(this.status!=b.UNDO)try{(this.handleUndo(e)||!1)&&(this.status=b.UNDO)}catch(e){return console.error(e),b.NONE}return this.status}return b.NONE}handleRedo(e){return!1}handleUndo(e){return!1}setDescriptor(){}};const x=class extends _{constructor(){super(...arguments),this.slug="add",this.passive=!1,this.effects={scene_update:!0,scene_layers_update:!0,select_layer:[]}}handleRedo(e){const t=e.getScene(),n=(e.getDrawer(),p.Z.create(this.data.type,{id:this.data.added_id,name:this.data.added_name,order:this.data.added_order},t));if(n&&null==t.find(this.data.added_id)){if(n.scene=t,this.data.props&&Object.keys(this.data.props).forEach((e=>p.Z.set(n,e,this.data.props[e],t))),this.data.parent_id){const e=t.find(this.data.parent_id);if(!e)return!1;p.Z.add(e,n,void 0,t)}else t.add(n);return this.data.added_order=this.data.added_order||(null==n?void 0:n.order),this.data.added_name=this.data.added_name||(null==n?void 0:n.name),this.data.added_id=n.id,this.effects.select_layer=[this.data.added_id],!0}}handleUndo(e){const t=e.getScene();if(t.find(this.data.added_id))return t.removeFromId(this.data.added_id),this.effects.select_layer=[],!0}setDescriptor(){this.data.parent_id?this.descriptor=`add "${this.data.type}" to ${this.data.parent_id}`:this.descriptor=`add "${this.data.type}" to Scene`}};const E=class extends _{constructor(e,t,n=!1,r){super(e,t,n,r),this.slug="remove",this.passive=!1,this.effects={scene_update:!0,scene_layers_update:!0,select_layer:[]},t=Array.isArray(t)?t:[t];const a=r.getScene();r.getDrawer();this.data=t.map((e=>{var t;const n=a.find(e);return n?{id:e,copied_sceneChild:p.Z.copy(n,a,!0),parent_id:(null===(t=p.Z.getParent(n))||void 0===t?void 0:t.id)||null}:null})).filter((e=>!!e)).sort(((e,t)=>e&&t?e.copied_sceneChild.order-t.copied_sceneChild.order:0)),this.setDescriptor()}handleRedo(e){let t=!1;return this.data.forEach((n=>{const r=e.getScene().find(n.id);r&&(p.Z.remove(r),t=!0)})),t}handleUndo(e){let t=!1;return this.data.forEach((n=>{if(n.copied_sceneChild&&!e.getScene().find(n.id)){const r=n.copied_sceneChild,a=n.parent_id?e.getScene().find(n.parent_id):null;n.parent_id&&a?(p.Z.add(a,r),t=!0):null==n.parent_id&&(e.getScene().add(r),t=!0)}})),t}setDescriptor(){var e;this.data.length>=0?this.descriptor=`remove "${null===(e=this.data[0].copied_sceneChild)||void 0===e?void 0:e.id}"`:this.descriptor=`remove "${this.data.length}" scenechild`}};var Z=n(79324);const k=class extends _{constructor(e,t,n=!1,r){super(e,Array.isArray(t)?t:[t],n,r),this.slug="set-prop",this.passive=!1,this.effects={scene_update:!0,scene_child_prop_update:this.data.map((e=>({id:e.id,name:e.name,value:e.value})))},this.setDescriptor(r)}handleRedo(e){let t=!1,n=0;return this.data.forEach((({id:r,name:a,value:i})=>{const o=e.getScene().find(r);if(o&&this.effects.scene_child_prop_update){p.Z.set(o,a,i,e.getScene()),this.effects.scene_child_prop_update[n++].value=i,o instanceof Z.Z&&p.Z.getChildren(o).forEach((e=>{this.effects.scene_child_prop_update[n++]={id:e.id,name:a,value:i}}));const r=p.Z.getParent(o);r&&r instanceof Z.Z&&(r.setPropUnsafe(a,void 0),this.effects.scene_child_prop_update[n++]={id:r.id,name:a,value:void 0}),t=t||!0}})),t}handleUndo(e){let t=!1,n=0;return this.data.forEach((({id:r,name:a,prev_value:i})=>{const o=e.getScene().find(r);if(o&&this.effects.scene_child_prop_update){p.Z.set(o,a,i,e.getScene()),this.effects.scene_child_prop_update[n++].value=i,o instanceof Z.Z&&p.Z.getChildren(o).forEach((e=>{this.effects.scene_child_prop_update[n++]={id:e.id,name:a,value:i}}));const r=p.Z.getParent(o);r&&r instanceof Z.Z&&(r.setPropUnsafe(a,i),this.effects.scene_child_prop_update[n++]={id:r.id,name:a,value:i}),t=t||!0}})),t}setDescriptor(e){var t;if(1==this.data.length){const{name:n,id:r,prev_value:a,value:i}=this.data[0],o=(null===(t=null==e?void 0:e.getScene().find(r))||void 0===t?void 0:t.name)||r;this.descriptor=`set prop "${n}" of "${o}" from "${a}" to "${i}"`}else this.descriptor="set multiple prop"}};const S=class extends _{constructor(e,t,n=!1,r){super(e,Array.isArray(t)?t:[t],n,r),this.slug="set-prop",this.passive=!1,this.effects={scene_update:!0,scene_child_ui_prop_update:this.data.map((e=>({id:e.id,name:e.name,value:e.value})))},this.setDescriptor(r)}handleRedo(e){let t=!1,n=0;return this.data.forEach((({id:r,name:a,value:i})=>{const o=e.getScene().find(r);o&&this.effects.scene_child_ui_prop_update&&(o.data[a]=i,this.effects.scene_child_ui_prop_update[n++].value=i,t=t||!0)})),t}handleUndo(e){let t=!1,n=0;return this.data.forEach((({id:r,name:a,prev_value:i})=>{const o=e.getScene().find(r);o&&this.effects.scene_child_ui_prop_update&&(o.data[a]=i,this.effects.scene_child_ui_prop_update[n++].value=i,t=t||!0)})),t}setDescriptor(e){var t;if(1==this.data.length){const{name:n,id:r,prev_value:a,value:i}=this.data[0],o=(null===(t=null==e?void 0:e.getScene().find(r))||void 0===t?void 0:t.name)||r;this.descriptor=`set ui prop "${n}" of "${o}" from "${a}" to "${i}"`}else this.descriptor="set multiple prop"}};const C=class extends _{constructor(e,t,n=!1,r){super(e,t,n,r),this.slug="make-shape",this.passive=!1,this.effects={scene_update:!0,scene_layers_update:!0,select_layer:[]},this.data={ids:t,sceneChilds:t.map((e=>r.getScene().find(e))).filter((e=>null!==e)).sort(((e,t)=>(e.order||0)-(t.order||0)))}}hasSameParents(e){if(e.length<=1)return!0;const t=e.map((e=>p.Z.getParent(e)));let n=t[0];for(let e=1,r=t.length;e<r;e++){if(n!=t[e])return!1;n=t[e]}return!0}handleRedo(e){const t=e.getScene();if(this.data.sceneChilds.length>0&&this.hasSameParents(this.data.sceneChilds)){const n=this.data.sceneChilds,r=p.Z.getParent(n[0]),a=p.Z.create("Shape",{id:this.data.new_shape_id},t);return n.forEach((e=>{p.Z.remove(e),p.Z.add(a,e,void 0,t)})),r?p.Z.add(r,a):e.getScene().add(a),this.data.parent_id=r?r.id:null,this.data.new_shape_id=a.id,this.effects.select_layer=[this.data.new_shape_id],!0}}handleUndo(e){const t=e.getScene();if(this.data.sceneChilds.length>0&&this.data.new_shape_id){t.removeFromId(this.data.new_shape_id);const e=this.data.parent_id?t.find(this.data.parent_id):null;return e?this.data.sceneChilds.forEach((t=>p.Z.add(e,t))):this.data.sceneChilds.forEach((e=>t.add(e))),this.effects.select_layer=this.data.sceneChilds.map((e=>e.id)),!0}}setDescriptor(){this.descriptor="make shape"}};var O=n(31631);const P=class extends _{constructor(e,t,n,r=!1,a){super(e,n,!0,a),this.slug="move",this.passive=!1,this.effects={scene_update:!0,scene_layers_update:!0,select_layer:null},this.data={id:n,move:t,sceneChild:a.getScene().find(n)},this.setDescriptor()}handleRedo(e){var t;const n=e.getScene();if(this.data.sceneChild){const e=p.Z.getParent(this.data.sceneChild)||n;if(e instanceof s.Z||e instanceof Z.Z){const n=p.Z.getNeighbors(this.data.sceneChild),r=(0,O.indexOfObjectProperty)(n,"id",this.data.sceneChild.id),a="up"==this.data.move?r-1:"top"==this.data.move?0:"down"==this.data.move?r+1:n.length-1;a>=0&&a<n.length&&(n[r].order=(null!==(t=n[a].order)&&void 0!==t?t:0)+(a>r?1:-1),e.sortChildren())}return!0}}handleUndo(e){var t;const n=e.getScene();if(this.data.sceneChild){const e=p.Z.getParent(this.data.sceneChild)||n;if(e instanceof s.Z||e instanceof Z.Z){const n=p.Z.getNeighbors(this.data.sceneChild),r=(0,O.indexOfObjectProperty)(n,"id",this.data.sceneChild.id),a="down"==this.data.move?r-1:"bottom"==this.data.move?0:"up"==this.data.move?r+1:n.length-1;a>=0&&a<n.length&&(n[r].order=(null!==(t=n[a].order)&&void 0!==t?t:0)+(a>r?1:-1),e.sortChildren())}return!0}}setDescriptor(){this.descriptor="move "+this.data.move}};const A=class extends P{constructor(e,t,n=!1,r){super(e,"up",t,n,r),this.slug="move-up"}};const j=class extends P{constructor(e,t,n=!1,r){super(e,"down",t,n,r),this.slug="move-down"}};const M=class extends P{constructor(e,t,n=!1,r){super(e,"top",t,n,r),this.slug="move-to-top"}};const T=class extends P{constructor(e,t,n=!1,r){super(e,"bottom",t,n,r),this.slug="move-to-bottom"}};var I=n(87710);function L(e,t){const n=e.getBuffer();let r=null;if(n){const a=e.getProp("repetitions",void 0,1);e.generate(-1);const i=e.getIndexedBuffer();console.log(e,i);let o=0;for(let e=0;e<a;e++){const a=i[e].frameLength,s=new Array(a/2);for(let e=0,t=0;e<a;e+=2,t++,o+=2)s[t]={X:n[o],Y:n[o+1]};r=r?r[t](new I.ZP([s])):new I.ZP([s])}}return r||new I.ZP([[]])}const $=class extends _{constructor(){super(...arguments),this.slug="shape-operation",this.passive=!1,this.effects={scene_update:!0,scene_layers_update:!0,select_layer:[]}}handleRedo(e){const t=e.getScene(),n=(e.getDrawer(),t.find(this.data.a_id)),r=t.find(this.data.b_id);if(n&&r){const e=n.getBuffer(),a=r.getBuffer();if(e&&a&&e.length>0&&a.length>0){this.data.a=n,this.data.b=r;const e=function(e){const t=Array.prototype.concat.apply([],e.paths),n=2*t.length,r=new Float32Array(n);for(let e=0,a=0;e<n;e+=2,a++)r[e]=t[a].X,r[e+1]=t[a].Y;const a=u.Z.getBounding(r),i=a.width>a.height?1:a.width/a.height,o=a.width>a.height?a.height/a.width:1,s=e.paths.length,c=new Array(s);for(let t=0;t<s;t++){const n=e.paths[t],r=2*n.length,s=new Float32Array(r);for(let e=0,t=0;e<r;e+=2,t++)s[e]=i*((n[t].X-a.cx)/a.width)*2,s[e+1]=o*((n[t].Y-a.cy)/a.height)*2;c[t]=s}return c}(L(n,this.data.type)[this.data.type](L(r,this.data.type)));if(e&&e.length>0){const r=p.Z.getParent(n);let a=null;if(1==e.length)a=p.Z.create("ShapeBuffer",{shape:e[0]},t);else{a=p.Z.create("Shape",void 0,t);const n=p.Z.getCountSceneChildOfType(t,"ShapeBuffer")+1;if(a)for(let r=0;r<e.length;r++){const i=p.Z.create("ShapeBuffer",{shape:e[r]},t);i&&p.Z.add(a,i,{name:`ShapeBuffer_${n+r}`},t)}}if(a)return this.data.new_id=a.id,r?p.Z.add(r,a,void 0,t):t.add(a),t.removeFromId(this.data.a_id),t.removeFromId(this.data.b_id),this.effects.select_layer=[this.data.new_id],!0}}}return!1}handleUndo(e){const t=e.getScene();if(t.find(this.data.new_id)){t.removeFromId(this.data.new_id);const e=this.data.a_parent_id?t.find(this.data.a_parent_id):null,n=this.data.b_parent_id?t.find(this.data.b_parent_id):null;return e?p.Z.add(e,this.data.a,void 0,t):t.add(this.data.a),n?p.Z.add(n,this.data.b,void 0,t):t.add(this.data.b),this.effects.select_layer=[this.data.a_id,this.data.b_id],!0}}setDescriptor(){this.descriptor=`shape "${this.data.type}"`}};var R=n(79340);const D=class extends _{constructor(){super(...arguments),this.slug="create-from-buffer",this.passive=!1,this.effects={scene_update:!0,scene_layers_update:!0,select_layer:[]}}handleRedo(e){const t=e.getScene(),n=function(e,t){var n;const r=e.getScene();let a=null;if(t.length){const e=null===(n=R.Z.sideLength)||void 0===n?void 0:n.default;switch(t.length){case 0:a=null;break;case 1:a=p.Z.create("ShapeBuffer",{shape:t[0].buffer,sideLength:e,bCloseShape:t[0].closed},r);break;default:a=p.Z.create("Shape",void 0,r),a&&t.forEach(((t,n)=>{const i=p.Z.create("ShapeBuffer",{shape:t.buffer,sideLength:e,order:n,bCloseShape:t.closed},r);i&&p.Z.add(a,i,void 0,r)}))}r&&a&&r.add(a)}return a}(e.getDrawer(),this.data.buffers);if(n&&null==t.find(this.data.added_id))return this.data.added_id=n.id,this.effects.select_layer=[this.data.added_id],!0}handleUndo(e){const t=e.getScene();if(t.find(this.data.added_id))return t.removeFromId(this.data.added_id),this.effects.select_layer=[],!0}setDescriptor(){this.descriptor="create from buffer"}};const B=class extends _{constructor(e,t,n=!1,r){var a,i;super(e,t,n,r),this.slug="copy",this.passive=!1,this.effects={scene_update:!0,scene_layers_update:!0,select_layer:[]},this.data.refName=(null===(i=null===(a=r.getScene())||void 0===a?void 0:a.find(this.data.id))||void 0===i?void 0:i.name)||""}handleRedo(e){const t=e.getScene(),n=(e.getDrawer(),t.find(this.data.id));if(n){const e=p.Z.copy(n,t);if(e){if(this.data.parent_id){const n=t.find(this.data.parent_id);if(!n)return!1;p.Z.add(n,e,void 0,t)}else t.add(e);return this.data.added_order=this.data.added_order||(null==e?void 0:e.order),this.data.added_name=this.data.added_name||(null==e?void 0:e.name),this.data.added_id=e.id,this.effects.select_layer=[this.data.added_id],!0}}}handleUndo(e){const t=e.getScene().find(this.data.added_id);if(t)return p.Z.remove(t),this.effects.select_layer=[],!0}setDescriptor(){this.descriptor=`copy "${this.data.refName}"`}};const z=class extends _{constructor(e,t,n=!1,r){super(e,t,n,r),this.slug="cut",this.passive=!1,this.effects={scene_update:!0,scene_layers_update:!0,select_layer:[]};const a=r.getScene().find(this.data.id);a&&(this.data.parentSceneChild=p.Z.getParent(a),this.data.refName=a.name)}handleRedo(e){const t=e.getScene(),n=t.find(this.data.id);if(n){if(p.Z.remove(n),this.data.parent_id){const e=t.find(this.data.parent_id);e&&p.Z.add(e,n,void 0,t)}else t.add(n);return this.effects.select_layer=[this.data.id],!0}}handleUndo(e){const t=e.getScene(),n=t.find(this.data.id);if(n)return p.Z.remove(n),this.data.parentSceneChild?p.Z.add(this.data.parentSceneChild,n):t.add(n),this.effects.select_layer=[],!0}setDescriptor(){this.descriptor=`cut "${this.data.refName}"`}};var F=n(34406);const q=class extends _{constructor(e,t,n=!1,r){super(e,t,n,r),this.slug="subdivide",this.passive=!1,this.effects={scene_update:!0,scene_child_prop_update:[{id:t.id,name:"shape",value:null},{id:t.id,name:"type",value:"ShapeBuffer"}]},this.setDescriptor(r)}handleRedo(e){let t=!1;const n=e.getScene().find(this.data.id);return n&&n instanceof F.Z&&this.effects.scene_child_prop_update&&(this.data.prev_shape=Float32Array.from(n.shape),n.subdivide(),n.type="ShapeBuffer",this.effects.scene_child_prop_update[0].value=n.shape,t=!0),t}handleUndo(e){let t=!1;const n=e.getScene().find(this.data.id);return n&&n instanceof F.Z&&this.effects.scene_child_prop_update&&(n.setShape(this.data.prev_shape),this.effects.scene_child_prop_update[0].value=n.shape,t=!0),t}setDescriptor(e){this.descriptor="subdivide shapebuffer points"}};class U extends c.Z{constructor(){super(),this.command_increment_id=0,this.commmands={add:x,copy:B,cut:z,"create-from-buffer":D,"shape-operation":$,remove:E,"set-prop":k,"set-ui-prop":S,"make-shape":C,"move-up":A,"move-down":j,"move-to-top":M,"move-to-bottom":T,subdivide:q},this.history=[],this.current_history_index=0}execute(e,t,n,r){if(!(t in this.commmands))return void console.warn(`Command history: command "${t}" not recognized.`);const a=new this.commmands[t](++this.command_increment_id,n,r,e);return a.redo(e)!==b.NONE?a.preventPushToHistory?{scene_update:a.effects.scene_update,scene_layers_update:a.effects.scene_layers_update}:(this.reindexingHistory(),this.history.unshift(a),this.history.length>=U.MAX_HISTORY&&(this.history=this.history.slice(0,U.MAX_HISTORY)),this.dispatchHistoryUpdate(),a.effects):void 0}handleCommandEffect(e,t){e&&Object.keys(e).forEach((n=>{const r=Array.isArray(e[n])?e[n]:[e[n]];switch(n){case"scene_child_prop_update":if(void 0===t[n])t[n]=[r];else{const a=t[n];let i=!1;for(let e=0,t=a.length;e<t;e++)for(let t=0,n=r.length;e<n;e++)a[e].id==r[t].id&&a[e].name==r[t].name&&(a[e].value=r.value,i=!0);!i&&t[n].push(e[n])}break;default:t[n]=t[n]||e[n]}}))}goTo(e,t){if(t==this.current_history_index)return;const n={};if(t>this.current_history_index)for(let r=t-this.current_history_index-1;r>=0;r--)this.handleCommandEffect(this.undo(e,!0),n);if(t<this.current_history_index)for(let r=this.current_history_index-t-1;r>=0;r--)this.handleCommandEffect(this.redo(e,!0),n);return this.dispatchHistoryUpdate(),n}redo(e,t=!1){if(this.history.length>0&&this.current_history_index>0){const n=(0,w.uZ)(0,this.history.length,this.current_history_index-1),r=this.history[n];return r.redo(e),this.current_history_index=n,t||this.dispatchHistoryUpdate(),r.effects}}undo(e,t=!1){if(this.history.length>=0&&this.current_history_index<this.history.length){const n=(0,w.uZ)(0,this.history.length,this.current_history_index),r=this.history[n];return r.undo(e),this.current_history_index=n+1,t||this.dispatchHistoryUpdate(),r.effects}}reindexingHistory(){if(this.current_history_index>0)for(let e=0,t=this.current_history_index;e<t;e++)this.history.shift();this.current_history_index=0}dispatchHistoryUpdate(){const e=this.history.map(((e,t)=>({id:e.id,command:e.descriptor,level:t,status:e.status,bLast:t==this.current_history_index,passive:e.passive}))).filter((e=>!e.passive));this.dispatch("command_history:update_history",e)}clear(){this.history=[],this.command_increment_id=0,this.current_history_index=0}}U.MAX_HISTORY=100;const N=U;function V(e,t,n){t.data[e]=n,p.Z.getChildren(t).forEach((t=>V(e,t,n)))}var G=n(36427);var H=n(13831),Y=n(24114),W=n(9006);const X=(e,t,n,r)=>{t.resize(n,n,r),t.redraw()};function K(e,t,n){const r=H.Z.parse(t),a=void 0!==typeof OffscreenCanvas?new OffscreenCanvas(n.size,n.size):document.createElement("canvas");return r.resize(n.size,n.size,r.getRatio()),r.setCanvas(a),r.setOption({noBackground:"image/png"===n.type&&n.noBackground,time:n.time}),r.getTimeline().setTime(n.time),r}var J=n(21265);var Q=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};var ee=n(665),te=n(51205);var ne=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};const re={"export-json":function(e,t){const{name:n}=e.args;return Y.Z.parse(t.getDrawer(),n)},"export-gcode":function(e,t){const{settings:n}=e.args;return ee.Z.parse(t.getDrawer(),n)},"import-json":function(e,t){const n=e.args,r=H.Z.parse(n);if(te.Z.log("Temporany","importJSON",n,r),r){t.updateDrawer(r),t.getCommandHistory().clear();const e=Y.Z.parseAsProject(r);return e.open_layer_properties=void 0,e.selected_layers=[],e.history=[],t.sendEvent("project:init",e),te.Z.log("Temporany","importJSON init",e),e}return null},"append-json":function(e,t){const n=e.args,r=t.getDrawer(),a=t.getScene(),i=H.Z.parse(n);if(i){const e=i.getScene();e&&e.getChildren().forEach((e=>{a.find(e.id)||a.add(e)}));const n=Object.values(Y.Z.parseAsProject(r).scene);return t.sendEvent("scene:update-layers",{layers:n}),r.redraw(),!0}return!1},"layer-highlight":function(e,t){const n=t.getScene().find(e.args.id);n&&(V("highlighted",n,e.args.status),t.getDrawer().flushBuffer(),t.getDrawer().redraw())},"layer-visibility":[function(e,t){const n=t.getScene().find(e.args.id);n&&(V("visible",n,e.args.status),t.getDrawer().flushBuffer(),t.getDrawer().redraw())},"scene_layers_update"],"layer-ghost":[function(e,t){const n=t.getScene().find(e.args.id);n&&(n.data.disableGhost=e.args.status,t.getDrawer().redraw())},"scene_layers_update",({id:e,status:t})=>({scene_child_ui_prop_update:[{id:e,name:"disableGhost",value:t}]})],"layer-rename":[function(e,t){const{id:n,name:r}=e.args,a=t.getScene().find(n);a&&(a.name=r)},"scene_layers_update"],"toggle-timeline":(e,t)=>{const n=t.getDrawer();n.getTimeline().bSequenceStarted()?n.pauseAnimation():n.playAnimation()},"change-timeline-state":(e,t)=>{const n=t.getDrawer();e.args==G.Z.START?!n.getTimeline().bSequenceStarted()&&n.playAnimation():n.getTimeline().bSequenceStarted()&&n.pauseAnimation()},"set-timeline-duration":(e,t)=>{const n=t.getDrawer(),r=e.args;n.getTimeline().setDuration(r)},"set-timeline-framerate":(e,t)=>{const n=t.getDrawer(),r=e.args;n.getTimeline().setFramerate(r)},"set-timeline":(e,t)=>{const n=t.getDrawer(),r=e.args;n.getTimeline().setTime(r),n.redraw()},"timeline-sequence":(e,t)=>t.getDrawer().getTimeline().getSequence(),"set-drawer-offsets":(e,t)=>{const n=t.getDrawer(),{scale:r,translate:a}=e.args;n.setOption({scale:r,translate:a}),n.redraw()},"set-drawer-lines":(e,t)=>{const n=t.getDrawer(),r=e.args;n.setOption("simmetricLines",r),n.redraw()},"set-drawer-clear":(e,t)=>{const n=t.getDrawer(),r=e.args;n.setOption("clear",r),n.redraw(),t.sendEvent("project:update-properties",{clear:r})},"set-drawer-ghosts":(e,t)=>{const n=t.getDrawer(),{ghosts:r,ghostSkipTime:a}=e.args;n.setOption("ghosts",r),n.setOption("ghostSkipTime",a),n.redraw(),t.sendEvent("project:update-properties",{ghosts:Math.round(10*r)/10,ghostSkipTime:Math.round(10*a)/10})},"set-drawer-ratio":(e,t)=>{const{size:n,ratio:r}=e.args;X(t.getScene(),t.getDrawer(),n,r),t.sendEvent("project:update-properties",{ratio:r})},"set-scene-background":(e,t)=>{const n=t.getScene(),r=t.getDrawer(),{background:a,preventDispatch:i}=e.args;n.background=a,r.flushBuffer(),r.redraw(),!i&&t.sendEvent("project:update-properties",{background:a})},"set-background-image":(e,t)=>{const{image:n,source:r}=e.args;t.getDrawer().setOption("backgroundImage",n),t.getDrawer().redraw();const a=r;t.sendEvent("project:update-properties",{backgroundImage:a})},"get-rendered-frames":(e,t)=>t.getDrawer().getRenderedFrames(),"render-image":(e,t)=>{const n=t.getDrawer();n.stopAnimation();const r=e.args.settings,a=Y.Z.parse(n),i=t.getRenderer();if("image/svg+xml"===r.type){const e=K(0,a,r);return JSON.stringify({svg:W.Z.parse(e,r)})}const o=K(0,a,r);return i.renderImage(o,r)},"render-animation":(e,t)=>{const n=t.getDrawer();n.stopAnimation();const r=e.args.settings,a=Y.Z.parse(n),i=t.getRenderer(),o=K(0,a,r);return i.renderAnimation(o,r)},"render-stop":(e,t)=>{t.getRenderer().stop()},prop:(e,t)=>{var n;const{id:r,name:a}=e.args,i=t.getScene().find(r);if(0==a.indexOf("loop.")&&i instanceof J.Z){const e=a.substr(5);return null!==(n=i.getLoop()[e])&&void 0!==n?n:void 0}return i?i.getProp(a):void 0},"single-bounding":(e,t)=>{const n=t.getScene(),r=t.getScene().find(e.args.id);if(r){const e=r.getProp("repetitions",void 0,1),t=r.getProp("distance",void 0,0);r.setProp({repetitions:1,distance:0},void 0,!0),r.generate(Math.random(),!0);const a=u.Z.getBounding(r.getBuffer());return r.setProp({repetitions:e,distance:t}),a.x/=n.width,a.y/=n.height,a.cx/=n.width,a.cy/=n.height,a.width/=n.width,a.height/=n.height,a}return null},toolbar:function(e,t){return Q(this,void 0,void 0,(function*(){const{size:t,color:n}=e.args,r=p.Z.getRegistered();["ShapeLoop","ShapeBuffer","Shape","Group"].forEach((e=>{r.splice(r.indexOf(e),1)}));const a=[],i=[];r.forEach((e=>{i.push(y.generateImage(e,t,t,void 0,n))}));const o=yield Promise.all(i);return r.forEach(((e,t)=>{a.push({name:e,image:o[t]})})),a}))},"scene-points":(e,t)=>{const n=t.getScene().getChildren().reduce(((e,t)=>e+t.getBufferLength()),0)/2,r=t.getDrawer().getOption("ghosts",0);return r&&r>0?n*r:n},"get-buffer-length":(e,t)=>{var n;const r=null===(n=t.getScene().find(e.args.id))||void 0===n?void 0:n.getBufferLength();return r?r/2:0}};var ae=n(35648);const ie=Float32Array.from([-1,.4957,0,-.0813,1,.4957,1,-.0813,0,-.6582,-1,-.0813]),oe=Float32Array.from([-.3676,.4804,-0,.2683,.3676,.4804,.3676,.2683,-0,.0562,-.3676,.2683]);class se extends ae.Z{constructor(e={}){e.type="Desidus",super(e),this.created=!1,e.data.imported||this.buildShape()}buildShape(){var e;if(!this.created&&!this.shape){const t=null===(e=R.Z.sideLength)||void 0===e?void 0:e.default,n=p.Z.create("Group",{name:this.name+"_Group"},this.scene),r=p.Z.create("ShapeBuffer",{name:this.name+"_top",shape:ie},this.scene),a=p.Z.create("ShapeBuffer",{name:this.name+"_bottom",shape:oe},this.scene);r.data.props.sideLength=t,a.data.props.sideLength=t,this.setShape(n),n.add(r),n.add(a),this.created=!0}}setProp(e,t){super.setProp(e,t),this.buildShape()}}const ce=se;var le=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};class de extends c.Z{constructor(){super();const e=new s.Z;e.color=i.Z.color("primary").toString("hex"),e.background=i.Z.color("dark").toString("hex");const t=new y(e);t.getTimeline().setSequence(6e3,60),this.updateDrawer(t),this.renderer=new l.Z,this.commandHistory=new N,this.commandHistory.attach("command_history:update_history",this.sendEvent.bind(this,"command_history:update_history")),this.renderer.attach("renderer:start",this.sendEvent.bind(this,"renderer:start")),this.renderer.attach("renderer:render-frame",this.sendEvent.bind(this,"renderer:render-frame")),p.Z.register("Desidus",ce)}sendEvent(e,t){this.dispatch("event",{event:e,data:t})}getScene(){return this.scene}setScene(e){this.scene&&this.scene.resize(this.scene.width,this.scene.height),this.scene=e,this.drawer.setScene(this.scene),this.drawer.redraw()}getDrawer(){return this.drawer}setDrawer(e){e.canvas&&this.drawer.setCanvas(e.canvas),(e.size||e.ratio)&&X(this.scene,this.drawer,e.size,e.ratio),this.sendEvent("drawer:update",{})}updateDrawer(e){if(this.drawer&&this.drawer.getCanvas()){const t=this.drawer.getCanvas();e.setCanvas(t)}this.drawer=new y(e.getScene(),e.getCanvas(),e.getOptions(),e.getRatio(),e.getTimeline().getSequence().duration,e.getTimeline().getSequence().framerate),this.drawer.setBuffering(!0);const t=this.drawer.getScene();t&&this.setScene(t),this.drawer.attach("drawer-canvas:buffer_loaded",this.sendEvent.bind(this,"drawer-canvas:buffer_loaded")),this.drawer.attach("drawer-canvas:buffer_flush",this.sendEvent.bind(this,"drawer-canvas:buffer_flush")),this.drawer.getTimeline().attach("timeline:update_sequence",this.sendEvent.bind(this,"timeline:update_sequence")),this.drawer.getTimeline().attach("timeline:change_status",this.sendEvent.bind(this,"timeline:change_status")),this.drawer.getTimeline().attach("timeline:progress",this.sendEvent.bind(this,"timeline:progress")),this.sendEvent("drawer:update",{})}getRenderer(){return this.renderer}getCommandHistory(){return this.commandHistory}read(e){return le(this,void 0,void 0,(function*(){te.Z.log("Comunication",e.deferred_id,e);try{let t,n;switch(e.type){case"set-drawer":yield this.setDrawer(e.args);break;case"run":{const n=e.args;t=yield this.commandHistory.execute(this,e.command,n.args,n.preventPushToHistory);break}case"ask":{const r=yield function(e,t){return ne(this,void 0,void 0,(function*(){if(e.command in re){const n=re[e.command],r=Array.isArray(n)?n:[n];let a;if(r.length>1){a={};for(let t=1;t<r.length;t++){const n=r[t];if("string"==typeof n)a[n]=!0;else{const t=n(e.args);Object.keys(t).forEach((e=>a[e]=t[e]))}}}return{data:yield r[0](e,t),execution_effects:a}}console.warn(`Executor Ask '${e.command}' command not recognized`)}))}(e,this);n=null==r?void 0:r.data,t=null==r?void 0:r.execution_effects;break}case"undo":t=yield this.commandHistory.undo(this);break;case"redo":t=yield this.commandHistory.redo(this);break;case"history":t=yield this.commandHistory.goTo(this,e.args)}if(t){const n={type:"execution-effect",deferred_id:e.deferred_id,effect:"no-effect"};return t.scene_update&&(this.drawer.buffer.flush(),this.drawer.redraw()),t.scene_layers_update&&(n.effect="scene:update-layers",n.data={layers:Object.values(Y.Z.parseAsProject(this.drawer).scene),selecteds:t.select_layer?t.select_layer:void 0}),t.scene_child_prop_update&&(n.effect="scene:update-scene_child-prop",n.data=t.scene_child_prop_update),t.scene_child_ui_prop_update&&(n.effect="scene:update-scene_child-ui-prop",n.data=t.scene_child_ui_prop_update),n}return{deferred_id:e.deferred_id,type:"response",command:e.command,data:n}}catch(t){return{deferred_id:e.deferred_id,type:"response-unresolved",command:e.command,data:t}}}))}}const ue=de;var pe=n(27118),he=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};class fe extends c.Z{constructor(e){super(),this.bRunOnLocal=e,this.response_promises=[],this.increment_deferred_id=0,this.bCanvasMounted=!1,this.proxyComunicationResponse=this.proxyComunicationResponse.bind(this),this.onDeamonMessage=this.onDeamonMessage.bind(this),this.bRunOnLocal?(this.executor=new ue,this.executor.attach("event",(e=>{if(e){const t=Object.assign({type:"event"},e);this.dispatch(t.event,t.data)}}))):(this.deamonWorker=new Worker("deamon.js"),this.deamonWorker.addEventListener("message",this.onDeamonMessage))}hasAutosave(){return pe.Z.has("autosave")}getAutosaveProjectId(){var e;return this.hasAutosave()?null===(e=pe.Z.get("autosave",void 0))||void 0===e?void 0:e.id:void 0}autosave(e){return new Promise(((t,n)=>{this.ask("export-json",e).then((e=>{e?(pe.Z.set("autosave",e),t()):n()})).catch(n)}))}restoreAutosave(){return he(this,void 0,void 0,(function*(){const e=pe.Z.get("autosave",void 0,!0);e&&this.ask("import-json",e)}))}setDrawer(e,t,n,r){if(!this.bCanvasMounted&&e){if(this.bCanvasMounted=!0,this.bRunOnLocal)return console.log("Drawer work sync"),this.proxyComunicationDispatcher("set-drawer","set-drawer",{canvas:e,size:t,ratio:n,resolution:r});{console.log("Drawer work on async service");const a=e.transferControlToOffscreen();return this.proxyComunicationDispatcher("set-drawer","set-drawer",{canvas:a,size:t,ratio:n,resolution:r},[a])}}return this.proxyComunicationDispatcher("set-drawer","set-drawer",{size:t,ratio:n,resolution:r})}run(e,t,n){const r={args:t,preventPushToHistory:n};return this.proxyComunicationDispatcher("run",e,r)}ask(e,t,n){return this.proxyComunicationDispatcher("ask",e,t,n)}undo(){return this.proxyComunicationDispatcher("undo","undo")}redo(){return this.proxyComunicationDispatcher("redo","redo")}history(e=0){return this.proxyComunicationDispatcher("history","history",e)}onDeamonMessage(e){const t=e.data;if("event"==t.type){const e=t;this.dispatch(e.event,e.data)}else{const e=t;this.proxyComunicationResponse(e)}}proxyComunicationDispatcher(e,t,n,r){return he(this,void 0,void 0,(function*(){const a=this.createDeferred(),i=++this.increment_deferred_id,o={type:e,command:t,args:n,deferred_id:i};return this.dispatch("executor-work",{waiting:this.response_promises.length}),this.response_promises.push({deferred_id:i,promise:a}),this.bRunOnLocal?this.proxyComunicationResponse(yield this.executor.read(o)):this.deamonWorker.postMessage(o,r),a.promise}))}proxyComunicationResponse(e){te.Z.log("ComunicationResponse",e.deferred_id,e);for(let t=0,n=this.response_promises.length;t<n;t++)if(this.response_promises[t].deferred_id===e.deferred_id){"response-unresolved"===e.type?this.response_promises[t].promise.reject(e.data):this.response_promises[t].promise.resolve(e.data),this.response_promises.splice(t,1);break}return 0==this.response_promises.length&&(this.increment_deferred_id=0,this.dispatch("executor-work",{waiting:this.response_promises.length})),"execution-effect"==e.type&&this.dispatch(e.effect,e.data),e}createDeferred(){const e={resolve:void 0,reject:void 0,promise:void 0},t=new Promise(((t,n)=>{e.resolve=t,e.reject=n}));return e.promise=t,e}}const me=fe;var ge=n(84782),ve=n(71866),ye=n(31695);const be=new me(!(0,h.tg)());window.executor=be,be.attach("project:init",(e=>{ge.Z.dispatch((0,ve.L0)(e))})),be.attach("project:update-properties",(e=>{ge.Z.dispatch((0,ve.JR)(e))})),be.attach("scene:update-layers",(e=>{const t=e;ge.Z.dispatch((0,ve.OU)(t.layers,t.selecteds))})),be.attach("scene:update-scene_child-prop",(e=>{ge.Z.dispatch((0,ve.N1)(e))})),be.attach("scene:update-scene_child-ui-prop",(e=>{ge.Z.dispatch((0,ve.EY)(e))})),be.attach("timeline:change_status",(e=>{ge.Z.dispatch((0,ye.C3)(e==G.Z.START))})),be.attach("timeline:update_sequence",(e=>{ge.Z.dispatch((0,ve.Tf)(e))})),be.attach("command_history:update_history",(e=>{ge.Z.dispatch((0,ve.ZA)(e))}));const we=be,_e=i.Z.color("dark-lighten").alpha(.9),xe=o.ZP.div`
    position: fixed;
    top: ${i.Z.add(2,0)};
    left: ${i.Z.add(2,0)};
    background: ${_e.toString("rgba")};
    font-size: 1rem;
    border-radius: 2px;
    z-index: 2;
`,Ee=o.ZP.li`
    position: relative;
    padding: 0 ${i.Z.ms(0)} 0 ${i.Z.ms(-1)};
    cursor: pointer;

    &:hover { 
        background: ${i.Z.color("dark-verylighten")};
    }

    &:before {
        display: inline-block; 
        vertical-align: middle;
        content: ' ';
        width: 5px;
        height: 5px;
        border-radius: 3px;
        transform: translateY(-2px);
        z-index: 1;
        margin-right: ${i.Z.ms(-1)};
        ${e=>e.current&&"background: #fff;"}
    }
`,Ze=(0,a.$j)((e=>({history:e.project.history})))((({history:e})=>{function t(e){we.history(e)}let n=!1;return r.createElement(xe,null,r.createElement("div",{style:{borderBottom:"1px solid "+i.Z.color("dark-verylighten"),padding:`${i.Z.ms(-1)} ${i.Z.ms(0)}`}},"History"),r.createElement("ul",{style:{margin:0,padding:`${i.Z.ms(-2)} 1px`,listStyle:"none",maxHeight:"70vh",overflow:"auto"}},e.length>0&&e.map((e=>(n=n||e.bLast,r.createElement(Ee,{current:e.bLast,key:e.id,onClick:()=>t(e.level)},e.command)))),r.createElement(Ee,{current:!n,onClick:()=>t(e.length)},"Original")))}));var ke=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};const Se=o.ZP.ul`
    background: ${i.Z.color("dark-lighten")};
    line-height: ${i.Z.ms(1)};
    position: absolute;
    margin: 0; 
    padding: ${i.Z.ms(-2)} 1px; 
    top: 100%;
    left: 0;
    list-style: none; 
    transform: translateY(-2px);

    li {
        padding: 0 ${i.Z.ms(0)};
        white-space: nowrap;

        &:hover {
            background: ${i.Z.color("dark-verylighten")}
        }
    }
`,Ce=e=>{var{actions:t}=e,n=ke(e,["actions"]);return r.createElement(Se,null,t.map(((e,t)=>null==e?r.createElement("li",{key:t,style:{height:"1px",lineHeight:0,margin:`${i.Z.ms(-2)} 0`,background:i.Z.color("dark-verylighten").toString()}}):r.createElement("li",{key:t,onClick:()=>e.action(n)},e.name))))},Oe=[{name:"Splash Screen",action:()=>{ge.Z.dispatch((0,ye.Tv)())}}];function Pe(e,t,n=3e3){const{message_id:r}=ge.Z.dispatch((0,ye.PV)(e,t));setTimeout((()=>{ge.Z.dispatch((0,ye.SR)(r))}),n)}var Ae=n(51304),je=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};function Me(e,t,n){console.log({name:e,data:t,mime:n});const r=new Blob([t],{type:n}),a=URL.createObjectURL(r),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download",e),i.setAttribute("target","_blank"),document.body.appendChild(i),i.click(),URL.revokeObjectURL(a),i.remove()}function Te(e=!1){return je(this,void 0,void 0,(function*(){return new Promise((e=>{const t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("accept","."+Ae.Z.file_extension),t.style.position="absolute",t.style.top="-100000",t.style.left="-100000",t.style.display="none",t.addEventListener("change",(n=>je(this,void 0,void 0,(function*(){const r=yield function(e){if(e.target.files&&e.target.files.length>0){const t=e.target.files[0],n=new TextDecoder("utf-8");return new Promise((e=>{const r=new FileReader;r.addEventListener("load",(()=>je(this,void 0,void 0,(function*(){const t=r.result;try{const r=n.decode(t);e(r)}catch(t){e(null)}}))),{passive:!0}),r.readAsArrayBuffer(t)}))}return Promise.resolve(null)}(n);t.remove(),e(r)}))),{passive:!0}),document.body.appendChild(t),t.click()}))}))}var Ie=n(73935);const Le=document.getElementById("prompt-root"),$e=({onResult:e,label:t,defaultValue:n})=>{const a=r.createRef(),i=r.createRef();function o(){var t;const n=(null===(t=i.current)||void 0===t?void 0:t.value)||"";n.length>0?e(n):s()}function s(){if(a.current){const e=a.current;e.classList.remove("prompt--focus"),setTimeout((()=>{var t;e.classList.add("prompt--focus"),null===(t=i.current)||void 0===t||t.focus(),setTimeout((()=>{e.classList.remove("prompt--focus")}),500)}))}}return r.useEffect((()=>(Le.className="open",document.addEventListener("click",s,{passive:!0}),()=>{Le.className="",document.removeEventListener("click",s)})),[]),r.createElement("div",{ref:a,className:"prompt"},r.createElement("div",{className:"prompt__label"},t),r.createElement("input",{className:"prompt__input",autoFocus:!0,ref:i,defaultValue:n,onFocus:e=>e.target.select(),onKeyDown:e=>13==e.keyCode&&o()}),r.createElement("div",{className:"prompt__confirm_buttons"},r.createElement("button",{className:"prompt__button",onClick:o},"Save"),r.createElement("button",{className:"prompt__button",onClick:()=>e(null)},"Cancel")))},Re=()=>null;const De=function(e,t){return new Promise((n=>{Ie.render(r.createElement($e,{onResult:function(e){n(e),Ie.render(r.createElement(Re,null),Le)},label:e,defaultValue:t}),Le)}))};var Be=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};function ze(e){return Be(this,void 0,void 0,(function*(){const t=yield De("Set project name",Ae.Z.empty_project_name);if(null!==t){if(yield we.ask("import-json",JSON.stringify({name:t,scene:{},background:i.Z.color("dark").toString("hex"),mainColor:i.Z.color("primary").toString("hex"),sequence:{start:0,end:6e3,durate:6e3,framerate:60}})))return Pe(t+" created."),void(e&&e());Pe("creation error")}e&&e()}))}function Fe(e=!1,t){return Be(this,void 0,void 0,(function*(){const n=yield Te(e);if(n){if(yield we.ask(e?"append-json":"import-json",n))return t&&t(),void Pe(e?"added to scene":"imported")}Pe("error import")}))}const qe=[{name:"New",action:()=>{ze()}},{name:"Open",action:()=>{Fe()}},{name:"Recover",action:()=>{we.restoreAutosave()}},{name:"Import",action:()=>{Fe(!0)}},{name:"Save",action:({project:e})=>{we.autosave(e).then((()=>{Pe("Save complete")}))}},{name:"Save As",action:({project:e})=>Be(void 0,void 0,void 0,(function*(){const t=yield De("Project name",e.name&&e.name.length>0?e.name:Ae.Z.empty_project_name),n=yield we.ask("export-json",{name:t}),r=(new TextEncoder).encode(n);Me(e.name+"."+Ae.Z.file_extension,r,"application/octet-stream")}))}],Ue=[{name:"Undo",action:()=>{we.undo()}},{name:"Redo",action:()=>{we.redo()}},null,{name:"History",action:({setOpenHistory:e})=>{e(!0)}}],Ne=[{name:"Render Image",action:()=>{ge.Z.dispatch((0,ye.h7)("render-image"))}},{name:"Render Animation",action:()=>{ge.Z.dispatch((0,ye.h7)("render-animation"))}},{name:"Generate GCODE",action:()=>{ge.Z.dispatch((0,ye.h7)("generate-gcode"))}}],Ve=document.getElementById("prompt-root"),Ge=({onResult:e,label:t,ok:n,no:a})=>{const i=r.createRef();function o(){if(i.current){const e=i.current;e.classList.remove("prompt--focus"),setTimeout((()=>{e.classList.add("prompt--focus"),setTimeout((()=>{e.classList.remove("prompt--focus")}),500)}))}}return r.useEffect((()=>(Ve.className="open",document.addEventListener("click",o,{passive:!0}),()=>{Ve.className="",document.removeEventListener("click",o)})),[]),r.createElement("div",{ref:i,className:"prompt"},r.createElement("div",null,r.createElement("div",{className:"prompt__label"},t),r.createElement("div",{className:"prompt__confirm_buttons"},r.createElement("button",{className:"prompt__button",onClick:()=>e(!0)},n),r.createElement("button",{className:"prompt__button",onClick:()=>e(!1)},a))))},He=()=>null;const Ye=function(e,t="Accept",n="Cancel"){return new Promise((a=>{Ie.render(r.createElement(Ge,{onResult:function(e){a(e),Ie.render(r.createElement(He,null),Ve)},label:e,ok:t,no:n}),Ve)}))};var We,Xe=n(76554),Ke=(n(67442),n(50607)),Je=n(31324),Qe=n(11673),et=n(75154),tt=(We=function(e,t){return(We=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}We(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});const nt=function(e){function t(t){void 0===t&&(t={});var n=this;return t.type="Group",(n=e.call(this,t)||this).children=[],["id","name","data","order","type"].forEach((function(e){e in t&&delete t[e]})),n.props=t,n}return tt(t,e),t.prototype.isStatic=function(){for(var e=this.children,t=0,n=e.length;t<n;t++)if(!e[t].isStatic())return!1;return!0},t.prototype.isStaticIndexed=function(){for(var e=this.children,t=0,n=e.length;t<n;t++)if(!e[t].isStaticIndexed())return!1;return!0},t.prototype.add=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=function(n,r){var i=t[n],o=i.getProps();Object.keys(a.props).forEach((function(t){void 0===o[t]&&i.setProp(t,e.props[t])})),i.order=void 0!==i.order?i.order:a.children.length>0?Math.max.apply(a,a.children.map((function(e){return e.order||0})))+1:0,a.scene&&ot.propagateToChilden(i,a.scene),a.children.push(i)},a=this,i=0,o=t.length;i<o;i++)r(i,o);this.sortChildren()},t.prototype.sortChildren=function(){this.children.sort((function(e,t){return e.order-t.order})),this.children=this.children.map((function(e,t){return e.order=t,e})),this.clearBuffer(!0)},t.prototype.getChildren=function(){return this.children},t.prototype.find=function(e){if(this.id===e||this.name===e)return this;for(var t=this.getChildren(),n=0,r=t.length;n<r;n++){var a=t[n].find(e);if(null!==a)return a}return null},t.prototype.get=function(e){return e>=0&&e<this.children.length?this.children[e]:null},t.prototype.remove=function(e){if(e>=0&&e<this.children.length){var t=this.children.splice(e,1);return this.clearBuffer(!0),t}return!1},t.prototype.removeFromId=function(e){for(var t=0,n=this.children.length;t<n;t++)if(this.children[t].id==e)return this.children.splice(t,1),this.clearBuffer(!0)},t.prototype.generate=function(e,t,n){void 0===t&&(t=!1),this.children.forEach((function(r){return r.generate(e,t,n)}))},t.prototype.getBounding=function(){var e=[],t=et.Z.empty();if(this.children.length>0){this.children.forEach((function(t){return e.push(t.getBounding())}));for(var n=0,r=this.children.length;n<r;n++)t.x=t.x>e[n].x?e[n].x:t.x,t.y=t.y>e[n].y?e[n].y:t.y,t.width=t.width<e[n].width?e[n].width:t.width,t.height=t.height<e[n].height?e[n].height:t.height;t.cx=t.x+t.width/2,t.cy=t.y+t.height/2}return t},t.prototype.clearBuffer=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!0),this.children.forEach((function(t){return t.clearBuffer(e,!1)})),this.scene&&t){var n=this.scene.getParentsOfSceneChild(this);n.length>0&&n[n.length-1].clearBuffer(e,t)}},t.prototype.setProp=function(e,t){var n=this;"object"==typeof e?Object.keys(e).forEach((function(t){return n.props[t]=e[t]})):this.props[e]=t,this.children.forEach((function(n){return n.setProp(e,t)}))},t.prototype.setPropUnsafe=function(t,n){e.prototype.setPropUnsafe.call(this,t,n),this.children.forEach((function(e){return e.setPropUnsafe(t,n)}))},t.prototype.getBufferLength=function(e){return this.children.map((function(t){return t.getBufferLength(e)})).reduce((function(e,t){return e+t}),0)},t.prototype.getBuffer=function(){var e=this.children.map((function(e){return e.getBuffer()})).filter((function(e){return void 0!==e})),t=e.reduce((function(e,t){return e+t.length}),0);if(t>0){var n=new Float32Array(t);n.set(e[0],0);for(var r=1,a=0,i=e.length;r<i;r++)a+=e[r-1].length,n.set(e[r],a);return n}return Qe.Z.EMPTY_BUFFER},t.prototype.getIndexedBuffer=function(){var e=this.children.map((function(e){return e.getIndexedBuffer()})).filter((function(e){return void 0!==e}));return[].concat.apply([],e)},t.prototype.stream=function(e){this.children.forEach((function(t){return t.stream(e)}))},t}(Je.Z);var rt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),at=function(){return(at=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const it=function(e){function t(t){void 0===t&&(t={});var n=this;return t.type=t.type||"Shape",n=e.call(this,t)||this,t.shape instanceof Je.Z?n.shape=t.shape:console.warn("[Urpflanze:Shape] requires the 'shape' property to be instance of SceneChild,\nYou passed:",t.shape),n.bStatic=n.isStatic(),n.bStaticIndexed=n.isStaticIndexed(),n}return rt(t,e),t.prototype.isStatic=function(){return e.prototype.isStatic.call(this)&&(!this.shape||this.shape.isStatic())},t.prototype.isStaticIndexed=function(){return e.prototype.isStaticIndexed.call(this)&&(!this.shape||this.shape.isStaticIndexed())},t.prototype.find=function(e){return this.id===e||this.name===e?this:this.shape?this.shape.find(e):null},t.prototype.getBufferLength=function(e){return this.bStatic&&this.buffer&&this.buffer.length>0?this.buffer.length:(this.shape?this.shape.getBufferLength(e):0)*this.getRepetitionCount()},t.prototype.generateBuffer=function(e,n){return this.shape?(this.shape.generate(e,!1,n),this.shape.getBuffer()||t.EMPTY_BUFFER):t.EMPTY_BUFFER},t.prototype.getShapeBounding=function(){return this.shape?this.shape.getBounding():this.bounding},t.prototype.addIndex=function(e,n){if(this.shape)for(var r=this.shape.getIndexedBuffer()||[],a={shape:this,frameLength:e,repetition:{type:n.type,angle:n.angle,index:n.index,count:n.count,offset:n.offset,row:{index:n.row.index,count:n.row.count,offset:n.row.offset},col:{index:n.col.index,count:n.col.count,offset:n.col.offset}}},i=0,o=r.length;i<o;i++){var s=at({},r[i]);s.parent=s.parent?t.setIndexedParent(s.parent,a):a,this.indexedBuffer.push(s)}},t.setIndexedParent=function(e,n){return{shape:e.shape,repetition:{type:e.repetition.type,angle:e.repetition.angle,index:e.repetition.index,count:e.repetition.count,offset:e.repetition.offset,row:{index:e.repetition.row.index,count:e.repetition.row.count,offset:e.repetition.row.offset},col:{index:e.repetition.col.index,count:e.repetition.col.count,offset:e.repetition.col.offset}},frameLength:e.frameLength,parent:e.parent?t.setIndexedParent(e.parent,n):n}},t.prototype.setShape=function(e){void 0===e?(this.shape=void 0,this.clearBuffer(!0,!0)):(this.scene&&ot.propagateToChilden(e,this.scene),this.shape=e,this.shape.clearBuffer(!0,!0))},t}(Qe.Z);const ot=function(){function e(e){void 0===e&&(e={}),this.width=400,this.height=400,this.background="hsla(0, 0%, 0%, 1)",this.color="hsla(0, 0%, 100%, 1)",this.currentTime=0,void 0!==e.width&&(this.width=e.width),void 0!==e.height&&(this.height=e.height),void 0!==e.background&&(this.background=e.background),void 0!==e.color&&(this.color=e.color),this.children=[],this.center=[this.width/2,this.height/2]}return e.prototype.resize=function(e,t){void 0===t&&(t=e),this.width=e,this.height=t,this.center=[this.width/2,this.height/2],this.children.forEach((function(e){return e.clearBuffer(!0,!1)}))},e.prototype.update=function(e){this.currentTime=e;for(var t=0,n=this.children.length;t<n;t++)this.children[t].generate(this.currentTime,!0)},e.prototype.stream=function(e){this.children.forEach((function(t){return t.stream(e)}))},e.prototype.getChildren=function(){return this.children},e.prototype.add=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r="number"==typeof t[t.length-1]?t[t.length-1]:void 0,a=t.length-(void 0===r?0:1),i=0;i<a;i++){var o=t[i];o.order=void 0!==r?r+i:void 0!==o.order?o.order:this.children.length>0?Math.max.apply(this,this.children.map((function(e){return e.order||0})))+1:0,e.propagateToChilden(o,this),this.children.push(o),o.clearBuffer(!0,!1)}this.sortChildren()},e.prototype.sortChildren=function(){this.children.sort((function(e,t){return e.order-t.order})),this.children=this.children.map((function(e,t){return e.order=t,e}))},e.prototype.find=function(e){for(var t=this.getChildren(),n=0,r=t.length;n<r;n++){var a=t[n].find(e);if(null!==a)return a}return null},e.prototype.get=function(e){return e>=0&&e<this.children.length?this.children[e]:null},e.prototype.remove=function(e){e>=0&&e<this.children.length&&this.children.splice(e,1)},e.prototype.removeChildren=function(){this.children=[]},e.prototype.removeFromId=function(e){for(var t=0,n=this.children.length;t<n;t++)if(this.children[t].id===e||this.children[t].name===e)return void this.children.splice(t,1)},e.prototype.isFirstLevelChild=function(e){for(var t=0,n=this.children.length;t<n;t++)if(this.children[t].id==e.id)return!0;var r=this.getParentsOfSceneChild(e);return 1==r.length&&r[0]instanceof nt},e.prototype.getParentsOfSceneChild=function(t){var n=e.getParentsOfSceneChild(this,t);return n?(n.splice(0,1),n):[]},e.getParentsOfSceneChild=function(t,n,r){var a;if(void 0===r&&(r=[]),t instanceof Je.Z){if(t.id==n.id)return r;if(t instanceof it&&t.shape){var i=r.slice();if(i.push(t),a=e.getParentsOfSceneChild(t.shape,n,i))return a}}if(t instanceof e||t instanceof nt){var o=t.getChildren();r.push(t);for(var s=0,c=o.length;s<c;s++){var l=o[s];if(a=e.getParentsOfSceneChild(l,n,r))return a}r.pop()}return null},e.walk=function(t,n){if(n instanceof Je.Z){if(!1===t(n))return!1;if(n instanceof it&&n.shape&&!1===e.walk(t,n.shape))return!1}if(n instanceof e||n instanceof nt)for(var r=n.getChildren(),a=0,i=r.length;a<i;a++){var o=r[a];if(!1===e.walk(t,o))return!1}},e.propagateToChilden=function(t,n){t.scene=n,t instanceof nt?t.getChildren().forEach((function(t){e.propagateToChilden(t,n)})):t instanceof it&&t.shape&&(t.shape.scene=n,e.propagateToChilden(t.shape,n))},e}();var st=n(76403),ct=n(99814),lt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const dt=function(e){function t(n){var r;void 0===n&&(n={});var a=this;return n.type=n.type||"ShapeBuffer",n.adaptMode=null!==(r=n.adaptMode)&&void 0!==r?r:Ke._.Scale,a=e.call(this,n)||this,void 0===n.shape?(console.warn("[Urpflanze:ShapeBuffer] ShapeBuffer require a buffer passed from `shape` property"),a.shape=t.EMPTY_BUFFER):a.shape=Float32Array.from(n.shape),a.bStatic=a.isStatic(),a.bStaticIndexed=a.isStaticIndexed(),a}return lt(t,e),t.prototype.clearBuffer=function(t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),e.prototype.clearBuffer.call(this,t,n),this.shapeBuffer=void 0},t.prototype.bindBuffer=function(e){for(var t=this.getRepetitionSideLength(e),n=this.adaptMode!==Ke._.None?st.Z.adaptBuffer(this.shape,this.adaptMode):Float32Array.from(this.shape),r=[void 0,void 0,void 0,void 0],a=0,i=n.length;a<i;a+=2)n[a]*=t[0],n[a+1]*=t[1],et.Z.add(r,n[a],n[a+1]);et.Z.bind(this.currentGenerationPrimitiveBounding,r),this.shapeBuffer=n},t.prototype.getBufferLength=function(){return this.buffer&&this.buffer.length>0?this.buffer.length:this.shape.length*this.getRepetitionCount()},t.prototype.generateBuffer=function(e,t){return void 0!==this.shapeBuffer&&"function"!=typeof this.props.sideLength||this.bindBuffer(t),this.shapeBuffer},t.prototype.setShape=function(e){this.shape=e,this.clearBuffer(!0)},t.prototype.subdivide=function(e){void 0===e&&(e=1);var n=this.shape;if(n&&n.length>0){for(var r=0;r<e;r++)n=t.subdivide(n,this.bClosed);this.setShape(n)}},t.subdivide=function(e,t){void 0===t&&(t=!0);for(var n=e.length,r=new Float32Array(2*n-(t?0:2)),a=0;a<n;a+=2)if(0===a)r[0]=e[0],r[1]=e[1];else{var i=e[a-2],o=e[a-1],s=e[a],c=e[a+1],l=(s+i)/2,d=(c+o)/2;r[2*(a-1)]=l,r[2*(a-1)+1]=d,r[2*a]=s,r[2*a+1]=c}return t&&(r[2*(n-1)]=(e[0]+e[n-2])/2,r[2*(n-1)+1]=(e[1]+e[n-1])/2),r},t}(st.Z);var ut=n(5260),pt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ht=function(){return(ht=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};!function(e){function t(t){void 0===t&&(t={});var n=this;return t.type=t.type||"ShapeRecursive",(n=e.call(this,t)||this).props.recursions=t.recursions||1,n.props.recursionScale=t.recursionScale||2,n.props.recursionVertex=t.recursionVertex||0,n.bStatic=n.isStatic(),n.bStaticIndexed=n.isStaticIndexed(),n.currentGenerationRecursiveBounding=et.Z.empty(),n}pt(t,e),t.prototype.isStatic=function(){return"function"!=typeof this.props.recursions&&"function"!=typeof this.props.recursionScale&&"function"!=typeof this.props.recursionVertex&&e.prototype.isStatic.call(this)},t.prototype.isStaticIndexed=function(){return"function"!=typeof this.props.recursions&&e.prototype.isStaticIndexed.call(this)},t.prototype.generateBuffer=function(e,t){return this.isStatic()&&void 0!==this.shapeRecursiveBuffer||this.bindBuffer(e,t),this.shapeRecursiveBuffer},t.prototype.bindBuffer=function(e,n){if(void 0!==this.shape){var r=Math.floor(this.getProp("recursions",n,1)),a=Math.floor(this.getProp("recursionVertex",n,0)),i=this.getProp("recursionScale",n,2),o={index:1,offset:1,count:1,level:{index:1,offset:r>1?0:1,count:1}};if(r<=1){var s=this.generateShapeBuffer(n,e,o);return this.currentGenerationRecursiveBounding=this.shape.getBounding(),void(this.shapeRecursiveBuffer=s)}for(var c=this.generateShapeBuffer(n,e,o),l=[o],d=0,u=1,p=[void 0,void 0,void 0,void 0],h=c.length,f=h/2,m=a<=0?f:Math.min(a,f),g=0===a?1:f/Math.min(a,f),v=new Float32Array(t.summmation(r,m)*h),y=0;y<h;y+=2)v[y]=c[y],v[y+1]=c[y+1],et.Z.add(p,v[y],v[y+1]);for(var b=1;b<r;b++)for(var w=r>1?b/(r-1):1,_=t.summmation(b,m)*h,x=b-1,E=0===x?0:t.summmation(x,m)*h,Z=0,k=Math.pow(m,b);Z<k;Z++,u++){o={index:Z+1,offset:k>1?Z/(k-1):1,count:k,level:{index:b+1,offset:w,count:r},parent:l[d]},c=this.generateShapeBuffer(n,e,o),l.push(o);for(var S=_+Z*h,C=Math.floor(E+2*Z*g),O=v[C=C%2==0?C:C+1],P=v[C+1],A=(y=0,h);y<A;y+=2){var j=c[y]/Math.pow(i,b),M=c[y+1]/Math.pow(i,b);v[S+y]=O+j,v[S+y+1]=P+M,et.Z.add(p,v[S+y],v[S+y+1])}u%m==0&&(d+=1)}et.Z.bind(this.currentGenerationRecursiveBounding,p),this.shapeRecursiveBuffer=v}else this.shapeRecursiveBuffer=it.EMPTY_BUFFER},t.prototype.generateShapeBuffer=function(t,n,r){return t.recursion=r,e.prototype.generateBuffer.call(this,n,t)},t.prototype.addIndex=function(e,t){var n;if(this.shape)for(var r={repetition:t,context:ut.Z,time:(null===(n=this.scene)||void 0===n?void 0:n.currentTime)||0,shape:this},a=Math.floor(this.getProp("recursions",r,1)),i=Math.floor(this.getProp("recursionVertex",r,0)),o={shape:this,frameLength:e,repetition:{type:t.type,angle:t.angle,index:t.index,count:t.count,offset:t.offset,row:{index:t.row.index,count:t.row.count,offset:t.row.offset},col:{index:t.col.index,count:t.col.count,offset:t.col.offset}}},s=this.shape.getIndexedBuffer()||[],c=0,l=s.length;c<l;c++){var d=ht({},s[c]),u={index:1,offset:1,count:1,level:{index:1,offset:a>1?0:1,count:a}},p=ht(ht({},o),{recursion:u});if(d.parent=d.parent?it.setIndexedParent(d.parent,p):p,this.indexedBuffer.push(d),a>1)for(var h=this.shape.getBufferLength()/2,f=i<=0?h:Math.min(i,h),m=[u],g=0,v=1,y=1;y<a;y++)for(var b=a>1?y/(a-1):1,w=0,_=Math.pow(f,y);w<_;w++,v++){var x=_>1?w/(_-1):1;d=ht({},s[c]),u={index:w+1,offset:x,count:_,level:{index:y+1,offset:b,count:a},parent:m[g]},p=ht(ht({},o),{recursion:u}),d.parent=d.parent?it.setIndexedParent(d.parent,p):p,this.indexedBuffer.push(d),m.push(u),v%f==0&&(g+=1)}}},t.summmation=function(e,t){if(1===e)return 1;for(var n=1,r=1;r<e;r++)n+=Math.pow(t,r);return n}}(it);var ft=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const mt=function(e){function t(t){void 0===t&&(t={});return t.type="Line",t.shape=[-1,0,1,0],t.adaptMode=Ke._.None,t.bClosed=!1,e.call(this,t)||this}return ft(t,e),t}(dt);var gt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const vt=function(e){function t(t){void 0===t&&(t={});return t.type="Triangle",t.shape=[-1,-1,1,0,-1,1],t.adaptMode=Ke._.None,e.call(this,t)||this}return gt(t,e),t}(dt);var yt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const bt=function(e){function t(t){void 0===t&&(t={});return t.type="Rect",t.shape=[-1,-1,1,-1,1,1,-1,1],t.adaptMode=Ke._.None,e.call(this,t)||this}return yt(t,e),t}(dt);var wt=n(135),_t=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const xt=function(e){function t(t){var n;void 0===t&&(t={});var r=this;return t.type=t.type||"Polygon",t.loopDependencies=(t.loopDependencies||[]).concat(["sideNumber"]),t.adaptMode=null!==(n=t.adaptMode)&&void 0!==n?n:Ke._.None,(r=e.call(this,t,!0)||this).props.sideNumber=t.sideNumber,r.loop={start:0,end:wt.yo,inc:function(e){return wt.yo/r.getProp("sideNumber",e,5)},vertex:function(e){return[Math.cos(e.angle),Math.sin(e.angle)]}},r.bStaticLoop=r.isStaticLoop(),r.bStatic=r.isStatic(),r.bStaticIndexed=r.isStaticIndexed(),r}return _t(t,e),t}(ct.Z);var Et=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Zt=function(e){function t(t){void 0===t&&(t={});var n=this;return t.type="Circle",t.adaptMode=Ke._.None,(n=e.call(this,t,!0)||this).loop={start:0,end:wt.yo,inc:function(e){var t=n.getRepetitionSideLength(e);return 1/Math.pow(t[0]*t[1],.25)*ct.Z.PId2},vertex:function(e){return[Math.cos(e.angle),Math.sin(e.angle)]}},n.bStaticLoop=n.isStaticLoop(),n.bStatic=n.isStatic(),n.bStaticIndexed=n.isStaticIndexed(),n}return Et(t,e),t}(ct.Z);var kt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const St=function(e){function t(n){var r,a,i;void 0===n&&(n={});var o=this;return n.type="Rose",n.loopDependencies=(n.loopDependencies||[]).concat(["n","d"]),n.adaptMode=null!==(r=n.adaptMode)&&void 0!==r?r:Ke._.Scale,(o=e.call(this,n,!0)||this).props.n=null!==(a=n.n)&&void 0!==a?a:1,o.props.d=null!==(i=n.d)&&void 0!==i?i:2,o.loop={start:0,end:function(e){return t.getFinalAngleFromK(o.getProp("n",e),o.getProp("d",e))},inc:function(e){var t=o.getProp("n",e),n=o.getProp("d",e),r=o.getRepetitionSideLength(e),a=Math.pow(r[0]*r[1],.45),i=n<t?t/n:1.5;return wt.yo/(a*i)},vertex:function(e){var t=Math.cos(o.k*e.angle);return[t*Math.cos(e.angle),t*Math.sin(e.angle)]}},o.bStaticLoop=o.isStaticLoop(),o.bStatic=o.isStatic(),o.bStaticIndexed=o.isStaticIndexed(),o}return kt(t,e),t.prototype.generateLoopBuffer=function(t){return this.k=this.getProp("n",t)/this.getProp("d",t),e.prototype.generateLoopBuffer.call(this,t)},t.getFinalAngleFromK=function(e,t){if(e==t)return wt.yo;var n=e/t,r=e*t;return Number.isInteger(n)||n%.5!=0?Math.PI*t*(r%2==0?2:1):4*Math.PI},t}(ct.Z);var Ct=n(68530),Ot=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Pt=function(e){function t(t){void 0===t&&(t={});var n=this;return t.type="Lissajous",t.loopDependencies=(t.loopDependencies||[]).concat(["wx","wy","wz"]),t.adaptMode=Ke._.None,(n=e.call(this,t,!0)||this).props.wx=t.wx||1,n.props.wy=t.wy||2,n.props.wz=t.wz||0,n.loop={start:0,end:wt.yo,inc:function(e){var t=n.getProp("wx",e),r=n.getProp("wy",e),a=t==r?ct.Z.PId2:.5-.01*Math.min(49,t+r),i=n.getRepetitionSideLength(e);return 1/Math.pow(i[0]*i[1],.25)*a},vertex:function(e){return n.wx===n.wy?[Math.cos(e.angle+n.wz),Math.sin(e.angle)]:[Math.cos(n.wx*e.angle+n.wz),Math.sin(n.wy*e.angle)]}},n.bStaticLoop=n.isStaticLoop(),n.bStatic=n.isStatic(),n.bStaticIndexed=n.isStaticIndexed(),n}return Ot(t,e),t.prototype.generateLoopBuffer=function(t){return this.wx=this.getProp("wx",t,1),this.wy=this.getProp("wy",t,2),this.wz=this.getProp("wz",t,2),e.prototype.generateLoopBuffer.call(this,t)},t}(ct.Z);var At=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const jt=function(e){function t(t){var n,r,a,i,o,s,c;void 0===t&&(t={});var l=this;return t.type="SuperShape",t.loopDependencies=(t.loopDependencies||[]).concat(["a","b","m","n1","n2","n3"]),t.adaptMode=null!==(n=t.adaptMode)&&void 0!==n?n:Ke._.Scale,(l=e.call(this,t,!0)||this).props.a=null!==(r=t.a)&&void 0!==r?r:1,l.props.b=null!==(a=t.b)&&void 0!==a?a:1,l.props.m=null!==(i=t.m)&&void 0!==i?i:6,l.props.n1=null!==(o=t.n1)&&void 0!==o?o:1,l.props.n2=null!==(s=t.n2)&&void 0!==s?s:1,l.props.n3=null!==(c=t.n3)&&void 0!==c?c:1,l.loop={start:0,end:wt.yo,inc:function(e){var t=l.getRepetitionSideLength(e);return Math.PI/Math.pow(t[0]*t[1],.5)},vertex:function(e){var t=e.angle,n=l.m*t/4,r=Math.pow(Math.abs(Math.cos(n)/l.a),l.n2),a=Math.pow(Math.abs(Math.sin(n)/l.b),l.n3),i=Math.pow(r+a,1/l.n1),o=0===i?1:1/i;return[o*Math.cos(t),o*Math.sin(t)]}},l.bStaticLoop=l.isStaticLoop(),l.bStatic=l.isStatic(),l.bStaticIndexed=l.isStaticIndexed(),l}return At(t,e),t.prototype.generateLoopBuffer=function(t){return this.a=this.getProp("a",t),this.b=this.getProp("b",t),this.m=this.getProp("m",t),this.n1=this.getProp("n1",t),this.n2=this.getProp("n2",t),this.n3=this.getProp("n3",t),e.prototype.generateLoopBuffer.call(this,t)},t}(ct.Z);var Mt=n(66222),Tt=n(90667);const It=function(){function e(){this.callbacks={}}return e.prototype.attach=function(e,t){e in this.callbacks||(this.callbacks[e]=[]),this.callbacks[e].push(t)},e.prototype.detach=function(e,t){if(e in this.callbacks){var n=this.callbacks[e].indexOf(t);n>=0&&this.callbacks[e].splice(n,1)}},e.prototype.dispatch=function(e,t){if(e in this.callbacks)for(var n=0,r=this.callbacks[e].length;n<r&&!1!==this.callbacks[e][n](t);n++);},e}();var Lt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$t=function(){return($t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const Rt=function(e){function t(t,n){void 0===t&&(t=6e4),void 0===n&&(n=60);var r=e.call(this)||this;return r.fps_samples_size=30,r.fps_samples=[],r.fps_samples_index=0,r.paused_time=0,r.sequence={duration:t,framerate:n,frames:Math.round(t/1e3*n)},r.tick_time=1e3/r.sequence.framerate,r.fps=r.sequence.framerate,r.b_sequence_started=!1,r.current_frame=0,r.current_time=0,r.last_tick=0,r.start_time=0,r}return Lt(t,e),t.prototype.getSequence=function(){return $t({},this.sequence)},t.prototype.setSequence=function(e,t){this.sequence.duration=e,this.sequence.framerate=t,this.tick_time=1e3/this.sequence.framerate,this.sequence.frames=Math.round(this.sequence.duration/1e3*this.sequence.framerate),this.dispatch("timeline:update_sequence",this.getSequence())},t.prototype.setDuration=function(e){this.setSequence(e,this.sequence.framerate)},t.prototype.getDuration=function(){return this.sequence.duration},t.prototype.getFramerate=function(){return this.sequence.framerate},t.prototype.setFramerate=function(e){this.setSequence(this.sequence.duration,e)},t.prototype.getFramesCount=function(){return this.sequence.frames},t.prototype.bSequenceStarted=function(){return this.b_sequence_started},t.prototype.start=function(){this.b_sequence_started||(this.b_sequence_started=!0,this.start_time=this.paused_time,this.dispatch("timeline:change_status",t.START))},t.prototype.pause=function(){this.b_sequence_started&&(this.paused_time=(0,Mt.zO)(),this.b_sequence_started=!1,this.dispatch("timeline:change_status",t.PAUSE))},t.prototype.stop=function(){this.b_sequence_started&&(this.b_sequence_started=!1,this.current_time=0,this.current_frame=0,this.start_time=0,this.paused_time=0,this.dispatch("timeline:change_status",t.STOP))},t.prototype.tick=function(e){if(this.b_sequence_started){this.start_time||(this.start_time=e,this.last_tick=-this.tick_time);var t=e-this.start_time,n=t-this.last_tick;if(n>=this.tick_time)return this.calculateFPS(1/(n/1e3)),this.last_tick=t,this.current_time=(t-n%this.tick_time)%this.sequence.duration,this.current_frame=this.getFrameAtTime(this.current_time),this.dispatch("timeline:progress",{current_frame:this.current_frame,current_time:this.current_time,fps:this.fps}),!0}return!1},t.prototype.calculateFPS=function(e){var t=this.fps_samples.length;if(t>0){for(var n=0,r=0;r<t;r++)n+=this.fps_samples[r];this.fps=Math.round(n/t)}this.fps_samples[this.fps_samples_index]=Math.round(e),this.fps_samples_index=(this.fps_samples_index+1)%this.fps_samples_size},t.prototype.getCurrentFrame=function(){return this.current_frame},t.prototype.getFrameTime=function(e){return(e=(0,wt.$B)(e,this.sequence.frames))*this.tick_time%this.sequence.duration},t.prototype.getFrameAtTime=function(e){return Math.round(e%this.sequence.duration/this.tick_time)},t.prototype.setFrame=function(e){this.current_frame=(0,wt.$B)(e,this.sequence.frames),this.current_time=this.getFrameTime(this.current_frame),this.dispatch("timeline:progress",{current_frame:this.current_frame,current_time:this.current_time,fps:this.fps})},t.prototype.getTickTime=function(){return this.tick_time},t.prototype.getTime=function(){return this.current_time},t.prototype.setTime=function(e){e=(0,wt.$B)(e,this.sequence.duration),this.current_time=e,this.current_frame=this.getFrameAtTime(e),this.dispatch("timeline:progress",{current_frame:this.current_frame,current_time:this.current_time,fps:this.fps})},t.START="start",t.PAUSE="pause",t.STOP="stop",t}(It);var Dt=n(48307),Bt=n(27927),zt=n(30824),Ft=n(94176),qt=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)r[a]=i[o];return r};const Ut=new(function(){function e(){this.registeredSceneChilds={},this.registeredSceneChilds={},this.registeredSceneChilds={Line:mt,Triangle:vt,Rect:bt,Polygon:xt,Circle:Zt,Rose:St,Spiral:Ct.Z,Lissajous:Pt,SuperShape:jt,Group:nt,Shape:it,ShapeLoop:ct.Z,ShapeBuffer:dt}}return e.prototype.getRegistered=function(){return Object.keys(this.registeredSceneChilds)},e.prototype.register=function(e,t){e in this.registeredSceneChilds?console.warn('SceneUtilities: SceneChild "'+e+'" is already registered'):this.registeredSceneChilds[e]=t},e.prototype.unregister=function(e){e in this.registeredSceneChilds?delete this.registeredSceneChilds[e]:console.warn('SceneUtilities: SceneChild "'+e+'" is not registered')},e.prototype.create=function(e,t,n){var r,a=this;if(n=n||("string"!=typeof e?e.scene:void 0),e instanceof Je.Z)return this.getChildren(e).forEach((function(e){return a.create(e,void 0,n)})),e;if(e in this.registeredSceneChilds){t||(t={}),t.id=t.id||(0,Dt.Z)(),!t.name&&n&&(t.name=e+"_"+(this.getCountSceneChildOfType(n,e)+1)),t.data||(t.data={}),"props"in t.data||(t.data.props={}),"style"in t.data||(t.data.style={}),"visible"in t.data||(t.data.visible=!0);var i=new this.registeredSceneChilds[e](t);return i&&n&&this.isAPrimitive(i)&&this.set(i,"sideLength",{type:"transformable-prop",value:null===(r=zt.Z.sideLength)||void 0===r?void 0:r.default},n),this.getChildren(i).forEach((function(e){return a.create(e)})),i}return console.warn('SceneUtilities: Creation failed. SceneChild "'+e+'" is not registered'),null},e.prototype.getCountSceneChildOfType=function(e,t){var n=0;return ot.walk((function(e){n+=e.type==t?1:0}),e),n},e.prototype.copy=function(e,t,n){var r=this;void 0===n&&(n=!1);var a=e.getProps();e instanceof Qe.Z&&(a.bUseParent=e.bUseParent,a.bUseRecursion=e.bUseRecursion),e instanceof dt&&(a.shape=e.shape),e instanceof st.Z&&(a.bClosed=e.bClosed,a.adaptMode=e.adaptMode,a.vertexCallback=e.vertexCallback),e instanceof ct.Z&&(a.loopDependencies=e.loopDependencies),e instanceof ct.Z&&(a.loopDependencies=e.loopDependencies),n&&(a.id=e.id,a.name=e.name,a.order=e.order,a.data=JSON.parse(JSON.stringify(e.data||{})));var i=this.create(e.type,a,t);if(i){if(e instanceof nt)e.getChildren().forEach((function(e){var n=r.copy(e,t);n&&i.add(n)}));else if(e instanceof it&&i instanceof it&&e.shape){var o=this.copy(e.shape,t);o&&(i.shape=o)}else e instanceof dt&&i instanceof dt&&e.shape&&i.setShape(new Float32Array(e.shape));return i}return console.warn("SceneUtilities: Copy failed.",e),null},e.prototype.add=function(e,t,n,r){var a=null;if(e instanceof nt||e instanceof ot)(a=this.create(t,n,r))&&e.add(a);else if(e instanceof it)if(null==e.shape)(a=this.create(t,n,r))&&e.setShape(a);else if(e.shape instanceof Qe.Z){if(a=this.create(t,n,r)){var i=this.create("Group",void 0,r),o=e.shape;this.remove(e,o),e.setShape(i),i.add(o),i.add(a)}}else e.shape instanceof nt&&this.add(e.shape,t,void 0,r);return a},e.prototype.remove=function(e,t){if(t)e instanceof nt?e.removeFromId(t.id):e instanceof it&&e.setShape(void 0);else if(e.scene){var n=this.getParent(e);n?this.remove(n,e):e.scene.removeFromId(e.id)}else console.warn("SceneUtilities: Remove failed. SceneChild is not added into scene",e)},e.prototype.getRootParent=function(e){var t=this.getParents(e);return t.length>0?t[0]:null},e.prototype.getParent=function(e){var t=this.getParents(e);return t.length>0?t[t.length-1]:null},e.prototype.getParents=function(e){return e&&e.scene?e.scene.getParentsOfSceneChild(e):[]},e.prototype.getChildren=function(e){return e instanceof nt?e.getChildren():e instanceof it&&e.shape?[e.shape]:[]},e.prototype.getChildrenPrimitives=function(e){for(var t=[],n=this.getChildren(e),r=0,a=n.length;r<a;r++)n[r]instanceof st.Z?t.push(n[r]):t=t.concat.apply(t,this.getChildrenPrimitives(n[r]));return t},e.prototype.getNeighbors=function(e){if(e.scene){var t=this.getParent(e);return null==t?e.scene.getChildren():this.getChildren(t)}return[]},e.prototype.getCountOfSceneChildType=function(e,t){var n=0;return ot.walk((function(e){n+=e.type==t?1:0}),e),n},e.prototype.walk=function(e,t){t(e),this.getChildren(e).forEach((function(e){return t(e)}))},e.prototype.isGroup=function(e){return e instanceof nt},e.prototype.hasShapeChild=function(e){return e instanceof it&&void 0!==e.shape},e.prototype.hasShapeBuffer=function(e){return e instanceof dt},e.prototype.isAPrimitive=function(e){return e instanceof st.Z},e.prototype.hasLoop=function(e){return e instanceof ct.Z},e.prototype.set=function(e,t,n,r){switch(zt.Z[t].dataType){case"props":return this.setProp(e,t,n,r);case"drawer":return this.setDrawerProp(e,t,n,r);case"settings":return this.setSetting(e,t,n,r)}},e.prototype.setProp=function(e,t,n,r){if(void 0===e.data?e.data={props:{}}:void 0===e.data.props&&(e.data.props={}),"loop"!==t){if(Ft.Z.bValueAnimation(n))return e.data.props[t]=n,void e.setProp(t,Bt.Z.composeAnimation(r,t,n));if(Ft.Z.bPropInSceneChildUtilitiesData(t)&&Ft.Z.bValueTransformable(n))return e.data.props[t]=n,void e.setProp(t,Ft.Z.getTransformedValue(r,t,n));e.setProp(t,n),delete e.data.props[t]}else if(e instanceof ct.Z&&Ft.Z.bValueLoop(n)){var a=n;e.data.props.loop=n,e.setProp("loop",Ft.Z.composeLoop(a));var i=a.dynamyc;if(i!==e.loopDependencies.indexOf("propArguments")>=0){var o=qt(e.loopDependencies);i?!(o.indexOf("propArguments")>=0)&&o.push("propArguments"):o.indexOf("propArguments")>=0&&o.splice(o.indexOf("propArguments",1)),e.loopDependencies=o}e.clearBuffer(!0,!0)}},e.prototype.setDrawerProp=function(e,t,n,r){if(this.isAPrimitive(e)){if(void 0===e.data?e.data={style:{}}:void 0===e.data.style&&(e.data.style={}),Ft.Z.bValueAnimation(n))return e.data.style[t]=n,void(e.style[t]=Bt.Z.composeAnimation(r,t,n));e.style[t]=n,delete e.data.style[t]}},e.prototype.setSetting=function(e,t,n,r){if("vertexCallback"!==t)switch(t){case"bUseParent":e instanceof Qe.Z&&(e.bUseParent=n);break;case"bUseRecursion":e instanceof Qe.Z&&(e.bUseRecursion=n);break;case"bClosed":e instanceof st.Z&&e.setClosed(n);break;case"adaptMode":e instanceof st.Z&&e.adapt(n);break;default:void 0!==e[t]&&(e[t]=n)}else e instanceof Qe.Z&&Ft.Z.bValueVertexCallback(n)&&(e.data.vertexCallback=n,e.vertexCallback=Ft.Z.composeVertexCallback(n),e.clearBuffer(!0,!0))},e}());var Nt=n(25995),Vt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gt=function(){return(Gt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const Ht=function(e){function t(t,n,r,a){void 0===t&&(t=void 0),void 0===n&&(n=void 0);var i=e.call(this)||this;if(i.timeline=new Rt(r,a),i.ratio=n||(t&&t.width&&t.height?t.width/t.height:1),t){var o=Math.max(t.width,t.height),s=i.ratio>=1?o:o*i.ratio,c=i.ratio>=1?o/i.ratio:o;t.resize(s,c),i.setScene(t)}return i.draw_id=null,i.redraw_id=null,i.animation_id=null,i.draw=i.draw.bind(i),i.animate=i.animate.bind(i),i.startAnimation=i.startAnimation.bind(i),i}return Vt(t,e),t.prototype.setScene=function(e){this.scene=e},t.prototype.getScene=function(){return this.scene},t.prototype.getTimeline=function(){return this.timeline},t.prototype.resize=function(e,t,n){var r=this;n=n||this.ratio||e/t;var a=Math.max(e,t);e=n>=1?a:a*n,t=n>=1?a/n:a,this.ratio=n,this.scene&&(this.scene.resize(e,t),ot.walk((function(e){if(e.data){if(e.data.props){var t=e.data.props;Object.keys(t).forEach((function(n){Ut.setProp(e,n,t[n],r.scene)}))}if(e.data.style){var n=e.data.style;Object.keys(n).forEach((function(t){Ut.setDrawerProp(e,t,n[t],r.scene)}))}}}),this.scene))},t.prototype.setRatio=function(e){this.scene&&this.resize(this.scene.width,this.scene.height,e)},t.prototype.getRatio=function(){return this.ratio},t.prototype.setOption=function(e,t){if("object"==typeof e)for(var n=Object.keys(e),r=0,a=n.length;r<a;r++)this.drawerOptions[n[r]]=e[n[r]];else this.drawerOptions[e]=t},t.prototype.getOption=function(e,t){var n;return null!==(n=this.drawerOptions[e])&&void 0!==n?n:t},t.prototype.getOptions=function(){return this.drawerOptions},t.prototype.animate=function(e){this.timeline.bSequenceStarted()&&(this.animation_id=requestAnimationFrame(this.animate),this.timeline.tick(e)&&this.draw())},t.prototype.startAnimation=function(){this.stopAnimation(),this.timeline.start(),this.animation_id=requestAnimationFrame(this.animate)},t.prototype.stopAnimation=function(){this.timeline.stop(),this.animation_id&&cancelAnimationFrame(this.animation_id)},t.prototype.pauseAnimation=function(){this.timeline.pause(),this.animation_id&&cancelAnimationFrame(this.animation_id)},t.prototype.playAnimation=function(){this.timeline.start(),requestAnimationFrame(this.animate)},t.prototype.redraw=function(){this.timeline.bSequenceStarted()?void 0!==typeof this.drawerOptions.ghosts&&0!==this.drawerOptions.ghosts||(this.stopAnimation(),this.redraw_id&&cancelAnimationFrame(this.redraw_id),this.redraw_id=requestAnimationFrame(this.startAnimation)):(this.draw_id&&cancelAnimationFrame(this.draw_id),void 0!==typeof this.drawerOptions.ghosts&&0!==this.drawerOptions.ghosts||this.timeline.stop(),this.draw_id=requestAnimationFrame(this.draw))},t.getStreamDrawerProp=function(e,t,n,r){var a=e.style[t];return"function"==typeof a&&(a=a(n)),null!=a?a:r},t.eachGhosts=function(e,t,n){if(e.ghosts)for(var r=Gt({},e),a=t.getTime(),i=t.getDuration(),o={offset:0,index:0,count:e.ghosts},s=1;s<=e.ghosts;s++){o.index=s,o.offset=o.index/o.count;var c=a-(e.ghostSkipFunction?e.ghostSkipFunction(o,a):s*e.ghostSkipTime);r.ghostIndex=s,r.time=(0,wt.$B)(c,i),n(r)}},t.ghostifyColor=function(e,t){if("string"==typeof e||"number"==typeof e){var n=(0,Nt.lu)(e);if(n){var r=n.alpha*t;return"rgb"===n.type?"rgba("+n.a+","+n.b+","+n.c+","+r+")":"hsla("+n.a+","+n.b+"%,"+n.c+"%,"+r+")"}}return e},t}(It);const Yt=function(){function e(){this.frames={}}return e.prototype.exist=function(e){return void 0!==this.frames[e]},e.prototype.get=function(e){return this.exist(e)?this.frames[e]:null},e.prototype.count=function(){return Object.keys(this.frames).length},e.prototype.push=function(e,t){this.frames[e]=t.getImageData(0,0,t.canvas.width,t.canvas.height)},e.prototype.flush=function(){this.frames={}},e.prototype.getRenderedFrames=function(){return Object.keys(this.frames).map((function(e){return+e}))},e}();var Wt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xt=function(){return(Xt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const Kt=function(e){function t(t,n,r,a,i,o,s){var c,l,d,u,p;void 0===a&&(a=void 0),void 0===s&&(s=!1);var h=e.call(this,t,a,i,o)||this;if(h.bBuffering=!1,h.drawerOptions={},h.drawerOptions.clear=null===(c=null==r?void 0:r.clear)||void 0===c||c,h.drawerOptions.time=null!==(l=null==r?void 0:r.time)&&void 0!==l?l:0,h.drawerOptions.simmetricLines=null!==(d=null==r?void 0:r.simmetricLines)&&void 0!==d?d:0,h.drawerOptions.noBackground=null!==(u=null==r?void 0:r.noBackground)&&void 0!==u&&u,h.drawerOptions.ghosts=(null==r?void 0:r.ghosts)||0,h.drawerOptions.ghostAlpha=!1!==(null==r?void 0:r.ghostAlpha),h.drawerOptions.ghostSkipTime=null!==(p=null==r?void 0:r.ghostSkipTime)&&void 0!==p?p:30,h.drawerOptions.ghostSkipFunction=null==r?void 0:r.ghostSkipFunction,h.drawerOptions.backgroundImage=null==r?void 0:r.backgroundImage,h.drawerOptions.backgroundImageFit=(null==r?void 0:r.backgroundImageFit)||"cover",h.bBuffering=s,h.buffer=new Yt,"undefined"!=typeof HTMLCanvasElement&&n instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&n instanceof OffscreenCanvas){var f=n;h.setCanvas(f)}else if(n){f=document.createElement("canvas");n.appendChild(f),h.setCanvas(f)}return h}return Wt(t,e),t.prototype.setBuffering=function(e){this.bBuffering=e,this.flushBuffer()},t.prototype.getBBuffering=function(){return this.bBuffering},t.prototype.setScene=function(t){e.prototype.setScene.call(this,t),this.canvas&&this.setCanvas(this.canvas)},t.prototype.setCanvas=function(e){var t;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement)t=e;else{for(t=this.canvas||document.createElement("canvas");e.lastChild;)e.removeChild(e.lastChild);e.appendChild(t)}else t=e;this.canvas=t,this.context=this.canvas.getContext("2d",{alpha:!0,desynchronized:!0!==this.bBuffering}),this.scene&&this.resize(this.scene.width,this.scene.height)},t.prototype.getCanvas=function(){return this.canvas},t.prototype.getContext=function(){return this.context},t.prototype.resize=function(t,n,r){e.prototype.resize.call(this,t,n,r),this.canvas&&this.scene&&(this.canvas.width=this.scene.width,this.canvas.height=this.scene.height,"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement&&(this.canvas.style.width=this.scene.width+"px",this.canvas.style.height=this.scene.height+"px")),this.flushBuffer(),this.dispatch("drawer-canvas:resize"),this.redraw()},t.prototype.flushBuffer=function(){this.bBuffering&&(this.buffer.flush(),this.dispatch("drawer-canvas:buffer_flush"))},t.prototype.getRenderedFrames=function(){return this.bBuffering?this.buffer.getRenderedFrames():[]},t.prototype.setOption=function(t,n){e.prototype.setOption.call(this,t,n),this.flushBuffer()},t.prototype.draw=function(){var e,t=this;if(void 0===this.scene)return-1;var n=0,r=this.timeline,a=r.getTime(),i=Xt(Xt({},this.drawerOptions),{ghostIndex:void 0,clear:this.drawerOptions.clear||r.getCurrentFrame()<=1,time:a}),o=r.getFrameAtTime(a);return this.dispatch("drawer-canvas:before_draw",{currentFrame:o,currentTime:a}),this.bBuffering&&this.buffer.exist(o)?null===(e=this.context)||void 0===e||e.putImageData(this.buffer.get(o),0,0):(i.ghosts&&(Ht.eachGhosts(i,r,(function(e){e.clear=i.clear&&1===e.ghostIndex,n+=t.applyDraw(e)})),i.clear=!1),n+=this.applyDraw(i),this.bBuffering&&this.context&&(this.buffer.push(o,this.context),this.buffer.count()>=this.timeline.getFramesCount()&&this.dispatch("drawer-canvas:buffer_loaded"))),n},t.prototype.redraw=function(){this.timeline.bSequenceStarted()?this.drawerOptions.clear||void 0!==typeof this.drawerOptions.ghosts&&0!==this.drawerOptions.ghosts||(this.stopAnimation(),this.redraw_id&&cancelAnimationFrame(this.redraw_id),this.redraw_id=requestAnimationFrame(this.startAnimation)):(this.draw_id&&cancelAnimationFrame(this.draw_id),!this.drawerOptions.clear&&(void 0===typeof this.drawerOptions.ghosts||0===this.drawerOptions.ghosts)&&this.timeline.stop(),this.draw_id=requestAnimationFrame(this.draw))},t.prototype.applyDraw=function(e){var n,r,a=(0,Mt.zO)(),i=this.scene,o=this.context;o.globalCompositeOperation="source-over";var s=null!==(n=e.time)&&void 0!==n?n:0,c=null!==(r=e.simmetricLines)&&void 0!==r?r:0,l=e.clear,d=e.noBackground,u=e.backgroundImage,p=void 0!==e.ghosts&&e.ghosts>0&&void 0!==e.ghostIndex&&e.ghostIndex>0,h=p?1-e.ghostIndex/(e.ghosts+.5):0,f=!0===e.ghostAlpha,m=i.width,g=i.height,v=m/g;if(l){if(d)o.clearRect(0,0,m,g);else if(o.fillStyle=i.background,o.fillRect(0,0,m,g),u){var y=u instanceof SVGImageElement?u.width.baseVal.value:u.width,b=u instanceof SVGImageElement?u.height.baseVal.value:u.height,w=y/b,_=0,x=0,E=m,Z=g;w!==v&&("contain"===e.backgroundImageFit?(E=v>w?y*g/b:m,Z=v>w?g:b*m/y):(E=v<w?y*g/b:m,Z=v<w?g:b*m/y),_=(m-E)/2,x=(g-Z)/2),o.drawImage(u,_,x,E,Z)}c>0&&t.drawSimmetricLines(o,c,m,g,i.color)}var k=!1,S=!1;return i.currentTime=s,i.getChildren().forEach((function(e){e.data&&(!1===e.data.visible||p&&!0===e.data.disableGhost)||(e.generate(s,!0),o.save(),e.stream((function(e){var t=e.currentIndexing,n=t.shape,r={canvasContext:o,shape:n,repetition:{type:t.repetition.type,angle:t.repetition.angle,index:t.repetition.index,count:t.repetition.count,offset:t.repetition.offset,row:{index:t.repetition.row.index,count:t.repetition.row.count,offset:t.repetition.row.offset},col:{index:t.repetition.col.index,count:t.repetition.col.count,offset:t.repetition.col.offset}},parent:t.parent,time:i.currentTime,context:ut.Z},a=Ht.getStreamDrawerProp(n,"composite",r,"source-over");o.globalCompositeOperation=a,o.beginPath(),o.moveTo(e.buffer[e.frameBufferIndex],e.buffer[e.frameBufferIndex+1]);for(var s=2;s<e.frameLength;s+=2)o.lineTo(e.buffer[e.frameBufferIndex+s],e.buffer[e.frameBufferIndex+s+1]);t.shape.isClosed()&&o.closePath();var c=Ht.getStreamDrawerProp(n,"shadowColor",r),l=Ht.getStreamDrawerProp(n,"shadowBlur",r),d=Ht.getStreamDrawerProp(n,"shadowOffsetX",r),u=Ht.getStreamDrawerProp(n,"shadowOffsetY",r);o.shadowColor=c,o.shadowBlur=l,d&&(o.shadowOffsetX=d),u&&(o.shadowOffsetY=u);var m=Ht.getStreamDrawerProp(n,"fill",r);if(void 0!==m){if(p&&f)(y=Ht.ghostifyColor(m,h))?m=y:k||(console.warn("[Urpflanze:DrawerCanvas] Unable ghost fill color '"+m+"',\n\t\t\t\t\t\t\t\t\tplease enter a rgba or hsla color"),k=!0);o.fillStyle=m,o.fill()}var g=Ht.getStreamDrawerProp(n,"stroke",r,void 0===m?i.color:void 0),v=Ht.getStreamDrawerProp(n,"lineWidth",r,1);if(g){var y;if(p&&f)(y=Ht.ghostifyColor(g,h))?g=y:S||(console.warn("[Urpflanze:DrawerCanvas] Unable ghost stroke color '"+g+"',\n\t\t\t\t\t\t\t\t\tplease enter a rgba or hsla color"),S=!0),v*=h;var b=Ht.getStreamDrawerProp(n,"lineJoin",r),w=Ht.getStreamDrawerProp(n,"lineCap",r),_=Ht.getStreamDrawerProp(n,"lineDash",r),x=Ht.getStreamDrawerProp(n,"lineDashOffset",r),E=Ht.getStreamDrawerProp(n,"miterLimit",r);o.setLineDash.call(o,_||[]),o.lineJoin=b,o.lineCap=w,o.lineDashOffset=x,o.miterLimit=E,o.lineWidth=v,o.strokeStyle=g,o.stroke()}})),o.restore())})),(0,Mt.zO)()-a},t.drawSimmetricLines=function(e,t,n,r,a){for(var i=Math.PI/t,o=Math.max(n,r),s=[o/2,o/2],c=0;c<t;c++){var l=[-o,-o],d=[2*o,2*o],u=c*i+Math.PI/4;Tt.Z.rotateZ(l,s,u),Tt.Z.rotateZ(d,s,u),e.beginPath(),e.strokeStyle=a,e.lineWidth=1,e.moveTo(l[0],l[1]),e.lineTo(d[0],d[1]),e.stroke()}},t}(Ht);n(39022),n(55389);var Jt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qt=function(){return(Qt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const en=function(e){function t(t,n,r,a,i,o){var s,c,l;void 0===r&&(r={}),void 0===a&&(a=void 0);var d=e.call(this,t,a,i,o)||this;return d.container=n,d.drawerOptions={time:null!==(s=r.time)&&void 0!==s?s:0,decimals:r.decimals||2,noBackground:null!==(c=r.noBackground)&&void 0!==c&&c,ghosts:r.ghosts||0,ghostAlpha:!1!==r.ghostAlpha,ghostSkipTime:null!==(l=r.ghostSkipTime)&&void 0!==l?l:30,ghostSkipFunction:r.ghostSkipFunction},d}return Jt(t,e),t.prototype.draw=function(){var e=this;if(void 0===this.scene)return-1;var n=0,r=this.timeline,a=r.getTime(),i=Qt(Qt({},this.drawerOptions),{ghostIndex:void 0,time:a}),o=r.getFrameAtTime(a);this.dispatch("drawer-svg:before_draw",{currentFrame:o,currentTime:a});var s=[];return i.ghosts&&Ht.eachGhosts(i,r,(function(r){n+=t.draw(e.scene,s,r)})),n+=t.draw(this.scene,s,i),this.appendSVGFromPaths(s,i),n},t.prototype.appendSVGFromPaths=function(e,n){if(this.scene&&this.container){for(;this.container.lastChild;)this.container.removeChild(this.container.lastChild);var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("width",this.scene.width+""),r.setAttribute("height",this.scene.height+""),r.setAttribute("viewBox","0 0 "+this.scene.width+" "+this.scene.height);var a=document.createComment("Created with Urpflanze.js");if(r.appendChild(a),!n.noBackground){var i=document.createElementNS("http://www.w3.org/2000/svg","rect");i.setAttribute("width",this.scene.width+""),i.setAttribute("height",this.scene.height+""),t.setColor(i,"fill",this.scene.background),r.appendChild(i)}e.forEach((function(e){return r.appendChild(e)})),this.container.appendChild(r)}},t.setColor=function(e,t,n){if("none"===n)e.setAttribute(t,"none");else{var r=(0,Nt.k0)(n);if(r&&(e.setAttribute(t,"rgb("+r.r+", "+r.g+", "+r.b+")"),1!==r.alpha)){var a=e.getAttribute("style")||"";e.setAttribute("style",a+" "+t+"-opacity: "+r.alpha+";")}}},t.draw=function(e,n,r){var a,i=(0,Mt.zO)(),o=null!==(a=r.time)&&void 0!==a?a:0,s=r.decimals,c=void 0!==r.ghosts&&r.ghosts>0&&void 0!==r.ghostIndex&&r.ghostIndex>0,l=c?1-r.ghostIndex/(r.ghosts+.5):0,d=!0===r.ghostAlpha,u=!1,p=!1;return e.currentTime=o,e.getChildren().forEach((function(r){r.data&&!1===r.data.visible&&c&&!0===r.data.disableGhost||(r.generate(o,!0),r.stream((function(r){for(var a=[],i=r.currentIndexing,o=i.shape,h={shape:o,repetition:i.repetition,parent:i.parent,time:e.currentTime,context:ut.Z},f=0;f<r.frameLength;f+=2)a.push(r.buffer[r.frameBufferIndex+f].toFixed(s)+" "+r.buffer[r.frameBufferIndex+f+1].toFixed(s));var m=Ht.getStreamDrawerProp(o,"fill",h);m&&(c&&d&&((g=Ht.ghostifyColor(m,l))?m=g:u||(console.warn("[Urpflanze:DrawerCanvas] Unable ghost fill color '"+m+"',\n\t\t\t\t            please enter a rgba or hsla color"),u=!0)));var g,v=Ht.getStreamDrawerProp(o,"stroke",h,void 0===m?e.color:void 0),y=Ht.getStreamDrawerProp(o,"lineWidth",h,1);v&&(c&&d&&((g=Ht.ghostifyColor(v,l))?v=g:p||(console.warn("[Urpflanze:DrawerCanvas] Unable ghost stroke color '"+v+"',\n\t\t\t\t            please enter a rgba or hsla color"),p=!0),y*=l));var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d","M"+a.join(" L")+" "+(o.isClosed()?"Z":"")),t.setColor(b,"fill",m||"none"),v&&(t.setColor(b,"stroke",v),b.setAttribute("stroke-width",(y||1)+"")),n.push(b)})))})),(0,Mt.zO)()-i},t}(Ht);var tn=n(45547);const nn=function(){function e(e){void 0===e&&(e={}),this.type=e.type||"image/jpeg",this.encoder="image/png"===this.type?"png":"jpeg",this.extension="jpeg"===this.encoder?".jpg":".png",this.quality=e&&e.quality?e.quality:1,this.started=!1,this.promises=[],this.chunks=[]}return e.prototype.setSettings=function(e){this.type=e.type||"image/jpeg",this.encoder="image/png"===this.type?"png":"jpeg",this.extension="jpeg"===this.encoder?".jpg":".png",this.quality=e&&e.quality?e.quality:1},e.prototype.start=function(e){this.chunks=new Array(e),this.promises=new Array(e),this.started=!0},e.prototype.stop=function(){this.chunks=[],this.promises=[],this.started=!1},e.prototype.capture=function(t,n){if(this.started){var r=this.type,a=this.quality,i=this.chunks,o=new Promise((function(o,s){e.render(t,r,a).then((function(e){i[n]=e,o(n)})).catch((function(e){return s([n,e])}))}));return this.promises[n]=o,o}return Promise.reject()},e.prototype.save=function(){var e=this;return this.started?new Promise((function(t,n){Promise.all(e.promises).then((function(){t(e.chunks)}),(function(e){n(e)}))})):Promise.reject("not started")},e.getRenderTime=function(t,n,r){var a=(0,Mt.zO)();return e.render(t,n,r).then((function(){return(0,Mt.zO)()-a}))},e.getBlob=function(e,t,n){return new Promise((function(r,a){return e instanceof OffscreenCanvas?e.convertToBlob({type:t,quality:n}).then(r).catch(a):e instanceof HTMLCanvasElement?e.toBlob((function(e){return e?r(e):a()}),t,n):void 0}))},e.render=function(t,n,r){return new Promise((function(a,i){e.getBlob(t,n,r).then((function(e){var t=new FileReader;t.addEventListener("load",(function(){t.result&&t.result instanceof ArrayBuffer?a(new Uint8Array(t.result)):i()}),{passive:!0}),t.readAsArrayBuffer(e)})).catch((function(e){return i(e)}))}))},e}();var rn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),an=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},on=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};!function(e){function t(){var t=e.call(this)||this;return t.started=!1,t.capturer=new nn,t}rn(t,e),t.prototype.renderImage=function(e,t){var n=this;this.stop(),this.started=!0,this.capturer.setSettings(t),this.capturer.start(1);var r=new Promise((function(r,a){var i=e.getOption("clear",!0),o=e.getTimeline(),s=o.getSequence();if(i)e.draw();else for(var c=t.time>=s.duration?s.frames:o.getFrameAtTime(t.time),l=0;l<=c;l++)o.setFrame(l),e.draw();n.capturer.capture(e.getCanvas(),0),n.capturer.save().then((function(e){r(e[0]),n.started=!1})).catch(a)}));return this.renderPromise=(0,Mt.Oi)(r),r},t.prototype.prepareRenderAnimation=function(e,t){return an(this,void 0,void 0,(function(){var n,r,a,i,o,s,c;return on(this,(function(l){switch(l.label){case 0:return n=(0,Mt.zO)(),e.setOption("time",0),e.draw(),r=(0,Mt.zO)()-n,a=e.getTimeline().getSequence(),[4,nn.getRenderTime(e.getCanvas(),t.type,t.quality)];case 1:return i=l.sent(),o=(i+r)*a.frames,300,s=1+Math.floor(o/1e3/300),c=Math.floor(a.frames/s),[2,{estimated_time:o,total_frames:a.frames,total_parts:s,forPart:c}]}}))}))},t.prototype.stop=function(){this.started=!1,this.renderPromise&&this.renderPromise.cancel(),this.capturer.stop()},t.prototype.renderAnimation=function(e,t){var n=this;this.stop(),this.started=!0;var r=e.getTimeline().getSequence(),a=new Promise((function(a,i){n.prepareRenderAnimation(e,t).then((function(o){return an(n,void 0,void 0,(function(){var n,s,c,l;return on(this,(function(d){switch(d.label){case 0:this.dispatch("renderer:start",o),n=[],s=0,d.label=1;case 1:if(!(s<o.total_parts))return[3,8];if(!this.started)return[3,6];d.label=2;case 2:return d.trys.push([2,4,,5]),[4,this.renderAnimationPart(e,t,s*o.forPart,o.forPart,s,r.frames,o.total_parts)];case 3:return(c=d.sent())?n.push(c):i(),[3,5];case 4:return l=d.sent(),i(l),[3,5];case 5:return[3,7];case 6:i(),d.label=7;case 7:return s++,[3,1];case 8:return a(n),this.started=!1,[2]}}))}))}))}));return this.renderPromise=(0,Mt.Oi)(a),a},t.prototype.renderAnimationPart=function(e,t,n,r,a,i,o){return an(this,void 0,void 0,(function(){var s,c,l,d,u,p,h,f,m,g,v,y,b;return on(this,(function(w){switch(w.label){case 0:this.capturer.setSettings(t),this.capturer.stop(),this.capturer.start(r),s=e.getTimeline(),c=0,f=0,w.label=1;case 1:return f<r?this.started?(l=f+n)<=i?(d=(0,Mt.zO)(),s.setFrame(l),e.draw(),[4,this.capturer.capture(e.getCanvas(),f)]):[3,3]:[2,void 0]:[3,4];case 2:w.sent(),u=(0,Mt.zO)(),c=u-d,this.dispatch("renderer:render-frame",{frame:l,part:a,forPart:r,total_frames:i,total_parts:o,render_time:c}),w.label=3;case 3:return f++,[3,1];case 4:return[4,this.capturer.save()];case 5:if(p=w.sent(),!this.started)return[3,7];for(h=new tn,f=0,m=p.length;f<m;f++){for(g=(f+n).toString(),v="",y=g.length;y<=4;y++)v+="0";v+=g,h.file(v+this.capturer.extension,p[f])}return[4,h.generateAsync({type:"blob"})];case 6:return b=w.sent(),this.started?(this.capturer.stop(),[2,b]):[2,void 0];case 7:return[2,void 0]}}))}))}}(It);var sn=function(){return(sn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const cn=function(){function e(){}return e.parse=function(t){var n,r,a,i,o,s,c,l,d,u,p,h,f;if(!t)return null;var m=t&&t.length>0?JSON.parse(t):{};if(!("scene"in m))return null;var g=e.createEmptyProject(),v={id:null!==(n=m.id)&&void 0!==n?n:g.id,urpflanze_version:null!==(r=m.urpflanze_version)&&void 0!==r?r:g.urpflanze_version,name:null!==(a=m.name)&&void 0!==a?a:g.name,width:null!==(i=m.width)&&void 0!==i?i:g.width,height:null!==(o=m.height)&&void 0!==o?o:g.height,resolution:null!==(s=m.resolution)&&void 0!==s?s:g.resolution,background:null!==(c=m.background)&&void 0!==c?c:g.background,color:null!==(l=m.color)&&void 0!==l?l:g.color,clear:null!==(d=m.clear)&&void 0!==d?d:g.clear,ghosts:null!==(u=m.ghosts)&&void 0!==u?u:g.ghosts,ghostSkipTime:null!==(p=m.ghostSkipTime)&&void 0!==p?p:g.ghostSkipTime,ghostSkipFunction:null!==(h=m.ghostSkipFunction)&&void 0!==h?h:g.ghostSkipFunction,ratio:null!==(f=m.ratio)&&void 0!==f?f:g.ratio,scene:m.scene||g.scene,sequence:sn(sn({},g.sequence),m.sequence)},y={clear:v.clear,ghosts:v.ghosts,ghostSkipTime:Mt.dL.unparse(v.ghostSkipTime)},b=new ot({color:v.color,background:v.background,width:v.width,height:v.height}),w=new Kt(b,void 0,y,v.ratio,v.resolution);w.getTimeline().setSequence(v.sequence.duration,v.sequence.framerate);for(var _=Object.values(v.scene||[]),x=0,E=_.length;x<E;x++){var Z=e.parseSceneChild(_[x],b);Z&&b.add(Z)}return w},e.parseSceneChild=function(t,n){var r=void 0!==t.shape?Float32Array.from(Object.values(t.shape)):void 0,a={id:t.id,name:t.name,order:t.order,bUseParent:t.bUseParent,bUseRecursion:t.bUseRecursion,adaptMode:t.adaptMode,bClosed:t.bClosed,shape:r},i=Ut.create(t.type,a);if(i){var o=sn({},t.props);Object.keys(o).forEach((function(e){Ut.setProp(i,e,Mt.dL.unparse(o[e]),n)}));var s=sn({},t.style);if(Object.keys(s).forEach((function(e){Ut.setDrawerProp(i,e,Mt.dL.unparse(s[e]),n)})),void 0!==t.vertexCallback&&Ut.setSetting(i,"vertexCallback",t.vertexCallback,n),t.children&&t.children.length>0)for(var c=0,l=t.children.length;c<l;c++){var d=e.parseSceneChild(t.children[c],n);d&&Ut.add(i,d)}return i}return console.warn("[Urpflanze:JSONImporter] can't import",t),null},e.createEmptyProject=function(){return{id:(0,Dt.Z)(),urpflanze_version:"0.2.4-beta",name:"",width:600,height:600,resolution:600,background:"#000",color:"#fff",clear:!0,ghosts:0,ghostSkipTime:30,ratio:1,scene:{},sequence:{duration:6e3,framerate:60}}},e}();var ln=function(){return(ln=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};!function(){function e(){}e.parse=function(t,n){return void 0===n&&(n="EmptyProject"),e.toString(e.parseAsProject(t,n))},e.toString=function(e){return JSON.stringify(e)},e.parseAsProject=function(t,n){void 0===n&&(n="EmptyProject");var r=t.getTimeline(),a=cn.createEmptyProject();a.name=n,a.clear=t.getOption("clear",!0),a.ghosts=t.getOption("ghosts",0),a.ghostSkipTime=t.getOption("ghostSkipTime",void 0),a.ghostSkipFunction=Mt.dL.parse(t.getOption("ghostSkipFunction",void 0)),a.ratio=t.getRatio();var i=r.getSequence(),o=i.duration,s=i.framerate;a.sequence={duration:o,framerate:s},a.scene={};var c=t.getScene();if(c){a.width=c.width,a.height=c.height,a.color=c.color,a.background=c.background;for(var l=c.getChildren(),d=0,u=l.length;d<u;d++)a.scene[l[d].id]=e.parseSceneChild(l[d])}return a},e.parseSceneChild=function(t,n,r){void 0===r&&(r=0);for(var a={id:t.id+"",type:t.type,name:t.name,order:t.order,data:ln(ln({},t.data),{props:void 0,style:void 0}),depth:r,bPrimitive:t instanceof st.Z,props:{},style:{},parentId:n},i=t.getProps(),o=Object.keys(i),s=0,c=o.length;s<c;s++)i[o[s]]=Mt.dL.parse(i[o[s]]);if(a.props=ln(ln({},i),t.data.props),t instanceof dt&&(a.shape=t.shape),t instanceof Qe.Z&&(a.bUseParent=t.bUseParent,a.bUseRecursion=t.bUseRecursion,a.vertexCallback=Mt.dL.parse(t.data.vertexCallback||t.vertexCallback),console.log("export",a.vertexCallback,t.vertexCallback)),t instanceof st.Z){var l=t.style,d=Object.keys(l);for(s=0,c=d.length;s<c;s++)l[d[s]]=Mt.dL.parse(l[d[s]]);a.style=ln(ln({},l),t.data.style),a.adaptMode=t.adaptMode,a.bClosed=t.bClosed}else if(t instanceof it||t instanceof nt){var u=[],p=Ut.getChildren(t);for(s=0;s<p.length;s++)u.push(e.parseSceneChild(p[s],t.id,r+1));a.children=u}return a}}();var dn=function(){return(dn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},un={size:1080,quality:1,time:0,noBackground:!0};!function(){function e(){}e.parse=function(e,t){return t=dn(dn({},un),t),this.parseAsSVG(e,t).outerHTML},e.parseAsSVG=function(e,t){t=dn(dn({},un),t);var n=e.getScene(),r=dn(dn({},e.getOptions()),{time:t.time,decimals:Math.floor(4*t.quality),noBackground:t.noBackground}),a=document.createElement("div"),i=new en(n,a,r,e.getRatio()),o=i.getTimeline();return o.setDuration(e.getTimeline().getDuration()),o.setTime(r.time||0),i.draw(),a.firstChild}}();var pn=n(76544),hn=n(3043),fn=n(3883),mn=n.n(fn),gn=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)r[a]=i[o];return r};const vn=function(){function e(){}return e.isSVG=function(t){return e.SVG_REGEX.test(t.replace(e.COMMENT_REGEX,""))},e.stringToSVG=function(t){return e.isSVG(t)?"undefined"==typeof DOMParser?(console.warn("[Urpflanze:SVGImport] DOMParser not defined"),null):(new DOMParser).parseFromString(t,"image/svg+xml").querySelector("svg"):(console.warn("[Urpflanze:SVGImport] | Input is not valid SVG string",t),null)},e.parse=function(t,n){void 0===n&&(n=.001),null===e.stringToSVG(t)&&console.warn("[Urpflanze:SVGImport] | Cannot convet string to SVG",t);var r=e.SVGStringToBuffers(t,n);if(null===r)return console.warn("[Urpflanze:SVGImport] | Cannot convet string DrawerCanvas",t),null;var a=cn.createEmptyProject(),i=new ot({color:a.color,background:a.background,width:r.viewBox[2]-r.viewBox[0],height:r.viewBox[3]-r.viewBox[1]});return r.buffers.forEach((function(e){i.add(new dt({shape:e.buffer,bClosed:e.closed}))})),new Kt(i,void 0)},e.SVGStringToBuffers=function(t,n){var r;void 0===n&&(n=.001);var a=e.stringToSVG(t);if(null===a)return console.error("[Urpflanze:SVGImport] | Cannot convert string to svg",t),null;var i=a.getAttribute("fill"),o=a.getAttribute("stroke"),s=a.getAttribute("line-width"),c=e.getViewbox(a);a.querySelectorAll("g").forEach(e.propagateGroupTransformAndStyleToChildren);var l=Array.from(a.querySelectorAll("rect, circle, ellipse, line, polyline, polygon, path")),d=(r=[]).concat.apply(r,l.map((function(t){return e.elementToPath(t)}))),u=Math.max(c[2]-c[0],c[3]-c[1]).toExponential(1).match(/e(\+?[0-9]+)/),p=10/(1e3/Math.min(Math.pow(10,Math.max(u?+u[1]:0,0)),1e3)),h=d.map((function(t){return e.pathToBuffer(t,p,c)}));h=h.map((function(t){return e.simpliyBuffer(t,n)}));for(var f=[],m=0;m<h.length;m++){var g=d[m].getAttribute("stroke-width"),v=void 0;g&&(v=g.indexOf("%")>=0?e.fromPercentage(parseFloat(g),Math.sqrt((c[2]-c[0])*(c[3]-c[1]))):parseFloat(g)),f.push({buffer:h[m],closed:e.pathIsClosed(d[m]),fill:e.getColor("fill",d[m])||i||void 0,stroke:e.getColor("stroke",d[m])||o||void 0,lineWidth:v||(s?parseFloat(s):void 0)})}return l.forEach((function(e){return e.remove()})),{viewBox:c,buffers:f}},e.getColor=function(e,t){var n=t.getAttribute(e);if(n)return"none"===n?void 0:n},e.getViewbox=function(t){var n=t.getAttribute("viewBox");if(n)return n.split(" ").map((function(e){return parseFloat(e)}));var r=t.getAttribute("width"),a=t.getAttribute("height");if(r&&a)return[0,0,parseFloat(r),parseFloat(a)];t=t.cloneNode(!0);var i=Array.from(t.querySelectorAll("rect, circle, ellipse, line, polyline, polygon, path")),o=[].concat.apply([],i.map((function(t){return e.elementToPath(t)})));if(o.length>0){for(var s=0,c=0,l=0,d=o.length;l<d;l++){var u=st.Z.getBounding(e.pathToBuffer(o[l],1));u.width+=u.x,u.height+=u.y,u.width>s&&(s=u.width),u.height>c&&(c=u.height)}return[0,0,s,c]}return[-1,-1,1,1]},e.pathIsClosed=function(e){var t;return"z"===(null===(t=e.getAttribute("d"))||void 0===t?void 0:t.trim().substr(-1).toLowerCase())},e.simpliyBuffer=function(e,t){void 0===t&&(t=.01);for(var n=[],r=0,a=e.length;r<a;r+=2)n.push({x:e[r],y:e[r+1]});var i=mn()(n,t,!0);return i.forEach((function(t,n){e[2*n]=t.x,e[2*n+1]=t.y})),e.subarray(0,2*i.length)},e.pathToBuffer=function(e,t,n){void 0===t&&(t=.01),void 0===n&&(n=[-1,-1,1,1]);var r,a=n[2]-n[0],i=n[3]-n[1],o=a>i?1:a/i,s=a>i?i/a:1,c=e.getAttribute("transform")||"";if(c.length>0){var l=(0,pn.qC)((0,pn.tm)((0,pn.fk)(c)));r=new hn.Matrix(l.a,l.b,l.c,l.d,l.e,l.f)}for(var d=hn.path.map(e.getAttribute("d")||"",r),u=Math.floor(hn.path.getTotalLength(d)),p=2*Math.floor(u/t),h=new Float32Array(p),f=0,m=0;f<u;f+=t,m+=2){var g=hn.path.getPointAtLength(d,f),v=g.x,y=g.y;h[m]=o*(v/a)*2-1,h[m+1]=s*(y/i)*2-1,o<1&&(h[m]+=1-o),s<1&&(h[m+1]+=1-s)}return h},e.propagateGroupTransformAndStyleToChildren=function(e){var t=e.getAttribute("transform");if(t&&t.length>0){var n=(0,pn.qC)((0,pn.tm)((0,pn.fk)(t))),r=e.children;Array.from(r).forEach((function(e){var r=e.getAttribute("transform");if(r&&r.length>0){var a=(0,pn.qC)((0,pn.tm)((0,pn.fk)(r))),i=(0,pn.qC)(a,n);r=(0,pn.uv)(i)}e.setAttribute("transform",t)}))}["fill","stroke","stroke-width"].forEach((function(t){var n=e.getAttribute(t);n&&Array.from(e.children).forEach((function(e){null===e.getAttribute(t)&&e.setAttribute(t,n)}))}))},e.elementToPath=function(t){var n=t.getAttribute("transform")||"",r=t.getAttribute("fill"),a=t.getAttribute("stroke"),i=t.getAttribute("lineWidth");if("path"==t.nodeName){var o=t.getAttribute("d")||"";return hn.path.toAbsolute(o).map((function(e){return""+e.shift()+e.join(",")})).join(" ").split("M").filter((function(e){return e.length>0})).map((function(e){return"M"+e})).map((function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d",e),t.setAttribute("transform",n),r&&t.setAttribute("fill",r),a&&t.setAttribute("stroke",a),i&&t.setAttribute("lineWidth",i),t}))}var s=document.createElementNS("http://www.w3.org/2000/svg","path"),c=t.nodeName;return["rect","ellipse","circle","line","polyline","polygon"].includes(c)?(s.setAttribute("d",e.CONVERSION[c](t)),s.setAttribute("transform",n),r&&s.setAttribute("fill",r),a&&s.setAttribute("stroke",a),i&&s.setAttribute("lineWidth",i),[s]):(console.warn("[Urpflanze:SVGImport] | Cannot convert "+c+" to path"),[])},e.fromPercentage=function(e,t){return/%$/.test(e+"")?100*parseFloat((e+"").replace("%",""))/t:+e},e.chunk=function(e,t){void 0===t&&(t=2);for(var n=[];e.length>0;)n.push(e.splice(0,t));return n},e.SVG_REGEX=/^\s*(?:<\?xml[^>]*>\s*)?(?:<!doctype svg[^>]*\s*(?:\[?(?:\s*<![^>]*>\s*)*\]?)*[^>]*>\s*)?(?:<svg[^>]*>[^]*<\/svg>|<svg[^/>]*\/\s*>)\s*$/i,e.COMMENT_REGEX=/<!--([\s\S]*?)-->/g,e.CONVERSION={rect:function(t){var n=parseFloat(t.getAttribute("width")||"0"),r=parseFloat(t.getAttribute("height")||"0"),a=parseFloat(t.getAttribute("x")||"0"),i=parseFloat(t.getAttribute("y")||"0"),o=t.getAttribute("rx")||"auto",s=t.getAttribute("ry")||"auto";"auto"===o&&"auto"===s?o=s=0:"auto"!==o&&"auto"===s?o=s=e.fromPercentage(o,n):"auto"!==s&&"auto"===o?s=o=e.fromPercentage(s,r):(o=e.fromPercentage(o,n),s=e.fromPercentage(s,r)),o>n/2&&(o=n/2),s>r/2&&(s=r/2);var c=o>0&&s>0;return gn(["M"+(a+o)+" "+i,"H"+(a+n-o)],c?["A"+o+" "+s+" 0 0 1 "+(a+n)+" "+(i+s)]:[],["V"+(i+r-s)],c?["A"+o+" "+s+" 0 0 1 "+(a+n-o)+" "+(i+r)]:[],["H"+(a+o)],c?["A"+o+" "+s+" 0 0 1 "+a+" "+(i+r-s)]:[],["V"+(i+s)],c?["A"+o+" "+s+" 0 0 1 "+(a+o)+" "+i]:[],["Z"]).join(" ")},ellipse:function(e){var t,n,r,a,i=parseFloat(e.getAttribute("cx")||"0"),o=parseFloat(e.getAttribute("cy")||"0"),s=parseFloat(null!==(n=null!==(t=e.getAttribute("rx"))&&void 0!==t?t:e.getAttribute("r"))&&void 0!==n?n:"0"),c=parseFloat(null!==(a=null!==(r=e.getAttribute("ry"))&&void 0!==r?r:e.getAttribute("r"))&&void 0!==a?a:"0");return["M"+(i+s)+" "+o,"A"+s+" "+c+" 0 0 1 "+i+" "+(o+c),"A"+s+" "+c+" 0 0 1 "+(i-s)+" "+o,"A"+s+" "+c+" 0 0 1 "+(i+s)+" "+o,"Z"].join(" ")},circle:function(t){return e.CONVERSION.ellipse(t)},line:function(e){return"M"+(e.getAttribute("x1")||"0")+" "+(e.getAttribute("y1")||"0")+" L"+(e.getAttribute("x2")||"0")+" "+(e.getAttribute("y2")||"0")},polyline:function(t){var n=(t.getAttribute("points")||"").trim().replace(/  +/g," ").split(" ").reduce((function(e,t){return gn(e,t.includes(",")?t.split(","):[t])}),[]);return e.chunk(n,2).map((function(e,t){return(0===t?"M":"L")+e[0]+" "+e[1]})).join(" ")},polygon:function(t){return e.CONVERSION.polyline(t)+" Z"},path:function(e){return e.getAttribute("d")+""}},e}();var yn=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};const bn=function({project:e,updateProjectProperties:t}){const[n,a]=r.useState({project_id:"",interval:!1}),[i,o]=r.useState(!1);r.useEffect((()=>{function e(e){var t;const n=(null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text"))||"";vn.isSVG(n)&&ge.Z.dispatch((0,ye.h7)("import-svg",{svg:n}))}return document.addEventListener("paste",e,{passive:!0}),()=>document.removeEventListener("paste",e)}),[]),r.useEffect((()=>{let t=0;return n.interval&&n.project_id===e.id&&(t=window.setTimeout((()=>{(0,Xe.IG)()||(Pe("autosave"),we.autosave(e))}),Ae.Z.autosave_timeout)),()=>{t&&clearTimeout(t)}}),[n,e]),r.useEffect((()=>{function r(r){if(70==r.keyCode&&(0,h.sn)(r))return document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen(),r.preventDefault();if(i)83==r.keyCode&&(0,h.sn)(r)&&r.preventDefault();else switch(r.keyCode){case 32:we.ask("toggle-timeline");break;case 90:(0,h.sn)(r)&&(r.shiftKey?we.redo():we.undo());break;case 83:(0,h.sn)(r)&&(r.preventDefault(),function(){yn(this,void 0,void 0,(function*(){const r=we.getAutosaveProjectId();if(r&&r!=e.id&&(o(!0),!(yield Ye("Override exist autosave project?","Yes","No"))))return(yield Ye("Restore autosave project?","Yes","No"))&&(a({project_id:r,interval:!0}),we.restoreAutosave()),void o(!1);if(void 0===e.name||0===e.name.length){o(!0);const r=yield De("Set project name",Ae.Z.empty_project_name);if(null===r)return;t({name:r}),e.name=r,document.title=Ae.Z.getDocumentProjectTitle(r),a(Object.assign({},n)),o(!1)}(e.id!==n.project_id||e.id===n.project_id&&!n.interval)&&a({project_id:e.id,interval:!0}),we.autosave(e).then((()=>Pe(`${e.name} saved`)))}))}())}}return document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r)}}),[e,n,i])},wn=o.ZP.ul`
	display: grid;
	grid-template-columns: repeat(4, max-content);
	align-items: center;
	list-style: none;
	margin: 0 ${i.Z.ms(-2)};
	padding: 0 ${i.Z.ms(-2)};
	font-size: 0.8rem;
	line-height: ${i.Z.ms(2)};
	height: 100%;

	li ul {
		display: none;
	}

	${e=>e.enableSubMenu&&"\n        li:hover ul { display: block; }\n    "}
`,_n=o.ZP.li`
	position: relative;
	z-index: 10;
	padding: ${i.Z.ms(-2)} ${i.Z.ms(-1)};
	line-height: 1;

	&:hover {
		background: ${i.Z.color("dark-verylighten")};
		border-radius: 2px;
		cursor: pointer;
	}
`,xn=r.memo((0,a.$j)((e=>({project:e.project})),(e=>({updateProjectProperties:t=>e((0,ve.JR)(t))})))((({project:e})=>{const t=r.createRef(),[n,a]=r.useState(!1),[i,o]=r.useState(!1);return r.useEffect((()=>{function e(e){if(e.data&&e.data.event)switch(e.data.event){case"set-popup-window-value":console.log(e.data),we.run("set-prop",e.data.value)}}return window.addEventListener("message",e,!1),()=>window.removeEventListener("message",e)}),[]),bn({project:e,updateProjectProperties:ve.JR}),r.useEffect((()=>{let e=0;function r(r){var s;e&&clearTimeout(e),r.target==t.current||(null===(s=t.current)||void 0===s?void 0:s.contains(r.target))?a(!n):(i&&o(!1),n&&a(!1))}function s(r){var i;r.target==(null==t?void 0:t.current)||(null===(i=null==t?void 0:t.current)||void 0===i?void 0:i.contains(r.target))?e&&clearTimeout(e):!e&&(e=window.setTimeout((()=>{n&&a(!1)}),1e3))}return document.addEventListener("mousemove",s,{passive:!0}),document.addEventListener("click",r,{passive:!0}),()=>{document.removeEventListener("mousemove",s),document.removeEventListener("click",r)}}),[n,t,i]),r.createElement("nav",{role:"navigation",ref:t},r.createElement(wn,{enableSubMenu:n},r.createElement(_n,null,r.createElement("img",{src:"/assets/images/logo-full.svg",style:{height:"18px",display:"inline-block",verticalAlign:"middle"}}),r.createElement(Ce,{actions:Oe})),r.createElement(_n,null,r.createElement("div",null,"File"),r.createElement(Ce,{actions:qe,project:e})),r.createElement(_n,null,r.createElement("div",null,"Edit"),r.createElement(Ce,{actions:Ue,setOpenHistory:o})),r.createElement(_n,null,"Render",r.createElement(Ce,{actions:Ne}))),i&&r.createElement(Ze,null))})));var En=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};const Zn=o.F4`
    0%{ opacity: 0; }
    100%{ opacity: 1; }
`,kn=i.Z.color("dark").lighten(10),Sn=o.ZP.div`
    position: absolute;
    text-align: left;
    background: ${kn};
    font-size: ${e=>e.small?".7rem":".8rem"};
    padding: ${i.Z.ms(-3)} ${i.Z.ms(-2)};
    line-height: 1.2;
    border-radius: 4px;
    opacity: 0;
    pointer-events: none;
    z-index: 1000;
    white-space: pre;

    &:after{
        position: absolute;
        display: block;
        line-height: 0;
        font-size: 0;
        content: ' ';
    }

    ${e=>{switch(e.position){case"bottom":return`\n                top: 120%;\n                left: 50%;\n                transform: translate(-50%, 0);\n                \n                &:after {\n                    left: 50%;\n                    bottom: 100%;\n                    transform: translate(-50%, 0%);\n                    border-bottom: 6px solid ${kn};\n                    border-left: 5px solid transparent;\n                    border-right: 5px solid transparent;\n                }\n            `;case"left":return`\n                top: 50%;\n                right: 120%;\n                transform: translate(0%, -50%);\n                \n                &:after {\n                    left: 100%;\n                    top: 50%;\n                    transform: translate(0%, -50%);\n                    border-left: 6px solid ${kn};\n                    border-top: 5px solid transparent;\n                    border-bottom: 5px solid transparent;\n                }\n            `;case"right":return`\n                top: 50%;\n                left: 120%;\n                transform: translate(0%, -50%);\n                \n                &:after {\n                    right: 100%;\n                    top: 50%;\n                    transform: translate(0%, -50%);\n                    border-right: 6px solid ${kn};\n                    border-top: 5px solid transparent;\n                    border-bottom: 5px solid transparent;\n                }\n            `;case"top":return`\n                bottom: 120%;\n                left: 50%;\n                transform: translate(-50%, 0);\n                \n                &:after {\n                    left: 50%;\n                    top: 100%;\n                    transform: translate(-50%, 0%);\n                    border-top: 6px solid ${kn};\n                    border-left: 5px solid transparent;\n                    border-right: 5px solid transparent;\n                }\n            `}}}
`,Cn=o.ZP.div`
    position: relative;
    &:hover ${Sn} { 
        animation: ${e=>e.disabled?null:Zn} .1s .3s linear both;
    }
`,On=r.memo((e=>{var{disabled:t,small:n,position:a,title:i,children:o}=e,s=En(e,["disabled","small","position","title","children"]);return r.createElement(Cn,Object.assign({disabled:t},s),r.createElement(Sn,{small:n||!1,position:a||"top",dangerouslySetInnerHTML:{__html:i}}),o)}));var Pn=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};const An=r.memo((e=>r.createElement(On,{title:"Processing",style:{height:"100%"}},r.createElement("svg",{style:{height:"100%",opacity:e.visible?1:.001,transition:"opacity .1s"},viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid"},r.createElement("circle",{cx:"50",cy:"50",r:"37",strokeWidth:"10",stroke:"#ffffff",strokeDasharray:"58.119464091411174 58.119464091411174",fill:"none",strokeLinecap:"round",transform:"rotate(66.0614 50 50)"},r.createElement("animateTransform",{attributeName:"transform",type:"rotate",repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",values:"0 50 50;360 50 50"}))))));An.displayName="Loading";const jn={color:"rgba(255,255,255,.4)",background:i.Z.color("dark").toString("hex"),display:"flex",gap:i.Z.ms(-1),padding:`0 ${i.Z.ms(-1)}`,alignItems:"center",fontSize:".8rem",height:"100%"},Mn=r.memo((()=>{const e=(0,h.tg)(),[t,n]=r.useState(!1),[a,i]=r.useState(0),o=document.getElementById("workspace");return r.useEffect((()=>{o&&(document.documentElement.style.cursor=t?"wait":"auto",o.style.pointerEvents=t?"none":"auto")}),[t]),r.useEffect((()=>{let e=0,t=performance.now();function r(){return setTimeout((()=>Pn(this,void 0,void 0,(function*(){const e=yield we.ask("scene-points");e!=a&&i(e)}))))}return we.attach("executor-work",(e=>{const r=performance.now();(r-t>300||0==e.waiting)&&(t=r,n(e.waiting>0))})),we.attach("project:update-properties",(t=>{t.ghosts&&(e=r())})),we.attach("scene:update-layers",(t=>{e=r()})),we.attach("drawer:update",(t=>{e=r()})),we.attach("scene:update-scene_child-prop",(t=>{for(let n=0,a=t.length;n<a;n++)if("repetitions"===t[n].name||"shape"===t[n].name)return e=r()})),r(),()=>{e&&clearTimeout(e)}}),[]),r.createElement("div",{style:jn},r.createElement("div",null,e?"Run on web worker":"Run in local"),r.createElement(An,{visible:t}),r.createElement("div",{style:{justifySelf:"flex-end",flex:5,textAlign:"right"}},r.createElement("div",null,"Number of points: ",a)))})),Tn={position:"fixed",bottom:0,left:0,listStyle:"none",margin:0,padding:0},In=o.F4`
    from { transform: translate(0%, 0%) scale(.8); }
    to { transform: translate(0%, 0%) scale(1); }
`,Ln=o.ZP.li`
    background: ${i.Z.color("secondary")};
    color: #fff;
    padding: ${i.Z.ms(-1)};
    margin: ${i.Z.ms(-1)};
    transform-origin: left center;
    animation: ${In} .1s ease-out both;
`,$n=(0,a.$j)((e=>({messages:e.app.messages})))((({messages:e})=>{const t=Object.values(e).reverse();return r.createElement("ul",{style:Tn},t.map((e=>r.createElement(Ln,{key:e.id},e.message))))})),Rn={position:"relative",border:`1px solid ${i.Z.color("dark-lighten")}`,width:i.Z.add(2,0),borderRadius:"2px",maxHeight:"70vh"},Dn={listStyle:"none",margin:0,padding:0,width:"100%"},Bn=o.ZP.li`
	position: relative;
	width: 100%;
	cursor: pointer;
	padding: ${i.Z.div(1,"2rem")};

	&:hover img {
		filter: hue-rotate(180deg);
	}

	& + & {
		margin-top: 1px;
	}
`,zn=()=>{const[e,t]=r.useState([]);r.useEffect((()=>{we.ask("toolbar",{size:128,color:i.Z.color("primary").toString("hex")}).then(t)}),[]);return r.createElement("section",{"data-name":"toolbar",style:Rn},r.createElement("ul",{style:Dn},e.map(((e,t)=>r.createElement(Bn,{key:t,onClick:()=>{return t=e.name,void we.run("add",{type:t});var t}},r.createElement(On,{title:`Add <i><b>${e.name}</b></i> shape to Scene`,position:"right"},r.createElement("img",{src:e.image,style:{width:"100%"}})))))))};var Fn=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};const qn=e=>{var{columns:t,rows:n,flow:a,gap:i,halign:o,valign:s,style:c,children:l,component:d}=e,u=Fn(e,["columns","rows","flow","gap","halign","valign","style","children","component"]);const p=void 0===t&&void 0===n||void 0!==t&&void 0!==n?"gridTemplate":t>=0?"gridTemplateColumns":"gridTemplateRows",h=a||(t&&n?`repeat(${n}, 1fr) / repeat(${t}, 1fr)`:`repeat(${t||n}, 1fr)`),f=Object.assign({display:"grid",[p]:h,gap:i,alignItems:s,justifyContent:o},c);return r.createElement(d||"div",Object.assign({style:f},u),l)},Un={display:"inline-block",overflow:"hidden",borerRadius:"2px"},Nn={position:"relative",width:"100%",height:"100%",margin:"-1px",transformOrigin:"left top",background:"rgba(255,255,255,.2)"},Vn=r.memo((({scale:e,translate:t,height:n})=>{const a=parseFloat(n),o=a/e/2,s={border:`1px solid ${e>1?i.Z.color("primary"):i.Z.color("primary").alpha(.4).toString("rgba")}`,width:a+"rem",height:a+"rem"},c={top:(0,w.Sr)(-1,1,t[1],o,a-o)+"rem",left:(0,w.Sr)(-1,1,t[0],o,a-o)+"rem",transform:`scale(${1/e}) translate(-50%, -50%)`};return r.createElement(qn,{rows:2,flow:"max-content auto",style:{justifyItems:"center"},gap:i.Z.ms(-2)},r.createElement("small",null,r.createElement(On,{small:!0,title:"Use wheel on drawer for zoom\nand drag for translate"},r.createElement("span",{style:{color:1!==e?i.Z.color("primary").toString("hex"):""}},"Zoom"))),r.createElement("div",{style:Object.assign(Object.assign({},s),Un)},r.createElement("div",{style:Object.assign(Object.assign({},c),Nn)})))}));var Gn=n(99011);const Hn=r.memo((()=>{const[e,t]=r.useState(0);return r.useEffect((()=>{we.ask("set-drawer-lines",e)}),[e]),r.useEffect((()=>{let t=!0;function n(n){t=!t,72==n.keyCode&&we.ask("set-drawer-lines",t?e:0)}return document.addEventListener("keydown",n,{passive:!0}),()=>document.removeEventListener("keydown",n)}),[e]),r.createElement(qn,{rows:2,flow:"max-content auto",style:{justifyItems:"center"},gap:i.Z.ms(-2)},r.createElement("small",null,"Lines"),r.createElement("div",{style:{display:"flex",alignItems:"center"}},r.createElement(Gn.Z,{size:0,rotate:180,name:"arrow-right",onClick:()=>t((0,w.uZ)(0,20,e-1))}),r.createElement("small",null,e),r.createElement(Gn.Z,{size:0,name:"arrow-right",onClick:()=>t((0,w.uZ)(0,20,e+1))})))}));var Yn=n(62957),Wn=n(27106),Xn=n(73259),Kn=n(84581);const Jn=r.memo((({offsets:e,ratio:t,setSize:n,setOffsets:a})=>{const[i,o]=r.useState([0,0]),[s]=(0,Yn.Z)(),c=r.useRef(null),l=(0,Kn.Z)({onDrag:t=>{e.translate=[(0,w.uZ)(-1,1,i[0]+t.x/-100/e.scale),(0,w.uZ)(-1,1,i[1]+t.y/-100/e.scale)],1==e.scale&&(e.translate=[0,0]),we.ask("set-drawer-offsets",e),a(Object.assign({},e))},onDragEnd:()=>{o([...e.translate])}}),d=(0,Wn.Z)(c),u=Math.floor(Math.min(d.width,d.height));return(0,Xn.Z)(l,((t,n)=>{n.preventDefault();const r=e.scale;e.scale=(0,w.uZ)(1,10,r+-1*Math.sign(t)*(n.shiftKey?1:n.altKey?.01:.1)),1==e.scale&&(e.translate=[0,0]),we.ask("set-drawer-offsets",e),a(Object.assign({},e))})),r.useEffect((()=>{l.current&&s.current&&u>0&&(a(Object.assign(Object.assign({},e),{size:u})),we.setDrawer(s.current,u,t,pe.Z.get("resolution","high")),l.current.style.width=u+"px",l.current.style.height=u+"px",n(u))}),[u]),r.useEffect((()=>{if(s.current&&u>0){let e=t>=1?u:u*t,n=t>=1?u/t:u;if(e>u){const t=e/n;e=u,n=u/t}else if(n>u){const t=n/e;n=u,e=u/t}s.current.style.width=e+"px",s.current.style.height=n+"px",s.current.style.maxWidth=e+"px",s.current.style.maxHeight=n+"px",s.current.style.minWidth=e+"px",s.current.style.minHeight=n+"px"}}),[u,t]),r.createElement("div",{ref:c,style:{width:"100%",height:"100%",overflow:"hidden",display:"flex",justifyContent:"center"}},r.createElement("div",{ref:l,style:{background:"#000",display:"flex",justifyContent:"center",alignItems:"center"}},r.createElement("canvas",{ref:s,style:{pointerEvents:"none",maxWidth:"100%",maxHeight:"100%"}})))}));var Qn=n(21680);const er=r.memo((({clear:e,ghosts:t})=>r.createElement(qn,{rows:2,flow:"max-content auto",style:{justifyItems:"center",opacity:t>0?.2:1,pointerEvents:t>0?"none":void 0},gap:i.Z.ms(-2)},r.createElement("small",null,r.createElement("label",{style:{cursor:"pointer",color:0!==t||e?"":i.Z.color("primary").toString("hex")},htmlFor:"cb_clear"},"Clear")),r.createElement(Qn.Z,{size:1,checked:e,id:"cb_clear",onChange:e=>we.ask("set-drawer-clear",e)})))),tr={passive:!0,once:!1,capture:!1},nr={};function rr(e,t){return e.passive==t.passive&&e.capture==t.capture&&e.once==t.once}function ar(e,t,n=tr){const r=Object.assign(Object.assign({},tr),n||{});("string"==typeof e?[e]:e).forEach((e=>{if(e in nr){let n=!1;for(let a=0,i=nr[e].length;a<i;a++){const i=nr[e][a];if(rr(r,i.options)){i.callbacks.push(t),n=!0;break}}n||nr[e].push({options:r,callbacks:[t],handler:or(e,r)})}else nr[e]=[{options:r,callbacks:[t],handler:or(e,r)}]}))}function ir(e,t,n=tr){const r="string"==typeof e?[e]:e,a=Object.assign(Object.assign({},tr),n||{});r.forEach((e=>{if(e in nr){for(let n=0,r=nr[e].length;n<r;n++){const r=nr[e][n];if(rr(a,r.options)&&(r.callbacks.splice(r.callbacks.indexOf(t),1),0===r.callbacks.length)){window.removeEventListener(e,r.handler),nr[e].splice(n,1);break}}0==nr[e].length&&delete nr[e]}}))}function or(e,t){function n(n){if(e in nr){nr[e].forEach((e=>{rr(e.options,t)&&e.callbacks.forEach((e=>e(n)))}))}}return window.addEventListener(e,n,t),n}const sr=function(){return[ar,ir]},[cr]=sr();let lr;const dr=[];function ur(e){if(e==lr)return!1;const t=document.createElement("textarea");return t.value=e||"",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),!0}cr(["cut","copy"],(function(){const e=window.getSelection();lr=e?e.toString():void 0,dr.forEach((e=>e(lr)))}),{passive:!0});const pr=function(){const[e,t]=r.useState(lr);return r.useEffect((()=>{function e(e){t(e)}return dr.push(e),()=>{dr.splice(dr.indexOf(e,1))}}),[]),[e,ur]},hr={backgroundImage:"url(/assets/images/png-background.png)",backgroundPosition:"center center",backgroundSize:"cover",position:"relative",borderRadius:"4px",display:"inline-block",verticalAlign:"middle"},fr={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"2px"},mr=r.memo((({color:e,clipboard:t,size:n,onClick:a})=>{let o,s;return(t=void 0===t||t)&&([o,s]=pr()),n="string"==typeof n?n:i.Z.ms(n||0),r.createElement("div",{style:Object.assign(Object.assign({},hr),{width:n,height:n,cursor:a?"pointer":void 0})},r.createElement("div",{style:Object.assign(Object.assign({},fr),{background:e}),onClick:function(n){!1!==(a&&a(n))&&t&&s(e)&&Pe(`Copy ${e} to clipboard.`)}}))})),gr=({children:e,container:t})=>Ie.createPortal(e,"string"==typeof t?document.querySelector(t):t);var vr=n(72995),yr=n(38166);const br=o.ZP.div`
    position: relative;
    line-height: 0;
    
    ${e=>e.vertical?`\n        width: ${i.Z.ms(0)};\n        min-height: ${i.Z.ms(4)};\n        height: 100%;  \n        padding: ${i.Z.div(0,"1.6rem")} 0;\n        transform: scale(-1);\n\n        > div { transform: translate(0%, -50%) scale(-1.2); }\n        cursor: n-resize;\n    `:`\n        height: ${i.Z.ms(0)};\n        min-width: ${i.Z.ms(4)};\n        width: 100%;  \n        padding: 0 ${i.Z.div(0,"1.6rem")};\n\n        > div { transform: translate(-50%, 0) scale(1.2); }\n        cursor: e-resize;\n    `}
    border-radius: ${i.Z.ms(0)};
    background: ${i.Z.color("dark","hex")};
    

        
    &:hover > div{
        background: ${i.Z.color("dark-lighten").lighten(10)};
    }
`,wr=o.ZP.div`
    position: absolute;
    height: ${i.Z.ms(0)};
    width: ${i.Z.ms(0)};
    border-radius: ${i.Z.ms(0)};
    background: ${i.Z.color("dark-lighten")};
    box-shadow: 0 0 4px 1px rgba(0,0,0, .6);
    pointer-events: none;

    > small {
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translate(-50%, -${i.Z.add(-2,"2px")});
        line-height: 1;
        background: ${i.Z.color("dark-lighten").lighten(10)};
        padding: ${i.Z.ms(-3)} ${i.Z.ms(-2)};
        border-radius: 2px;

        &:after{
            display: block;
            content: ' ';
            clear: both;
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translate(-50%, -2px);
            border-top: 6px solid ${i.Z.color("dark-lighten").lighten(10)};
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
        }
    }
`,_r=r.memo((({value:e,step:t,min:n,max:a,onChange:i,vertical:o})=>{const s=t.toExponential(1).match(/e(-?[0-9]+)/),c=Math.pow(10,s?-s[1]:0),[l,d]=r.useState(!1),[u,p]=(0,yr.Z)({value:e,vertical:o,step:t,exp:c,min:n,max:a,onChange:i,events:{drag:()=>d(!0)}});return r.createElement(br,{vertical:o,ref:p,onMouseOver:()=>!l&&d(!0),onMouseOut:()=>l&&d(!1)},r.createElement(wr,{style:{[o?"top":"left"]:u.valuePercentage+"%"}},r.createElement("small",{style:{display:l?"block":"none"}},u.value.toFixed(Math.log10(c)))))}));var xr=n(4598);function Er(e){try{return new xr.default(e).toRGBA().replace(/ /gi,"")}catch(e){}return null}function Zr(e,t,n,r){const a=r/2,i=(Math.atan2(e.y-a,e.x-a)+Math.PI)/(2*Math.PI),o=Math.sqrt((e.x-a)*(e.x-a)+(e.y-a)*(e.y-a))/a;return new xr.default(`rgba(${kr(i,o,t/100).join(",")},${Math.round(100*n)/100})`).toHSLA()}function kr(e,t,n){let r=0,a=0,i=0;const o=Math.floor(6*e),s=6*e-o,c=n*(1-t),l=n*(1-s*t),d=n*(1-(1-s)*t);switch(o%6){case 0:r=n,a=d,i=c;break;case 1:r=l,a=n,i=c;break;case 2:r=c,a=n,i=d;break;case 3:r=c,a=l,i=n;break;case 4:r=d,a=c,i=n;break;case 5:r=n,a=c,i=l}return[r,a,i].map((e=>(0,w.uZ)(0,255,Math.round(255*e))))}const Sr={position:"relative",borderRadius:" 50%",overflow:"hidden",cursor:"pointer",border:`1px solid ${i.Z.color("dark").darken(5)}`},Cr={cursor:"pointer",borderRadius:"50%",border:"2px solid",width:"12px",height:"12px",top:"-7px",left:"-7px",zIndex:1,backfaceVisibility:"hidden",transition:"border-color .3s ease-in",pointerEvents:"none"},Or=r.memo((({color:e,coords:t,value:n,alpha:a,onChange:o,wheelSize:s})=>{const c=(0,Kn.Z)({onDrag(e,t){const r={x:t.x-l.x,y:t.y-l.y};o(Zr(r,n,a,s),"slider")},onDragEnd(e,t){const r={x:t.x-l.x,y:t.y-l.y};o(Zr(r,n,a,s),"none")}}),l=(0,Wn.Z)(c);return r.useEffect((()=>{if(c.current){const e=c.current.getContext("2d");e&&e.putImageData(function(e,t){const n=t/2,r=new ImageData(t,t),a=r.data;for(let r=-n;r<n;r++)for(let i=-n;i<n;i++){const o=Math.sqrt(r*r+i*i),s=Math.atan2(i,r);if(o>n)continue;const c=(s+Math.PI)/(2*Math.PI),l=4*(r+n+(i+n)*t),[d,u,p]=kr(c,o/n,e/100);a[l]=d,a[l+1]=u,a[l+2]=p,a[l+3]=255}return r}(n,s),0,0)}}),[n,c.current]),r.createElement("div",{style:Object.assign(Object.assign({},Sr),{width:s+"px",height:s+"px"})},r.createElement("div",{style:Object.assign(Object.assign({},Cr),{position:"absolute",background:e,transform:`translate(${t.x}px, ${t.y}px)`,borderColor:n>50?i.Z.color("dark").toString():"#ffff"})}),r.createElement("canvas",{ref:c,width:s,height:s,style:{width:s+"px",height:s+"px",transform:"scale(1.025)"}}))})),Pr=o.ZP.input`
    width: ${i.Z.add(4,2)};
    padding: ${i.Z.ms(-3)} ${i.Z.ms(-2)};
    background: ${i.Z.palette.get("dark","hex").darken(5)};
    border:none;
    font-size: 1rem;
    color: #fff;
`,Ar=o.ZP.div`
    cursor: pointer;
    color: rgba(255,255,255,.3);
    &:hover {
        color: rgba(255,255,255,.6);
    }
`,jr=r.memo((({color:e,onChange:t})=>{const n=r.useRef(null),[a]=pr(),o=a?Er(a):null;function s(){if(n.current&&n.current.value.length>0){const r=Er(n.current.value);r&&r!=e&&(n.current.value="",t(r))}}return r.createElement(qn,{columns:3,flow:"repeat(3, max-content)",valign:"center",gap:i.Z.ms(-1),style:{width:"100%"}},r.createElement(Pr,{ref:n,placeholder:"Insert color",onKeyUp:e=>13==e.keyCode&&s()}),r.createElement(Ar,{onClick:()=>s()},"Add"),o?r.createElement(mr,{onClick:()=>t(o),color:o,clipboard:!1}):r.createElement("div",{style:{width:i.Z.ms(0),height:i.Z.ms(0)}}))})),Mr=140,Tr={position:"fixed",background:`${i.Z.color("dark").lighten(2)}`,border:`1px solid ${i.Z.color("dark").lighten(10)}`,borderRadius:"2px",padding:`${i.Z.ms(0)}`,userSelect:"none",lineHight:i.Z.ms(0)},Ir=o.ZP.div`
    position: relative;
    margin-left: ${i.Z.sub(0,-3)};
    padding-left: ${i.Z.add(-1)};
`,Lr=o.ZP.div`
    position: absolute;
    font-size: .8rem;
    transform: translate(-50%, -50%) rotate(-90deg);
    left: 0;
    top: 50%;
`,$r=r.memo(r.forwardRef(((e,t)=>{if(!e.position)return null;const n=e.color?e.color:"#fff",a=function(e,t){const n=new xr.default(e),{h:r,s:a,v:i}=n.getHsv(),o=a*t/2,s=2*r*Math.PI-Math.PI;return{value:Math.round(100*i),alpha:n.getAlpha(),hue:r,saturation:a,coords:{x:o*Math.cos(s)+t/2,y:o*Math.sin(s)+t/2}}}(n,Mr),o=(0,vr.Z)(),s=e.position.x>o.width-238?e.position.x-238:e.position.x,c=e.position.y>o.height-238?e.position.y-238:e.position.y;return r.createElement(gr,{container:"#picker-root"},r.createElement("div",{ref:t,style:{position:"relative",zIndex:1e3}},r.createElement(qn,{rows:3,gap:i.Z.ms(0),flow:"repeat(3, 'max-content')",style:Object.assign(Object.assign({},Tr),{top:`${c}px`,left:`${s}px`})},r.createElement("div",{style:{display:"flex"}},r.createElement(Or,{wheelSize:Mr,color:n,onChange:e.onChange,coords:a.coords,value:a.value,alpha:a.alpha}),r.createElement(Ir,null,r.createElement(Lr,null,"Value"),r.createElement(_r,{min:0,max:100,step:1,vertical:!0,value:a.value,onChange:function(t,r){const i=Zr(a.coords,t,a.alpha,Mr);i!=n&&e.onChange(i,r)}})),e.enableAlpha&&r.createElement(Ir,null,r.createElement(Lr,null,"Alpha"),r.createElement(_r,{min:0,max:1,step:.01,vertical:!0,value:a.alpha,onChange:function(t,r){const i=Zr(a.coords,a.value,t,Mr);i!=n&&e.onChange(i,r)}}))),r.createElement("div",null,r.createElement(mr,{color:n}),r.createElement("small",{style:{marginLeft:i.Z.ms(-2)}},n)),r.createElement("div",null,r.createElement(jr,{color:n,onChange:function(t){t!=n&&e.onChange(t,"none")}})))))}))),Rr=r.memo((({value:e,enableAlpha:t,size:n,onChange:a})=>{const[i,o]=r.useState(e),[s,c]=r.useState(null),l=r.useRef(null),d=r.useRef(null);return r.useEffect((()=>{function t(e){var t,n;(0,h.sn)(e)||e.target!=l.current&&!(null===(t=l.current)||void 0===t?void 0:t.contains(e.target))&&e.target!=d.current&&!(null===(n=d.current)||void 0===n?void 0:n.contains(e.target))?null!=s&&c(null):null==s&&c({x:e.clientX+12,y:e.clientY+12})}return e!=i&&o(e),document.addEventListener("mousedown",t,{passive:!0}),()=>document.removeEventListener("mousedown",t)}),[e,l.current,d.current,s]),r.createElement(r.Fragment,null,r.createElement("div",{ref:l,style:{display:"flex",alignItems:"center"}},r.createElement(mr,{size:n,color:i,onClick:e=>!!(0,h.sn)(e)&&void 0})),r.createElement($r,{ref:d,enableAlpha:null==t||t,position:s,color:i,onChange:function(e,t){"slider"==t&&o(e),a(e,"slider"==t)}}))}));var Dr=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};function Br(e,t,n,r=1,a=1){return new Promise((i=>{const o=new Image;o.onload=()=>Dr(this,void 0,void 0,(function*(){const e=t?yield function(e,t,n,r=1,a=1){return new Promise((i=>{const o=document.createElement("canvas"),s=o.getContext("2d");o.width=t,o.height=t,s.globalAlpha=r;const c="none"==n?1:Math["adapt"==n?"min":"max"](o.width/e.width,o.height/e.height),l="none"==n?0:o.width/2-e.width/2*c,d="none"==n?0:o.height/2-e.height/2*c;s.drawImage(e,l,d,e.width*c,e.height*c);const u=new Image;u.onload=()=>i(u),u.src=o.toDataURL("image/png",a)}))}(o,t,n,r,a):o;if((0,h.tg)()){const t=yield createImageBitmap(e);i({image:t,source:e.src})}else i({image:e,source:e.src})})),o.src=e}))}var zr=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};const Fr=r.memo((({background:e,backgroundImage:t})=>{const[n,a]=r.useState(!0);return r.useEffect((()=>{n&&t&&function(e){zr(this,void 0,void 0,(function*(){if(null===e)we.ask("set-background-image",{image:null,source:null});else{const{image:t,source:r}="string"==typeof e?yield Br(e,n?null:1080,"fill",1):e;n&&a(!1),we.ask("set-background-image",{image:t,source:r})}}))}(t)}),[t,n]),r.createElement(qn,{rows:2,flow:"max-content auto",style:{justifyItems:"center"},gap:i.Z.ms(-2)},r.createElement("small",null,"Background"),r.createElement(Rr,{enableAlpha:!1,hideColorName:!0,size:1,onChange:(e,t)=>{we.ask("set-scene-background",{background:e,preventDispatch:t})},value:e}))})),qr=r.memo((({clear:e,ghostSkipTime:t,ghosts:n})=>{function a(e=n,r=t){((e=e<0?0:e)>=0&&e!=n||r!=t)&&we.ask("set-drawer-ghosts",{ghosts:e,ghostSkipTime:r})}function o(e,t,n,r=1){return Math.floor((e.shiftKey?t:1)*(e.ctrlKey?n:1))*(e.altKey?r:1)}return r.createElement(qn,{rows:2,flow:"max-content auto",style:{justifyItems:"center",pointerEvent:e?"":"none",opacity:e?"":".2"},gap:i.Z.ms(-2)},r.createElement("small",{style:{color:n>0?i.Z.color("primary").toString("hex"):""}},"Ghosts"),r.createElement("div",{style:{textAlign:"center"}},r.createElement(On,{title:"Number of ghosts"},r.createElement(Gn.Z,{size:0,rotate:180,name:"arrow-right",onClick:e=>a(n-o(e,5,10),t)}),r.createElement("small",null,n||0),r.createElement(Gn.Z,{size:0,name:"arrow-right",onClick:e=>a(n+o(e,5,10),t)})),r.createElement(On,{title:"Ghost frame skip"},r.createElement(Gn.Z,{size:0,rotate:180,name:"arrow-right",onClick:e=>a(n,t-o(e,100,10,.1))}),r.createElement("small",null,t||1),r.createElement(Gn.Z,{size:0,name:"arrow-right",onClick:e=>a(n,t+o(e,100,10,.1))}))))}));var Ur=n(62368);const Nr=[{key:"1:1",value:1},{key:"4:3",value:4/3},{key:"3:2",value:1.5},{key:"1.85:1",value:1.85},{key:"2.39:1",value:2.39},{key:"16:9",value:16/9},{key:"A4 (v)",value:210/297},{key:"A4 (h)",value:297/210},{key:"9:16",value:9/16},{key:"10:16",value:.625}],Vr=r.memo((({ratio:e,size:t,resolution:n})=>r.createElement(qn,{rows:2,flow:"max-content auto",style:{justifyItems:"center"},gap:i.Z.ms(-2)},r.createElement("small",null,"Aspect Ratio"),r.createElement("div",{style:{display:"flex",alignItems:"center"}},r.createElement("small",null,r.createElement(Ur.Z,{width:"6rem",position:"top",options:Nr,value:e,onChange:e=>function(e){we.ask("set-drawer-ratio",{ratio:e,size:t,resolution:n})}(e),placeholder:"Resolution"})))))),Gr=r.memo((0,a.$j)((e=>({backgroundImage:e.project.backgroundImage,background:e.project.background,clear:e.project.clear,ghosts:e.project.ghosts,ghostSkipTime:e.project.ghostSkipTime,ratio:e.project.ratio})))((({background:e,clear:t,backgroundImage:n,ghostSkipTime:a,ghosts:o,ratio:s})=>{const[c,l]=r.useState(0),[d,u]=r.useState(pe.Z.get("resolution","high")),[p,h]=r.useState({scale:1,translate:[0,0],size:400});return r.createElement(qn,{component:"section","data-name":"drawer",rows:2,gap:i.Z.ms(0),flow:"auto max-content",style:{width:"100%",height:"100%",overflow:"hidden"}},r.createElement(Jn,{setSize:l,ratio:s,offsets:p,setOffsets:h}),r.createElement(qn,{columns:7,gap:i.Z.ms(0),flow:"repeat(7, max-content)",halign:"center",valign:"start"},r.createElement(Vn,Object.assign({height:i.Z.ms(1)},p)),r.createElement(Fr,{offsets:p,background:e,backgroundImage:n}),r.createElement(er,{ghosts:o,clear:t}),r.createElement(qr,{clear:t,ghosts:o,ghostSkipTime:a}),r.createElement(Hn,null),r.createElement(Vr,{ratio:s,size:c,resolution:d})))})));function Hr(e){return(Math.round(e/10)/100).toFixed(2)+"s"}const Yr=o.ZP.div`
	line-height: 1;
`,Wr=o.ZP.div`
	display: flex;
	position: relative;
	height: 0.8rem;
	width: 100%;
	margin: ${i.Z.ms(-2)} 0;

	> span {
		position: absolute;
		transform: translate(-50%, 0);
	}
`,Xr=o.ZP.div`
	display: flex;
`,Kr=o.ZP.div`
	display: flex;
	justify-content: space-between;
	height: ${i.Z.ms(0)};

	> span {
		position: absolute;
		height: 100%;
		width: 6px;
		transform: translate(-50%, 0);

		&:after  {
			position: absolute;
			top: 0;
			left: 2.5px;
			width: 1px;
			height: 100%;
			display: block;
			content: ' ';
		}
		&:nth-child(2n + 1):after {
			background: rgba(255, 255, 255, 0.05);
		}
		&:nth-child(2n):after {
			background: rgba(0, 0, 0, 0.2);
		}
	}
`,Jr=o.ZP.div`
	position: relative;
	background: ${i.Z.color("dark-lighten")};
`,Qr=o.ZP.div`
	position: absolute;
	top: -${i.Z.ms(-2)};

	&:after {
		position: absolute;
		top: 0;
		display: block;
		content: ' ';
		width: 1px;
		height: ${i.Z.add(0,-2)};
		background: ${i.Z.color("primary")};
	}
`,ea=o.ZP.div`
	position: absolute;
	bottom: 100%;
	background: ${i.Z.color("primary")};
	padding: ${i.Z.ms(-3)};
	font-weight: 600;
	transform: translateX(-50%);
	border-radius: 2px;
`,ta=r.memo((({sequence_duration:e,sequence_framerate:t,current_time:n,renderedFrames:a,steps:o,enableMoveTime:s,onChange:c})=>{const l=Math.floor(e/1e3*t),d=r.useRef(),{width:u}=(0,Wn.Z)(d),p=new Array(o).fill(0).map(((t,n)=>r.createElement("span",{key:n,onClick:()=>f(n*e/o),style:{left:n*(100/o)+"%"}},Hr(n*e/o)))),h=new Array(2*o+1).fill(0).map(((t,n)=>r.createElement("span",{style:{left:n*(100/(2*o))+"%"},onClick:()=>f(n*(e/(2*o))),key:n})));function f(t){const r=(0,w.uZ)(0,e,t);r!==n&&c(r)}const m=(0,Kn.Z)({onDrag:t=>{const r=n+(0,w.uZ)(0,u,Math.abs(t.x))*Math.sign(t.x)/u*e,a=(0,w.uZ)(0,e,r);s&&f(a)}});return r.createElement(Yr,null,r.createElement(Wr,null,p,r.createElement("span",{style:{left:"100%"}},Hr(e))),r.createElement(Jr,{ref:d},r.createElement(Xr,null,new Array(l).fill(0).map(((e,t)=>r.createElement("div",{key:t,style:{width:100/l+"%",height:"1px",background:a.includes(t)?i.Z.color("primary").toString("hex"):""}})))),r.createElement(Kr,null,h),r.createElement(Qr,{style:{left:(0,w.Sr)(0,e,n,0,100)+"%"}},r.createElement(ea,{style:{cursor:s?"ew-resize":"not-allowed"},ref:m},Hr(n)))))}));var na=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};const ra={position:"relative",padding:`${i.Z.ms(0)} ${i.Z.ms(1)}`,width:"100%",fontSize:".8rem",border:`1px solid ${i.Z.color("dark-lighten")}`,borderBottomWidth:0,borderRadius:"2px 0 0 2px",transform:""},aa=r.memo((0,a.$j)((e=>({sequence:e.project.sequence,bEnableMoveBar:e.project.clear||void 0!==typeof e.project.ghosts&&e.project.ghosts>0,ghosts:e.project.ghosts,bTimelineStarted:e.app.bTimelineStarted})))((({sequence:e,bEnableMoveBar:t,bTimelineStarted:n})=>{const a=new Array(15).fill(0).map(((e,t)=>({key:t+1+"s",value:t+1}))),o=[10,24,30,60,120,144].map((e=>({key:e,value:e}))),[s,c]=r.useState({current_frame:0,current_time:0,fps:e.framerate}),[l,d]=r.useState([]),[u,p]=r.useState(!1);r.useEffect((()=>{if(we.attach("timeline:progress",(e=>{c(e)})),te.Z.level<te.i.ComunicationResponse){const e=setInterval((()=>na(void 0,void 0,void 0,(function*(){const e=yield we.ask("get-rendered-frames");d(e)}))),500);return()=>{clearInterval(e)}}}),[]),r.useEffect((()=>{const e=()=>!u&&p(!0),t=()=>u&&p(!1);return we.attach("drawer-canvas:buffer_loaded",e),we.attach("drawer-canvas:buffer_flush",t),()=>{we.detach("drawer-canvas:buffer_loaded",e),we.detach("drawer-canvas:buffer_flush",t)}}),[u]);const h=Math.round(e.framerate/(s.fps||1)*100)/100;return r.createElement("section",{"data-name":"timeline",style:ra},r.createElement("div",{style:{position:"absolute",left:i.Z.ms(0),top:i.Z.ms(0),display:"flex"}},u||1===h?"realtime":`${h}x slow`),r.createElement("div",{style:{display:"flex",justifyContent:"center",marginBottom:i.Z.ms(0)}},r.createElement(Gn.Z,{name:"sequence-start",onClick:()=>we.ask("set-timeline",0)}),r.createElement(Gn.Z,{name:n?"pause":"play",onClick:()=>we.ask("change-timeline-state",n?G.Z.PAUSE:G.Z.START)}),r.createElement(Gn.Z,{name:"sequence-end",onClick:()=>we.ask("set-timeline",e.duration)})),r.createElement("div",{style:{position:"absolute",right:i.Z.ms(0),top:i.Z.ms(0),display:"flex"}},r.createElement(On,{title:"Durate"},r.createElement(Gn.Z,{name:"time"})),r.createElement(Ur.Z,{position:"top",options:a,value:e.duration/1e3,placeholder:"durate",onChange:e=>we.ask("set-timeline-duration",1e3*e)}),r.createElement(On,{title:"FPS"},r.createElement(Gn.Z,{name:"time"})),r.createElement(Ur.Z,{position:"top",options:o,value:e.framerate,placeholder:"framerate",onChange:e=>we.ask("set-timeline-framerate",e)}),r.createElement("div",null,"Frames: ",Math.round(e.duration/1e3*e.framerate))),r.createElement(ta,{enableMoveTime:t,sequence_framerate:e.framerate,sequence_duration:e.duration,current_time:s.current_time,onChange:e=>we.ask("set-timeline",e),renderedFrames:l,steps:12}))})));var ia=n(46847);const oa=["Line","Triangle","Rect","RegularPolygon","Circle","Rose","Spiral","Lissajous","Desidus","Shape","ShapeLoop","Group"];const sa=o.ZP.div`
	height: ${i.Z.ms(2)};
	display: grid;
	grid-template-columns: repeat(7, max-content);
	justify-content: right;
	align-items: center;
	grid-gap: ${i.Z.ms(-1)};
	padding: 0 ${i.Z.ms(-1)};

	background: ${i.Z.color("dark")};
	border: 1px solid ${i.Z.color("dark-lighten")};
	border-top-width: 0;
`,ca=o.ZP.div`
	height: ${i.Z.ms(2)};
	display: grid;
	grid-template-columns: repeat(4, max-content);
	justify-content: left;
	align-items: center;
	grid-gap: ${i.Z.ms(-1)};
	padding: 0 ${i.Z.ms(-1)};

	background: ${i.Z.color("dark")};
	border: 1px solid ${i.Z.color("dark-lighten")};
	border-top-width: 0;
`,la=o.ZP.div`
	position: relative;
	z-index: 10;
`,da=o.ZP.ul`
	position: fixed;
	list-style: none;
	margin: 0;
	background: ${i.Z.color("dark")};
	border: 1px solid ${i.Z.color("dark").lighten(5)};
	box-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
	padding: 0;
	font-size: ${i.Z.sub(0,-4)};
	z-index: ${e=>e.open?1:-1};
	pointer-events: ${e=>e.open?null:"none"};
	transition: transform 0.1s, opacity 0.1s;
	transform-origin: bottom right;
	transform: translate(-92%, -99%) scale(${e=>e.open?1:.8});
	opacity: ${e=>e.open?1:0};
	display: grid;
	grid-template-columns: repeat(3, auto);
`,ua=o.ZP.li`
	cursor: pointer;
	padding: ${i.Z.ms(-1)} ${i.Z.ms(0)};
	display: block;
	&:hover {
		background: ${i.Z.color("dark").darken(10)};
	}
`,pa=r.memo((e=>{const[t,n]=r.useState(null),[a,i]=r.useState(!1),o=r.useRef(null);r.useEffect((()=>{function e(e){e.target&&o.current&&e.target!=o.current&&!o.current.contains(e.target)&&i(!1)}return document.addEventListener("click",e,{passive:!0}),()=>{document.removeEventListener("click",e)}}),[a]);const s=0===e.selecteds.length,c=1===e.selecteds.length,l=e.selecteds.length>1,d=Object.values(e.layers),u=c&&(0,ia.sE)(e.selecteds[0],d),p=e.selecteds.map((e=>(0,ia.sE)(e,d))).filter((e=>!!e)),h=!(!c||!u)&&u.bPrimitive,f=(t&&(s||c&&t.layer.id!==u.id||t.type),l||s||!t||"copy-properties"!=t.type||u&&t.layer.id==u.id),m=s||c||!function(e){return 2==e.length&&e[0].parentId==e[1].parentId&&(e[0].bPrimitive&&"Line"!==e[0].type&&void 0===e[0].props.repetitions||1==e[0].props.repetitions)&&(e[1].bPrimitive&&"Line"!==e[1].type&&void 0===e[1].props.repetitions||1==e[1].props.repetitions)}(p),g=u?(0,ia.tO)(u,d):-100,v=(0,ia.o_)(e.selecteds,d);function y(n,r,a){switch(r){case"add":we.run("add",{type:a,parentId:c&&u?u.id:void 0}),i(!1);break;case"paste":t&&"copy-properties"!==t.type&&we.run(t.type,{id:t.layer.id,parentId:c&&u?u.id:void 0,props:t.layer.props});break;case"paste-properties":if(t&&"copy-properties"==t.type&&u){const e=t.layer.props,n=u.props;we.run("set-prop",function(e,t,n){const r=[];return Object.keys(t).forEach((a=>{r.push({id:e,name:a,value:t[a],prev_value:n[a]})})),r}(u.id,e,n))}break;case"union":case"difference":case"intersect":case"xor":2==e.selecteds.length&&we.run("shape-operation",{type:r,a_id:e.selecteds[0],b_id:e.selecteds[1]});break;default:we.run(r,a)}}return r.createElement(r.Fragment,null,r.createElement(sa,null,r.createElement(On,{position:"top",title:"Copy properties",disabled:s||l},r.createElement(Gn.Z,{name:"copy-properties",disabled:s||l,onClick:()=>function(e){if(!s&&!l){const t=u;n({type:e,layer:t}),Pe(`${e} ${t.name}`)}}("copy-properties")})),r.createElement(On,{position:"top",title:"Paste properties",disabled:f},r.createElement(Gn.Z,{name:"paste-properties",disabled:f,onClick:e=>y(0,"paste-properties")})),r.createElement(On,{position:"top",title:"Add shape",disabled:a||!s||h},r.createElement(la,{ref:o},r.createElement(Gn.Z,{onClick:()=>i(!a),style:{position:"relative",zIndex:2},name:"add",rotate:a?45:0,disabled:!s&&h}),r.createElement(da,{open:a},oa.map((e=>r.createElement(ua,{key:e,onClick:t=>{y(0,"add",e)}},e)))))),r.createElement(On,{position:"top",title:"Move down",disabled:l||g<=-2||-1==g},r.createElement(Gn.Z,{name:"arrow-right-fill",size:0,rotate:90,disabled:l||g<=-2||-1==g,onClick:t=>y(0,t.shiftKey?"move-to-bottom":"move-down",e.selecteds)})),r.createElement(On,{position:"top",title:"Move up",disabled:l||g<=-2||1==g},r.createElement(Gn.Z,{name:"arrow-right-fill",size:0,rotate:270,disabled:l||g<=-2||1==g,onClick:t=>y(0,t.shiftKey?"move-to-top":"move-up",e.selecteds)})),r.createElement(On,{position:"top",title:"Make shape",disabled:s||!v},r.createElement(Gn.Z,{name:"shape",disabled:s||!v,onClick:t=>y(0,"make-shape",e.selecteds)})),r.createElement(On,{position:"top",title:"Remove",disabled:s},r.createElement(Gn.Z,{name:"remove",disabled:s,onClick:t=>y(0,"remove",e.selecteds)}))),r.createElement(ca,null,r.createElement(On,{position:"top",title:"Union",disabled:m},r.createElement(Gn.Z,{name:"shape-combine-union",disabled:m,onClick:e=>y(0,"union")})),r.createElement(On,{position:"top",title:"Difference",disabled:m},r.createElement(Gn.Z,{name:"shape-combine-difference",disabled:m,onClick:e=>y(0,"difference")})),r.createElement(On,{position:"top",title:"Intersect",disabled:m},r.createElement(Gn.Z,{name:"shape-combine-intersect",disabled:m,onClick:e=>y(0,"intersect")})),r.createElement(On,{position:"top",title:"XOR",disabled:m},r.createElement(Gn.Z,{name:"shape-combine-xor",disabled:m,onClick:e=>y(0,"xor")}))))})),ha=({layer:e,deep:t,toggleSelection:n,layers:a,selecteds:o})=>{const[s,c]=r.useState(!(!a||1!=o.length)&&(0,ia.$4)(e.id,o[0],a)),[l,d]=r.useState(!1),u=r.createRef(),p=o.includes(e.id);function f(){u.current&&u.current.value.length>0&&(u.current.value!=e.name&&we.ask("layer-rename",{id:e.id,name:u.current.value}),d(!1))}return r.useEffect((()=>{a&&!s&&(0,ia.$4)(e.id,o[0],a)&&c(!0)}),[o,s,a]),r.createElement(ma,{deep:t},r.createElement(fa,{selected:p},l?r.createElement(va,{ref:u,autoFocus:!0,defaultValue:e.name,onKeyDown:e=>13==e.keyCode&&f(),onFocus:e=>e.target.select()}):r.createElement("div",{style:{display:"flex",alignItems:"center"}},r.createElement(ya,{onClick:()=>e.children&&e.children.length>0&&c(!s)},e.children&&e.children.length>0&&r.createElement(Gn.Z,{name:"arrow-right-fill",size:0,rotate:s?90:0,fill:"#fff"})),r.createElement(ga,{onClick:t=>n(t,e.id)},r.createElement(Gn.Z,{size:0,name:(0,h.q7)(e.type)}),r.createElement("span",{style:{marginLeft:i.Z.ms(-3)}},e.name))),l?r.createElement(Gn.Z,{name:"save",fill:"#fff",onClick:()=>f()}):r.createElement(On,{title:"Rename"},r.createElement(Gn.Z,{name:"edit",fill:"#fff",onClick:()=>d(!0)})),r.createElement(On,{title:"Highlight"},r.createElement(Gn.Z,{name:"highlight",fill:"#fff",onMouseOver:()=>we.ask("layer-highlight",{id:e.id,status:!0}),onMouseOut:()=>we.ask("layer-highlight",{id:e.id,status:!1})})),r.createElement(On,{title:"Visibility"},e.data.visible?r.createElement(Gn.Z,{name:"visible",fill:"#fff",onClick:()=>we.ask("layer-visibility",{id:e.id,status:!1})}):r.createElement(Gn.Z,{name:"hidden",fill:"#fff",onClick:()=>we.ask("layer-visibility",{id:e.id,status:!0})}))),s&&e.children&&e.children.length>0&&r.createElement("ul",{style:{margin:0,padding:0}},e.children.map((e=>r.createElement(ha,{key:e.id,layers:a,layer:e,selecteds:o,toggleSelection:n,deep:t+1})))))},fa=o.ZP.div`
	border: 1px solid ${e=>e.selected?i.Z.color("primary"):i.Z.color("dark")};
	display: grid;
	align-items: center;
	grid-template-columns: auto max-content max-content max-content;
	line-height: ${i.Z.ms(2)};
	grid-gap: ${i.Z.ms(-2)};
	padding-right: ${i.Z.ms(-2)};

	&:hover {
		background: ${i.Z.color("dark").lighten(10)};
	}
`,ma=o.ZP.li`
	list-style: none;
	margin: 0;
	user-select: none;

	position: relative;
	z-index: 1;

	> ${fa} {
		padding-left: ${e=>e.deep>0?i.Z.mul(i.Z.add(0,-2,-2),e.deep+"rem"):0};
	}
`,ga=o.ZP.div`
	display: flex;
	align-items: center;
	width: 100%;
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
	cursor: cell;
`,va=o.ZP.input`
	width: 100%;
	line-height: inherit;
	background: ${i.Z.color("dark-lighten")};
	border: none;
	padding: 0 ${i.Z.ms(-1)};
`,ya=o.ZP.div`
	cursor: pointer;
	width: ${i.Z.add(0,-3)};
	padding-left: ${i.Z.ms(-3)};
	height: 100%;
`,ba=r.memo(ha),wa={padding:`0 ${i.Z.ms(0)}`,height:i.Z.ms(2),lineHeight:i.Z.ms(2),fonstSize:i.Z.sub(0,-3),fontWeight:"bold",color:i.Z.color("gray-dark").toString("hex"),borderRadius:"2px 2px 0 0",background:i.Z.color("dark").toString("hex"),border:`1px solid ${i.Z.color("dark-lighten")}`,borderBottom:"0px"},_a={maxHeight:`calc(100vh - ${i.Z.add(2,1,2,2,2)})`,listStyle:"none",margin:0,padding:0,overflowY:"auto",overflowX:"hidden",border:`1px solid ${i.Z.color("dark-lighten")}`,borderWidth:"0 1px"},xa=r.memo((0,a.$j)((e=>{var t;return{layers:e.project.scene,selecteds:e.project.selected_layers,open_layer_id:null===(t=e.project.open_layer_properties)||void 0===t?void 0:t.id}}),(e=>({selectLayers:(t,n=!1)=>e((0,ve.vl)(t,n))})))((({layers:e,open_layer_id:t,selectLayers:n,selecteds:a})=>{const o=Object.values(e);function s(e,t){const r=(0,ia.c8)(e,t,a,o);console.log("new_selecteds",r),n(r)}return r.useEffect((()=>{function r(){const r=window.location.pathname;if(r.length>0&&"/"!=r){const a=r.substr(1);if(t!=a){(0,ia.JU)(a,Object.values(e))&&n([a],!0)}}else n([],!0)}return window.addEventListener("popstate",r,{passive:!0}),()=>{window.removeEventListener("popstate",r)}}),[e,t]),r.createElement("section",{"data-name":"layers",style:{height:"100%"}},r.createElement("div",{style:wa},"Layers"),r.createElement("ul",{style:_a},o.length>0?o.map((e=>r.createElement(ba,{key:e.id,layers:o,toggleSelection:s,selecteds:a,layer:e,deep:0}))):r.createElement("li",{style:{color:i.Z.color("gray-dark").toString("hex"),padding:`0 ${i.Z.ms(0)}`,lineHeight:i.Z.ms(2),borderTop:"1px solid rgba(0,0,0,0)"}},r.createElement("small",null,r.createElement("i",null,"Add new shape from Toolbar or ",r.createElement(Gn.Z,{fill:i.Z.color("gray-dark").toString("hex"),name:"add"}))))),r.createElement(pa,{selecteds:a,layers:e}))}))),Ea=o.ZP.section`
	border: 1px solid ${i.Z.color("dark-lighten")};
	border-radius: 2px 2px 0 0;

	& + & {
		margin-top: ${i.Z.ms(0)};
	}
`,Za=o.ZP.header`
	cursor: ${e=>e.expandable?"pointer":null};
	display: grid;
	align-items: center;
	grid-template-columns: ${e=>e.withAction?"max-content auto max-content max-content":"max-content auto max-content"};
	grid-gap: ${i.Z.ms(-1)};
	padding: 0 ${i.Z.ms(0)};
	line-height: ${i.Z.ms(2)};
	height: ${i.Z.ms(2)};
	background: ${i.Z.color("dark")};
	fonst-size: ${i.Z.sub(0,-3)};
	font-weight: bold;
	color: ${i.Z.color("gray-dark")};
	white-space: nowrap;
	text-overflow: ellipsis;
	overflow: hidden;
`,ka=o.ZP.section`
	padding: ${i.Z.ms(0)};

	display: grid;
	grid-template-columns: 1fr;
	grid-gap: ${i.Z.ms(-2)};
	font-size: ${i.Z.sub(0,-4)};

	> * {
		line-height: ${i.Z.add(1,-1)};
	}
`,Sa=r.memo((e=>{const[t,n]=r.useState(void 0===e.expanded||e.expanded);return r.createElement(Ea,null,r.createElement(Za,{withAction:!!e.action,expandable:!!e.expandable,onClick:()=>e.expandable&&n(!t)},r.createElement(Gn.Z,{name:e.icon,fill:i.Z.color("gray-dark").toString("hex")}),r.createElement("span",null,e.name),e.action&&e.action,e.expandable&&r.createElement(Gn.Z,{name:"arrow-right",fill:i.Z.color("gray-dark").toString("hex"),cursor:"pointer",rotate:90,style:{transform:`scale(1, ${t?-1:1})`}})),t&&r.createElement(ka,null,e.children))})),Ca=r.memo((e=>{const[t,n]=r.useState(),a=e.layer,o=a.name;function s(){const e=a.id;return(0,w.Oi)(we.ask("get-buffer-length",{id:e}).then((t=>{a.id===e&&n(t)})))}r.useEffect((()=>{let e,t=!1;return we.attach("scene:update-scene_child-prop",(n=>{if(!t)for(let t=0,r=n.length;t<r;t++)if(n[t].id===a.id&&("repetitions"===n[t].name||"shape"===n[t].name))return e=s()})),e=s(),()=>{t=!0,e&&e.cancel()}}),[a.id]);const c=(0,ia.Dz)(a);return r.createElement(Sa,{name:o,icon:(0,h.q7)(a.type),expandable:!0,expanded:!0,action:r.createElement(Gn.Z,{name:"highlight",size:0,onMouseOver:()=>we.ask("layer-highlight",{id:a.id,status:!0}),onMouseOut:()=>we.ask("layer-highlight",{id:a.id,status:!1})})},"Number of points: ",t,c.length>0&&r.createElement("div",{style:{marginTop:i.Z.ms(0)}},"Primitives:",r.createElement("div",{style:{maxHeight:"10vh",overflowY:"auto",overflowX:"hidden"}},c.map((t=>r.createElement(qn,{key:t.id,columns:4,gap:i.Z.ms(-2),valign:"center",flow:"auto max-content max-content max-content"},r.createElement("div",null,t.name),r.createElement(Gn.Z,{name:"highlight",size:0,onMouseOver:()=>we.ask("layer-highlight",{id:t.id,status:!0}),onMouseOut:()=>we.ask("layer-highlight",{id:t.id,status:!1})}),r.createElement(On,{title:"Open"},r.createElement(Gn.Z,{name:"to-top",size:0,onClick:()=>e.selectLayer&&e.selectLayer(t.id)}))))))))}));var Oa=n(60953);let Pa=0;const Aa=r.memo((e=>{const t="rb_"+ ++Pa+"_"+e.name;return r.createElement(qn,{columns:e.values.length,flow:`auto repeat(${e.values.length}, auto)`,gap:i.Z.ms(0),valign:"center",halign:e.align||"space-around"},r.createElement("div",null,e.name),e.values.map((({key:n,value:a})=>r.createElement(ja,{key:t+"_"+n},r.createElement(Ma,{id:t+"_"+n,name:t,value:a,defaultChecked:a==e.selected,onClick:t=>{e.onChange(t.target.value)}}),r.createElement("label",{htmlFor:t+"_"+n},n)))))})),ja=o.ZP.div`
    position: relative;
    line-height: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    padding-bottom: 3px;
    color: ${i.Z.color("gray-dark")};
    font-size: .8rem;
    
    input:checked+label {
        color: ${i.Z.color("primary")};
    }

    label { cursor: pointer; }
`,Ma=o.ZP.input.attrs({type:"radio"})`
    position: absolute; 
    bottom: 0; left: 0;
    appearance: none;
    width: 100%;
    height: 3px;
    margin: 0;
    background: ${i.Z.color("gray-dark")};
    &:checked{
        background: ${i.Z.color("primary")};
    }
`;var Ta=n(34943);let Ia=null;const La=function(e,t,n,a){r.useEffect((()=>{var r;function i(e){(0,h.sn)(e)&&(e.shiftKey?(e.stopImmediatePropagation(),Ia&&(Ia.type===t.type||"multiple-range"===Ia.type&&"range"===t.type||"multiple-range"===t.type&&"range"===Ia.type)&&(a(Ia.value),Pe(Ia.name+" pasted to "+t.name))):(e.stopImmediatePropagation(),Ia={value:n,type:t.type,name:t.name},Pe(t.name+" copied")))}return null===(r=e.current)||void 0===r||r.addEventListener("click",i,{passive:!0}),()=>{var t;null===(t=e.current)||void 0===t||t.removeEventListener("click",i)}}),[e,n,t,a])};var $a=n(47790);const Ra=o.ZP.button`
    border: none;
    color: rgba(255,255,255,.8);
    background: none;
    cursor: pointer;
    line-height: 1;
    border-bottom: 2px solid ${i.Z.color("primary")};
    padding: ${i.Z.ms(-1)};

    &:hover {
        color: rgba(255,255,255,1);
    }
`,Da=r.memo((({label:e,onClick:t})=>r.createElement(Ra,{onClick:t},e)));var Ba=n(53892),za=n(12739);const Fa={sinusoidal:[{key:"sin",value:"sin"},{key:"cos",value:"cos"}],easing:Object.keys(Ba.Z).map((e=>({key:e,value:e})))};function qa(e,t){return t}const Ua=r.memo((({state:e,onChange:t,bColor:n,sequence:a})=>r.createElement(qn,{gap:i.Z.ms(-2),valign:"center",style:{margin:`${i.Z.ms(0)} 0`},columns:2,rows:5,flow:`repeat(5, 1fr) / max-content ${i.Z.ms(4)}`},r.createElement("div",{style:{gridColumn:"1 / span 2"}},r.createElement(Aa,{name:"Type",align:"flex-start",values:[{key:"Loop",value:"loop"},{key:"Uncontrolled loop",value:"uncontroller-loop"},{key:"Static",value:"static"}],selected:e.type,onChange:e=>t("type",e)})),"loop"!==e.type&&r.createElement(r.Fragment,null,r.createElement("div",null,"Delay"),r.createElement($a.Z,{size:2,min:0,max:a.duration,step:100,value:e.delay||0,onChange:(e,n)=>"none"===n&&t("delay",e)})),r.createElement("div",{style:{width:i.Z.ms(5),gridColumn:"1 / span 2"}},r.createElement(Aa,{name:"Mode",align:"flex-start",values:[{key:"Sinusoidal",value:"sinusoidal"},{key:"Easing",value:"easing"}],selected:e.mode,onChange:e=>t("mode",e)})),r.createElement("div",null,"Mode function"),r.createElement(Ur.Z,{onChange:e=>t("modeFunction",e),placeholder:`${e.mode} function`,options:Fa[e.mode||"cos"],value:e.modeFunction}),"loop"===e.type&&"easing"===e.mode&&r.createElement("small",{style:{gridColumn:"1 / span 2"}},"the durate of animation will be",r.createElement("br",null),"divide for two."),r.createElement(qn,{columns:n?2:1},r.createElement("div",null,r.createElement(Qn.Z,{checked:e.invertOdd,name:"Invert odd",onChange:e=>t("invertOdd",e)})),n&&r.createElement("div",null,r.createElement(Aa,{name:"Color mode",values:[{key:"rgb",value:"rgb"},{key:"hue",value:"hue"}],selected:e.colorTransitionMode,onChange:e=>t("colorTransitionMode",e)})))))),Na=r.memo((e=>{function t(t,n,r){let a;void 0!==r?(a=(0,h.qo)(e.value),a[r]=t):a=t,e.onChange(a,n)}if(e.locked)return r.createElement($a.Z,Object.assign({},e,{value:(0,h.He)(e.value),onChange:(e,n)=>t(e,n)}));const n=(0,h.qo)(e.value);return r.createElement(qn,{rows:2,gap:i.Z.ms(-4),style:{height:"100%",width:"100%"}},r.createElement($a.Z,Object.assign({},e,{small:!0,value:n[0],onChange:(e,n)=>t(e,n,0)})),r.createElement($a.Z,Object.assign({},e,{small:!0,value:n[1],onChange:(e,n)=>t(e,n,1)})))})),Va=r.memo((({value:e,name:t,onChange:n,sceneChildProp:a})=>{switch(a.type){case"color":return r.createElement(Rr,{size:i.Z.add(1,-1),value:e,onChange:(e,r)=>!1===r&&n(t,e)});case"range":return r.createElement($a.Z,{value:za.Z.bValueTransformable(e)?e.value:e,onChange:(e,r)=>"none"===r&&n(t,e),min:a.min,max:a.max,step:a.step});case"multiple-range":{const[o,s]=r.useState(!Array.isArray(e)||e[0]===e[1]);return r.createElement("div",{style:{display:"flex",gap:i.Z.ms(-2),alignItems:"center",height:"100%"}},r.createElement(Gn.Z,{size:0,style:{marginRight:i.Z.ms(-2)},name:o?"unlock-value":"lock-value",onClick:()=>s(!o)}),r.createElement(Na,{locked:o,value:za.Z.bValueTransformable(e)?e.value:e,onChange:(e,r)=>"none"===r&&n(t,e),min:a.min,max:a.max,step:a.step}))}case"slider":return r.createElement(_r,{value:e,onChange:(e,r)=>"none"===r&&n(t,e),min:a.min,max:a.max,step:a.step})}return null})),Ga=r.memo((0,a.$j)((e=>({sequence:e.project.sequence})))((({close:e,value:t,onChange:n,sequence:a,layer:o,prop_name:s})=>{const c=R.Z[s],l=za.Z.bValueAnimation(t),d=function(e,t,n=1e3){const r=za.Z.bValueAnimation(e)&&"simple"==e.type?e.value:{};return Object.assign({from:Array.isArray(t.default)?(0,h.He)(t.default):t.default,to:t.default_animate,duration:n,invertOdd:!1,colorTransitionMode:"rgb",type:"loop",mode:"sinusoidal",modeFunction:"sin",type_value:t.type_value,delay:0},r)}(t,c,Math.min(2e3,a.duration)),[u,p]=r.useState(d),[f,m]=r.useState(l&&("loop"!==(g=d).type||"sinusoidal"!==g.mode||"sin"!==g.modeFunction||!1!==g.invertOdd||"rgb"!==g.colorTransitionMode));var g;function v(e,t){if("mode"===e){const e=Fa[t];p(Object.assign(Object.assign({},u),{mode:t,modeFunction:e[0].value}))}else p("type"===e?Object.assign(Object.assign({},u),{type:t,mode:"static"===t?"easing":u.mode,modeFunction:"static"===t&&"easing"!=u.mode?Fa.easing[0].value:u.modeFunction}):Object.assign(Object.assign({},u),{[e]:t}))}return r.createElement("div",null,r.createElement("h2",null,"Simple animation"),r.createElement("small",null,"Animate prop ",r.createElement("b",null,s)," of shape ",o.name),r.createElement(qn,{gap:i.Z.ms(-2),valign:"center",style:{margin:`${i.Z.ms(0)} 0`},flow:`repeat(3, 1fr) / max-content ${i.Z.ms(4)}`},r.createElement("div",null,"From"),r.createElement(Va,{value:u.from,onChange:v,name:"from",sceneChildProp:c}),r.createElement("div",null,"To"),r.createElement(Va,{value:u.to,onChange:v,name:"to",sceneChildProp:c}),r.createElement("div",null,"Durate"),r.createElement($a.Z,{size:i.Z.add(1,-1),min:0,max:a.duration,step:100,value:u.duration,onChange:(e,t)=>"none"==t&&v("duration",e)})),r.createElement(Qn.Z,{checked:f,onChange:e=>m(e),name:"Advance mode",size:0}),f&&r.createElement(Ua,{state:u,bColor:"color"===c.type,sequence:a,onChange:v}),r.createElement("div",null,r.createElement("div",{style:{margin:`${i.Z.ms(0)} 0`,textDecoration:"underline",cursor:"pointer"},onClick:function(){e(),(0,Xe.$7)(o.id,s)}},"Open visual editor in new window"),r.createElement("div",{style:{margin:`${i.Z.ms(0)} 0`,textDecoration:"underline",cursor:"pointer"},onClick:function(){e(),(0,Xe.lI)(o.id,s)}},"openCodeEditor")),r.createElement(Da,{onClick:function(){n({type:"simple",value:qa(0,u)})},label:"Apply"}),l&&r.createElement(Da,{onClick:function(){n(void 0)},label:"Remove"}))}))),Ha=o.ZP.div`
	position: fixed;
	top: 0;
	left: 0;
	width: 100vw;
	height: 100vh;
	z-index: 10000;
	display: flex;
	justify-content: center;
	align-items: center;
`,Ya=o.F4`
    from { opacity: 0; }
    to { opacity: 1; }
`,Wa=o.ZP.div`
	position: fixed;
	top: 0;
	left: 0;
	width: 100vw;
	height: 100vh;
	animation: ${Ya} 0.1s ease-out both;
	background: rgba(0, 0, 0, 0.6);
`,Xa=o.F4`
    from { opacity: 0; transform: scale(.98); }
    to { opacity: 1; transform: scale(1); }
`,Ka=o.ZP.div`
	position: relative;
	z-index: 1000;
	max-width: 80vw;
	background: ${i.Z.color("dark-lighten")};
	padding: ${i.Z.ms(2)};
	box-shadow: 0 ${i.Z.ms(0)} ${i.Z.ms(2)} ${i.Z.ms(0)} rgba(0, 0, 0, 0.5);
	animation: ${Xa} 0.1s ease-out both;
	border-radius: 2px;
`,Ja=o.ZP.div`
	position: absolute;
	top: ${i.Z.ms(-1)};
	right: ${i.Z.ms(-1)};
`,Qa=r.memo((({bCloseOnBackground:e,open:t,close:n,children:a,noCloseButton:i=!1})=>{const o=document.getElementById("modal-root"),s=document.createElement("div");return r.useEffect((()=>(o.appendChild(s),()=>{o.removeChild(s)})),[o,s]),t?Ie.createPortal(r.createElement(Ha,null,r.createElement(Wa,{onClick:t=>e&&n&&n(t)}),r.createElement(Ka,null,!i&&r.createElement(Ja,null,r.createElement(Gn.Z,{onClick:n,name:"close"})),a)),s):null})),ei=o.ZP.div`
	position: absolute;
	bottom: 0;
	left: 0;
	background: ${i.Z.color("dark")};
	border-radius: 0 2px 0 0;
	line-height: 1;
	z-index: 1;
	transform: scale(0);
	transform-origin: left bottom;
	transition: transform 0.1s 0.5s ease-out;
`,ti=o.ZP.div`
	position: relative;

	&:hover ${ei} {
		transform: scale(1);
	}
`,ni=r.memo((({name:e,value:t,layer:n,prop_name:a,bDefaultValue:o,onChange:s})=>{const[c,l]=r.useState(!1),d=za.Z.bValueAnimation(t);return r.createElement("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column"}},r.createElement("div",{style:{lineHeight:1,marginBottom:i.Z.ms(-2)}},e),r.createElement("div",{style:{display:"flex"}},r.createElement(ti,null,r.createElement(ei,{style:{},onClick:()=>s(void 0)},r.createElement(Gn.Z,{size:0,name:"close"})),d?r.createElement(Gn.Z,{size:i.Z.add(1,-1),name:"animate-color"}):r.createElement(Rr,{onChange:s,value:t,size:i.Z.add(1,-1)})),r.createElement(On,{title:"Animate prop",position:"right"},r.createElement(Gn.Z,{name:d?"animated":"not-animated",onClick:()=>l(!0)}))),r.createElement(Qa,{open:c,close:()=>l(!1)},r.createElement(Ga,{close:()=>l(!1),value:t,layer:n,prop_name:a,onChange:e=>(s(e,"slider"=="none"),void(c&&l(!1)))})))})),ri=r.memo((({name:e,prop_name:t,value:n,min:a,max:o,step:s,type:c,animable:l,layer:d,initialArray:u,onChange:p,bDefaultValue:h})=>{const[f,m]=r.useState(!1),[g,v]=r.useState(!u&&Array.isArray(n)&&n[0]===n[1]),y=za.Z.bValueAnimation(n),b="multiple-range"==c,w=b?Na:$a.Z;function _(e,t){p(e,"slider"==t),f&&m(!1)}return r.createElement(qn,{columns:3,flow:"1fr 1fr max-content",gap:i.Z.ms(0),style:{userSelect:"none"}},r.createElement("div",{onClick:()=>!y&&b&&void v(!g),style:{textAlign:"right",cursor:b?"pointer":void 0,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},!y&&b&&r.createElement(Gn.Z,{size:0,style:{marginRight:i.Z.ms(-2)},name:g?"unlock-value":"lock-value",onClick:()=>null}),e),y?r.createElement("div",{style:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},"simple"==n.type?r.createElement("small",null,r.createElement("i",null,za.Z.bValueTransformable(n.value.from)?n.value.from.value:n.value.from," ","→",za.Z.bValueTransformable(n.value.to)?n.value.to.value:n.value.to," in"," ",Math.round(n.value.duration/100)/10,"s")):r.createElement("span",null,r.createElement("i",null,"raw function"))):r.createElement(w,{bDefaultValue:h,locked:g,value:n,min:a,max:o,step:s,onChange:_}),r.createElement("div",{style:{width:i.Z.ms(1)}},l&&r.createElement(On,{title:"Animate prop",position:"left"},r.createElement(Gn.Z,{name:y?"animated":"not-animated",onClick:()=>m(!0)}))),r.createElement(Qa,{open:f,close:()=>m(!1)},r.createElement(Ga,{close:()=>m(!1),value:n,layer:d,prop_name:t,onChange:e=>_(e,"none")})))})),ai=r.memo((({name:e,value:t,layer:n,min:a,max:o,step:s,prop_name:c,bDefaultValue:l,onChange:d})=>{const[u,p]=r.useState(!1),h=za.Z.bValueAnimation(t);return r.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},r.createElement("div",{style:{lineHeight:1,marginBottom:i.Z.ms(-2)}},e),r.createElement("div",{style:{display:"flex",height:i.Z.add(1,-1),alignItems:"center",justifyContent:"center",width:"100%"}},h?r.createElement(Gn.Z,{size:i.Z.add(1,-1),name:"animate-color"}):r.createElement(_r,{min:a,max:o,step:s,onChange:d,value:t}),r.createElement(On,{title:"Animate prop",position:"right"},r.createElement(Gn.Z,{name:h?"animated":"not-animated",onClick:()=>p(!0)}))),r.createElement(Qa,{open:u,close:()=>p(!1)},r.createElement(Ga,{close:()=>p(!1),value:t,layer:n,prop_name:c,onChange:e=>(d(e,"none"),void(u&&p(!1)))})))}));var ii=n(71932);const oi=r.memo((0,a.$j)(((e,t)=>{let n=t.value;switch(ii.Z[t.name].dataType){case"props":n=(0,Ta.getProperty)(t.layer.props,t.name);break;case"drawer":n=(0,Ta.getProperty)(t.layer.style,t.name);break;case"settings":n=(0,Ta.getProperty)(t.layer,t.name)}return{value:n}}))((({name:e,layer:t,value:n,onChange:a,forceArray:i})=>{za.Z.bValueTransformable(n)&&(n=n.value);const o=r.useRef(null),s=R.Z[e];let c=null!=n?n:s.default;const l=void 0===n||(d=n,u=s.default,typeof d==typeof u&&(Array.isArray(d)&&Array.isArray(u)?d[0]===u[0]&&d[1]===u[1]:d===u));var d,u;let p=s.canBArray?Array.isArray(c)?"multiple-range":"range":s.type;function f(n,r){n!==c&&(za.Z.bPropInSceneChildUtilitiesData(e)?za.Z.bValueTransformable(n)||(za.Z.bValueAnimation(n)?(za.Z.bValueTransformable(n.value.from)||(n.value.from={type:"transformable-prop",value:n.value.from}),za.Z.bValueTransformable(n.value.to)||(n.value.to={type:"transformable-prop",value:n.value.to})):n={type:"transformable-prop",value:n=i?(0,h.qo)(n):n}):n=i?(0,h.qo)(n):n,we.run("set-prop",{id:t.id,name:e,value:n,prev_value:c},r),a&&a(n,c))}"Line"===t.type&&"sideLength"==e&&Array.isArray(c)&&(c=(0,h.He)(c),p="range"),La(o,s,c,f);let m=null;switch(p){case"multiple-range":case"range":m=r.createElement(ri,{value:(g=c,Array.isArray(g)?g.slice():g),bDefaultValue:l,canBArray:s.canBArray||!1,initialArray:s.initialArray||!1,min:s.min,max:"repetitions"==e?"multiple-range"==p?20:100:s.max,step:s.step,type:p,name:s.label,prop_name:s.name,layer:t,onChange:f,animable:s.animable});break;case"radio":m=r.createElement(Aa,{onChange:f,name:s.label,selected:c,values:s.options});break;case"checkbox":m=r.createElement(Qn.Z,{checked:c,onChange:f,name:s.label});break;case"select":m=r.createElement(Ur.Z,{options:s.options,value:c,placeholder:s.label,onChange:f});break;case"color":m=r.createElement(ni,{layer:t,prop_name:e,value:c,name:s.label,onChange:f,bDefaultValue:void 0===n});break;case"slider":m=r.createElement(ai,{layer:t,name:s.label,prop_name:e,value:c,min:s.min,max:s.max,step:s.step,onChange:(e,t)=>f(e,"slider"==t),bDefaultValue:void 0===n})}var g;return r.createElement("div",{ref:o},m)})));var si=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};const ci=[{key:"Matrix",value:Oa.i.Matrix},{key:"Ring",value:Oa.i.Ring}],li=ii.Z.repetitions.max,di=ii.Z.distance.max;function ui(e){return Array.isArray(e.props.repetitions)?Oa.i.Matrix:Oa.i.Ring}const pi=r.memo((0,a.$j)((e=>({projectRatio:e.project.ratio})))((e=>{const t=e.layer;let n=t.props.repetitions||1,a=t.props.distance||0;const[i,o]=r.useState(ui(t));return r.useEffect((()=>{const e=ui(t);e!=i&&o(e)}),[t]),r.createElement(Sa,{name:"Repetition",icon:"repetitions",expandable:!0,expanded:!0},!za.Z.bValueAnimation(n)&&r.createElement(Aa,{selected:i,values:ci,name:"Type",onChange:function(e){if(e!==i){const r=e==Oa.i.Matrix?(0,h.x)(1,Math.round(li/5),(0,h.qo)(n)):(0,w.uZ)(1,li,(0,h.He)(n)),i=[{id:t.id,name:"repetitions",value:r,prev_value:n}];if(!za.Z.bValueAnimation(a)){const n=za.Z.bValueTransformable(a)?a.value:a,r=e==Oa.i.Matrix?(0,h.x)(-di,di,(0,h.qo)(n)):(0,w.uZ)(-di,di,(0,h.He)(n));i.push({id:t.id,name:"distance",value:{type:"transformable-prop",value:r},prev_value:a})}we.run("set-prop",i),o(e)}}}),r.createElement(oi,{layer:t,name:"repetitions",onChange:e=>n=e,forceArray:i==Oa.i.Matrix}),r.createElement(oi,{layer:t,name:"distance",onChange:e=>a=e}),i==Oa.i.Ring&&r.createElement(oi,{layer:t,name:"displace"}),!za.Z.bValueAnimation(n)&&r.createElement("small",{style:{textAlign:"right",cursor:"pointer"},onClick:()=>function(){return si(this,void 0,void 0,(function*(){if(i==Oa.i.Matrix){const e=(0,h.qo)(n),r=[e[1]<=1?0:100/e[1],e[0]<=1?0:100/e[0]];we.run("set-prop",{id:t.id,name:"distance",value:{type:"transformable-prop",value:r},prev_value:a})}else{const e=(0,h.He)(n);if(1==e)we.run("set-prop",{id:t.id,name:"distance",value:0,prev_value:a});else{const n=yield we.ask("single-bounding",{id:t.id}),r=e<=1?0:50*n.width/(Math.PI/(e+1));we.run("set-prop",{id:t.id,name:"distance",value:{type:"transformable-prop",value:(0,w.uZ)(-100,100,r)},prev_value:a})}}}))}()},"Distribute"),t.depth>0&&r.createElement("div",{style:{textAlign:"right",cursor:"pointer"}},r.createElement("div",{style:{display:"inline-block"}},r.createElement(oi,{layer:t,name:"bUseParent"}))))}))),hi=r.memo((({layer:e})=>r.createElement(Sa,{name:"Primitive settings",icon:"primitive",expandable:!0,expanded:!0},r.createElement(oi,{layer:e,name:"sideLength"}),e.shape&&r.createElement("div",{style:{textAlign:"right"}},r.createElement("div",{style:{display:"inline-block",verticalAlign:"middle",cursor:"pointer"}},r.createElement(On,{title:"Subdivide buffer",position:"left"},r.createElement("div",{onClick:function(){we.run("subdivide",{id:e.id})}},"Subdivide")))),"Polygon"===e.type&&r.createElement(oi,{layer:e,name:"sideNumber"}),"Rose"===e.type&&r.createElement(r.Fragment,null,r.createElement(oi,{layer:e,name:"n"}),r.createElement(oi,{layer:e,name:"d"})),"Lissajous"===e.type&&r.createElement(r.Fragment,null,r.createElement(oi,{layer:e,name:"wx"}),r.createElement(oi,{layer:e,name:"wy"}),r.createElement(oi,{layer:e,name:"wz"})),"Spiral"===e.type&&r.createElement(r.Fragment,null,r.createElement(oi,{layer:e,name:"twists"}),r.createElement(oi,{layer:e,name:"twistsStart"}),r.createElement("div",{style:{display:"flex",gap:i.Z.ms(0)}},r.createElement("span",null,"Spiral type"),r.createElement("div",{style:{flex:1}},r.createElement(oi,{layer:e,name:"spiral"})))),"SuperShape"===e.type&&r.createElement(r.Fragment,null,r.createElement(oi,{layer:e,name:"a"}),r.createElement(oi,{layer:e,name:"b"}),r.createElement(oi,{layer:e,name:"m"}),r.createElement(oi,{layer:e,name:"n1"}),r.createElement(oi,{layer:e,name:"n2"}),r.createElement(oi,{layer:e,name:"n3"})),r.createElement("div",{style:{textAlign:"right"}},r.createElement("div",{style:{display:"inline-block",verticalAlign:"middle"}},r.createElement(oi,{layer:e,name:"bClosed"}))),r.createElement(oi,{layer:e,name:"adaptMode"})))),fi=r.memo((e=>{const t=e.layer;return r.createElement(Sa,{name:"Transformations",icon:"transform",expandable:!0,expanded:!0},r.createElement(oi,{layer:t,name:"scale"}),r.createElement(oi,{layer:t,name:"translate"}),r.createElement(oi,{layer:t,name:"squeezeX"}),r.createElement(oi,{layer:t,name:"squeezeY"}),r.createElement(oi,{layer:t,name:"skewX"}),r.createElement(oi,{layer:t,name:"skewY"}),r.createElement(oi,{layer:t,name:"rotateX"}),r.createElement(oi,{layer:t,name:"rotateY"}),r.createElement(oi,{layer:t,name:"rotateZ"}),r.createElement(oi,{layer:t,name:"transformOrigin"}),r.createElement(oi,{layer:t,name:"perspective"}),r.createElement(oi,{layer:t,name:"perspectiveOrigin"}),r.createElement("div",{style:{textAlign:"right"}},r.createElement("div",{style:{display:"inline-block",verticalAlign:"middle",cursor:"pointer"}},r.createElement("div",{onClick:function(){(0,Xe.o2)(t.id+"")}},r.createElement(Gn.Z,{name:"visual-editor"}),r.createElement("span",{style:{display:"inline-block",verticalAlign:"middle",marginLeft:i.Z.ms(-2)}},"Apply point transformation")))))})),mi=r.memo((e=>{const t=e.layer;return r.createElement(Sa,{name:"Loop generation",icon:"loop",expandable:!0,expanded:!0},r.createElement("div",{style:{textAlign:"center"}},r.createElement("div",{style:{display:"inline-block",verticalAlign:"middle",cursor:"pointer"}},r.createElement("div",{onClick:function(){(0,Xe.Z8)(t.id)}},r.createElement(Gn.Z,{name:"visual-editor"}),r.createElement("span",{style:{display:"inline-block",verticalAlign:"middle",marginLeft:i.Z.ms(-2)}},"Generate Shape")))))}));var gi=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};const vi=r.memo((0,a.$j)((e=>({bGhost:e.project.ghosts>0})))((({layer:e,bGhost:t})=>{const[n,a]=r.useState(!!e.data.disableGhost);return r.useEffect((()=>{e.data.disableGhost!==n&&a(!!e.data.disableGhost)}),[e.id]),r.createElement(Sa,{name:"Style",icon:"style",expandable:!0,expanded:!0},r.createElement(qn,{columns:4,gap:i.Z.ms(-2),flow:"max-content max-content auto max-content",valign:"center",style:{width:"100%",overflow:"hidden"}},r.createElement(oi,{layer:e,name:"fill"}),r.createElement(oi,{layer:e,name:"stroke"}),r.createElement(oi,{layer:e,name:"lineWidth"}),r.createElement("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column"}},t&&r.createElement(r.Fragment,null,r.createElement("small",{style:{lineHeight:1,marginBottom:i.Z.ms(-2)}},"Disable Ghost"),r.createElement("div",{style:{display:"flex",height:i.Z.add(1,-1),alignItems:"center",justifyContent:"center"}},r.createElement(Qn.Z,{checked:n,name:"",onChange:function(){return gi(this,void 0,void 0,(function*(){const t=!n;yield we.ask("layer-ghost",{id:e.id,status:t}),a(t)}))},size:1}))))))}))),yi=(0,a.$j)((e=>({selected_layer:e.project.open_layer_properties})),(e=>({selectLayer:t=>e((0,ve.vl)([t]))})))((({selected_layer:e,selectLayer:t})=>r.createElement("section",{"data-name":"properties",style:{maxHeight:"100%",overflow:"auto"}},e?r.createElement(r.Fragment,null,r.createElement(Ca,{layer:e,selectLayer:t}),"ShapeLoop"===e.type&&r.createElement(mi,{layer:e}),(e.bPrimitive||"Group"===e.type)&&r.createElement(vi,{layer:e}),r.createElement(pi,{layer:e}),e.bPrimitive&&r.createElement(hi,{layer:e}),r.createElement(fi,{layer:e})):r.createElement("i",null,"Select layer to change properties")))),bi={style:{width:"100vw",height:"100%",overflow:"hidden",padding:`0 ${i.Z.ms(0)}`},columns:2,flow:"repeat(2, minmax(0, 1fr))",component:"section",gap:i.Z.ms(0)},wi={columns:2,rows:2,valign:"start",flow:"auto max-content / max-content auto",gap:i.Z.ms(0),style:{height:`calc(100vh - ${i.Z.add(2,1)})`}},_i={columns:2,valign:"start",flow:"repeat(2, minmax(0, 1fr))",gap:i.Z.ms(0),style:{height:"100%",overflow:"hidden"}},xi=()=>r.createElement(qn,Object.assign({},bi,{id:"workspace"}),r.createElement(qn,Object.assign({},wi),r.createElement(zn,null),r.createElement(Gr,null),r.createElement("div",{style:{gridColumn:"1 / span 2"}},r.createElement(aa,null))),r.createElement(qn,Object.assign({},_i),r.createElement(xa,null),r.createElement(yi,null))),Ei=['{"id":"eb94f280-5dd0-11eb-a957-dbb3bcd0c558","urpflanze_version":"%VERSION%","name":"EmptyProject","width":922,"height":498.37837837837833,"resolution":600,"background":"#111413","color":"#5c6361","clear":true,"ghosts":10,"ghostSkipTime":15,"ratio":1.85,"scene":{"7bd501c0-5a9b-11eb-a564-c1b5010acd62":{"id":"7bd501c0-5a9b-11eb-a564-c1b5010acd62","type":"Shape","name":"Shape_1","order":0,"data":{"visible":true},"depth":0,"bPrimitive":false,"props":{"distance":{"type":"simple","value":{"from":{"type":"transformable-prop","value":-10},"to":{"type":"transformable-prop","value":15},"duration":3000,"invertOdd":false,"colorTransitionMode":"rgb","type":"loop","mode":"sinusoidal","modeFunction":"cos","delay":0}},"repetitions":6,"rotateX":{"type":"transformable-prop"},"rotateY":0,"rotateZ":0,"squeezeY":0,"displace":{"type":"simple","value":{"from":{"type":"transformable-prop","value":0},"to":{"type":"transformable-prop","value":360},"duration":6000,"invertOdd":false,"colorTransitionMode":"rgb","type":"static","mode":"easing","modeFunction":"linear","delay":0}},"translate":{"type":"transformable-prop","value":[0,22.7]},"scale":1,"transformOrigin":[0,0],"perspective":0,"perspectiveOrigin":[0,0]},"style":{},"bUseParent":false,"bUseRecursion":false,"children":[{"id":"72080110-5a9b-11eb-a564-c1b5010acd62","type":"Circle","name":"Circle_1","data":{"visible":true},"depth":1,"bPrimitive":true,"props":{"distance":{"type":"simple","value":{"from":{"type":"transformable-prop","value":0},"to":{"type":"transformable-prop","value":15},"duration":2000,"invertOdd":false,"colorTransitionMode":"rgb","type":"loop","mode":"sinusoidal","modeFunction":"sin","delay":0}},"repetitions":39,"scale":0.56,"sideLength":{"type":"transformable-prop","value":1}},"style":{"fill":{"type":"simple","value":{"from":"hsla(37, 100%, 56%, 0.41)","to":"hsla(207, 100%, 50%, 0.26)","duration":2000,"invertOdd":false,"colorTransitionMode":"hue","type":"loop","mode":"sinusoidal","modeFunction":"sin","delay":0}}},"parentId":"7bd501c0-5a9b-11eb-a564-c1b5010acd62","bUseParent":false,"bUseRecursion":false,"adaptMode":0,"bClosed":true}]}},"sequence":{"duration":6000,"framerate":60}}'],Zi=[],ki=o.F4`from { opacity: 1; } to { opacity: 0; } `,Si=o.ZP.div`
	position: relative;
	width: 500px;
	height: 270px;
	overflow: hidden;
	position: relative;

	&:after {
		position: absolute;
		top: 0;
		left: 0;
		display: block;
		content: ' ';
		width: 100%;
		height: 100%;
		background: ${i.Z.color("dark")};
		animation: ${ki} 0.5s 0.1s linear both;
	}

	canvas {
		width: 100% !important;
		height: auto !important;
	}
`,Ci=r.memo((()=>{const e=r.createRef();return r.useEffect((()=>{let t;if(e.current)if(Math.random()>1){const t=new Image;t.addEventListener("load",(()=>{var n;e.current&&(null===(n=e.current.getContext("2d"))||void 0===n||n.drawImage(t,0,0))})),e.current.width=1024,e.current.height=1024,e.current.style.transform="translateY(-25%)",t.src="/assets/images/examples/"+(0,O.randomElement)(Zi)}else t=H.Z.parse((0,O.randomElement)(Ei)),t&&(t.setBuffering(!0),t.setCanvas(e.current),null==t||t.startAnimation());return()=>{t&&t.stopAnimation()}}),[e.current]),r.createElement("div",{style:{position:"relative"}},r.createElement(Si,null,r.createElement("canvas",{ref:e})),r.createElement("div",{style:{background:"linear-gradient(0deg, rgba(0,0,0, 0.4) 0%, rgba(0,0,0,0) 80%)",position:"absolute",bottom:-1,left:0,width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:`${i.Z.ms(-1)} ${i.Z.ms(0)}`,color:"rgba(255,255,255,.4)"}},r.createElement("div",null,"Author"),r.createElement("div",null,"Send yours")))})),Oi=o.ZP.div`
	position: fixed;
	top: 50%;
	left: 50%;
	background: ${i.Z.color("dark-lighten")};
	transform: translate(-50%, -50%);
	box-shadow: 0 ${i.Z.ms(0)} ${i.Z.ms(2)} ${i.Z.ms(0)} rgba(0, 0, 0, 0.5);
	border-radius: 2px;
	z-index: 12;
`,Pi=r.memo((0,a.$j)(null,(e=>({hide:()=>e((0,ye.hf)()),showTutorial:()=>e((0,ye.Sg)())})))((({hide:e,showTutorial:t})=>{const n=we.hasAutosave();return r.createElement(r.Fragment,null,r.createElement("div",{style:{position:"fixed",zIndex:11,top:0,left:0,width:"100vw",height:"100vh"},onClick:e}),r.createElement(Oi,null,r.createElement(Ci,null),r.createElement("div",{style:{padding:i.Z.ms(2)}},r.createElement("h2",{style:{marginBottom:i.Z.ms(0)}},"Work in progress"," ",r.createElement("small",{style:{fontSize:".8rem",fontWeight:"initial"}},"v",Ae.Z.app_version)),r.createElement(qn,{rows:2,flow:"max-content max-content",gap:i.Z.ms(0)},r.createElement(qn,{columns:2},r.createElement("div",{onClick:function(){e(),t()}},"Tutorial 👋"),r.createElement("div",null)),r.createElement(qn,{columns:2},r.createElement("div",null,r.createElement("div",{style:{cursor:"pointer"},onClick:()=>{ze((()=>e()))}},"New"),r.createElement("div",{style:{cursor:"pointer"},onClick:()=>{Fe(!1,(()=>e()))}},"Open"),r.createElement("div",{style:{opacity:n?1:.2,cursor:n?"pointer":""},onClick:()=>{we.hasAutosave()&&(we.restoreAutosave(),e())}},"Recover Last Session")),r.createElement("div",null))))))}))),Ai={position:"fixed",zIndex:11,top:0,left:0,width:"100vw",height:"100vh"},ji={position:"fixed",top:"50%",left:"50%",background:i.Z.color("dark-lighten").toString("hex"),transform:"translate(-50%, -50%)",boxShadow:`0 ${i.Z.ms(0)} ${i.Z.ms(2)} ${i.Z.ms(0)} rgba(0, 0, 0, 0.5)`,borderRadius:"2px",zIndex:12,padding:i.Z.ms(2)},Mi=r.memo((0,a.$j)(null,(e=>({hide:()=>e((0,ye.vZ)())})))((({hide:e})=>r.createElement("div",{style:Ai},r.createElement("div",{style:ji},r.createElement("div",{style:{overflow:"hidden",width:"100%",maxWidth:"36vw"}},r.createElement("h2",null,"Sorry!"),r.createElement("p",null,"Will be available soon")),r.createElement("div",{style:{marginTop:i.Z.ms(0),textAlign:"right"},onClick:e},r.createElement(Da,{label:"Close"}))))))),Ti=r.memo((({render:e,ratio:t,settings:n})=>{const a=r.createRef(),[o,s]=r.useState("image"),[c,l]=r.useState(1);return r.useEffect((()=>{if(e&&a.current){const r=a.current,i=r.getContext("2d",{alpha:!0});let s=t>=1?n.size:n.size*t,l=t>=1?n.size/t:n.size;if(s>n.size){const e=s/l;s=n.size,l=n.size/e}else if(l>n.size){const e=l/s;l=n.size,s=n.size/e}if(r.width=s,r.height=l,i.clearRect(0,0,r.width,r.height),"pattern"==o&&c>1){r.width*=c,r.height*=c;const t=i.createPattern(e,"repeat");i.fillStyle=t,i.fillRect(0,0,r.width,r.height)}else i.drawImage(e,0,0,r.width,r.height)}}),[e,c]),r.createElement("div",{style:{position:"relative"}},r.createElement("div",{style:{display:"flex",justifyContent:"space-between",padding:`0 ${i.Z.ms(0)} ${i.Z.ms(0)} ${i.Z.ms(0)}`}},r.createElement(Aa,{name:"Preview type",selected:o,values:[{key:"Image",value:"image"},{key:"Pattern",value:"pattern"}],onChange:e=>s(e)}),r.createElement("div",null,"pattern"==o&&r.createElement("div",{style:{display:"flex",alignItems:"center"}},r.createElement("small",null,"Tiles"),r.createElement("div",null,r.createElement(Gn.Z,{size:0,rotate:180,name:"arrow-right",disabled:c<=1,onClick:e=>c>1&&l(c-1)}),r.createElement("small",null,c),r.createElement(Gn.Z,{size:0,name:"arrow-right",disabled:c>=5,onClick:e=>c<5&&l(c+1)}))))),r.createElement("div",{style:{width:"100%",height:"100%",lineHeight:0,fontSize:0,backgroundImage:"url(/assets/images/png-background.png)",display:"flex",alignItems:"center",justifyContent:"center"}},r.createElement("canvas",{ref:a,style:{maxWidth:"100%",maxHeight:"100%"}})))})),Ii=[256,512,1024,2048,4096,8192].map((e=>({key:e,value:e}))),Li=r.memo((({settings:e,setSettings:t,downloadSize:n})=>r.createElement("div",null,r.createElement(Aa,{name:"Image type",selected:e.type,values:[{key:"JPEG",value:"image/jpeg"},{key:"PNG",value:"image/png"},{key:"SVG",value:"image/svg+xml"}],onChange:n=>t(Object.assign(Object.assign({},e),{type:n}))}),"image/svg+xml"!==e.type&&r.createElement(Ur.Z,{value:e.size,placeholder:"Size",options:Ii,onChange:n=>t(Object.assign(Object.assign({},e),{size:n}))}),r.createElement(_r,{value:e.quality,min:.1,max:1,step:.1,onChange:n=>t(Object.assign(Object.assign({},e),{quality:n}))}),"image/jpeg"!==e.type&&r.createElement(Qn.Z,{checked:e.noBackground,onChange:n=>t(Object.assign(Object.assign({},e),{noBackground:n})),name:"Remove background color"}),n&&r.createElement("div",null,n))));var $i=n(87163),Ri=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};const Di=o.ZP.div`
	svg {
		width: 100%;
		height: 100%;
	}
`,Bi=r.memo((0,a.$j)((e=>({project:e.project})))((({project:e,closeModal:t})=>{const[n,a]=r.useState(null),[o,s]=r.useState({size:1024,quality:.8,time:0,type:"image/jpeg",noBackground:!1}),[c,l]=r.useState(!1),[d,u]=r.useState(null),[p,f]=r.useState(null);return r.useEffect((()=>()=>{we.ask("render-stop")}),[]),r.createElement("div",null,r.createElement(qn,{columns:2,style:{width:i.Z.add(7,5)}},r.createElement("div",{style:{width:i.Z.ms(7),position:"relative"}},c&&r.createElement("div",{style:{position:"absolute",zIndex:1,background:"rgba(255,255,255,.4)",width:"100%",height:"100%"}},r.createElement($i.Z,null)),n?r.createElement(Di,null,r.createElement("div",{dangerouslySetInnerHTML:{__html:n}})):r.createElement(Ti,{ratio:e.ratio,render:d,settings:o})),r.createElement("div",null,r.createElement(Li,{settings:o,setSettings:s,downloadSize:p}),r.createElement("button",{disabled:c,onClick:function(){return Ri(this,void 0,void 0,(function*(){if(!c){l(!0);const e=yield we.ask("render-image",{settings:o});if("image/svg+xml"===o.type)a(e.svg),l(!1);else{const t=new Blob([e],{type:o.type}),n=new Image;n.addEventListener("load",(()=>{u(n),l(!1),f((0,h.fm)(t.size))}),{passive:!0}),n.src=window.URL.createObjectURL(t)}}}))}},"render"),(n||d)&&r.createElement("div",{onClick:()=>function(){if(n||d){const t="image/jpeg"===o.type?"jpg":"image/svg+xml"===o.type?"svg":"png";Me(e.name+"."+t,n||d,o.type)}}()},"download"))),r.createElement("div",{style:{padding:`${i.Z.ms(0)} ${i.Z.ms(-1)} 0`}},r.createElement(ta,{enableMoveTime:!0,sequence_duration:e.sequence.duration,sequence_framerate:e.sequence.framerate,renderedFrames:[],current_time:o.time,onChange:e=>s(Object.assign(Object.assign({},o),{time:e})),steps:8})),r.createElement("div",{onClick:t},"Close"))})));var zi=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};const Fi={estimated_time:0,forPart:0,total_frames:0,total_parts:0,start_time:0,remaining_time:0,current_frame:0,progress_percentage:0},qi=[256,512,1080,1024,2048,4096,8192].map((e=>({key:e,value:e}))),Ui=r.memo((0,a.$j)((e=>({project:e.project})))((({project:e,closeModal:t})=>{const[n,a]=r.useState(!1),[i,o]=r.useState(!1),[s,c]=r.useState(Fi),[l,d]=r.useState({index:0,samples:[]}),[u,p]=r.useState({size:1080,quality:1,time:0,type:"image/jpeg",noBackground:!1}),[f,m]=r.useState(null);function g(e){const t=l.samples.length;let n=e;if(t>0){let e=0;for(let n=0;n<t;n++)e+=l.samples[n];n=Math.round(e/t)}return l.samples[l.index]=Math.round(e),l.index=(l.index+1)%100,d(Object.assign({},l)),n}function v(t){f&&f.length>0&&f.length>=t&&Me(`${e.name&&e.name.length>0?e.name:Ae.Z.empty_project_name}_part_${t+1}`,f[t],"application/zip")}function y(){return zi(this,void 0,void 0,(function*(){console.log("stop"),o(!0),yield we.ask("render-stop"),a(!1),o(!1)}))}return r.useEffect((()=>{function t(e){const t=e;c(Object.assign(Object.assign({},t),{start_time:(0,h.zO)(),remaining_time:t.estimated_time,current_frame:0,progress_percentage:0}))}function n(t){const n=t,r=Math.round(100*++n.frame/s.total_frames*100)/100;document.title=r+"% "+e.name,c(Object.assign(Object.assign({},s),{remaining_time:g(n.render_time)*s.total_frames-((0,h.zO)()-s.start_time),current_frame:n.frame+1,progress_percentage:r}))}return we.attach("renderer:start",t),we.attach("renderer:render-frame",n),()=>{we.detach("renderer:start",t),we.detach("renderer:render-frame",n)}}),[s,l,n]),r.createElement("div",null,i&&r.createElement("div",null,"wait stop..."),r.createElement(Ur.Z,{value:u.size,placeholder:"Size",options:qi,onChange:e=>p(Object.assign(Object.assign({},u),{size:e}))}),r.createElement("button",{onClick:function(){return zi(this,void 0,void 0,(function*(){a(!0);const e=yield we.ask("render-animation",{settings:u});m(e),a(!1)}))},disabled:n},"render"),r.createElement("button",{onClick:y,disabled:!n},"stop"),r.createElement("div",null,"frame: ",s.current_frame," su ",s.total_frames,r.createElement("br",null),"part: ",s.total_parts,r.createElement("br",null),"rem: ",s.remaining_time<=0?0:Math.floor(s.remaining_time/1e3),"s",r.createElement("br",null),"prog: ",s.progress_percentage,"%",r.createElement("br",null)),f&&r.createElement("div",null,f.map(((e,t)=>r.createElement("div",{key:t,onClick:()=>v(t)},"zip_part_",t+1," - ",(0,h.fm)(e.size)))),r.createElement("div",{onClick:function(){if(f&&f.length>0)for(let e=0;e<f.length;e++)v(e)}},"download all")),r.createElement("div",{onClick:function(){return zi(this,void 0,void 0,(function*(){yield y(),document.title=Ae.Z.getDocumentProjectTitle(e.name),t()}))}},"Close"))})));var Ni=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};const Vi=r.memo((0,a.$j)((e=>({project:e.project})))((()=>{const[e,t]=r.useState(ee.Z.defaults),[n,a]=r.useState("");return console.log(e),r.createElement("div",null,Object.keys(e).map((n=>r.createElement("div",{key:n},n," ",r.createElement("input",{className:"input",type:"text",value:e[n],name:n,onChange:n=>{return r=n.target.name,a=n.target.value,["penUpCommand","penDownCommand"].includes(r)||(a=parseFloat(a)),void t(Object.assign(Object.assign({},e),{[r]:a}));var r,a}})))),r.createElement("button",{onClick:function(){return Ni(this,void 0,void 0,(function*(){console.log("settings",e);const t=yield we.ask("export-gcode",{settings:e});console.log("OK"),a(t)}))}},"Generate"),r.createElement("textarea",{className:"input textarea",value:n,readOnly:!0,style:{width:"400px",height:"400px"}}))}))),Gi=r.memo((0,a.$j)((e=>({modal:e.app.opened_modal,modal_props:e.app.opened_modal_props})),(e=>({closeModal:()=>e((0,ye.h7)(void 0))})))((({modal:e,modal_props:t,closeModal:n})=>e?r.createElement(Qa,{open:!0,close:n,noCloseButton:"render-animation"==e||"render-image"==e},function(e){switch(e){case"render-image":return r.createElement(Bi,Object.assign({},t,{closeModal:n}));case"render-animation":return r.createElement(Ui,Object.assign({},t,{closeModal:n}));case"generate-gcode":return r.createElement(Vi,Object.assign({},t,{closeModal:n}))}}(e)):null))),Hi={rows:3,flow:`${i.Z.ms(2)} auto ${i.Z.ms(1)}`,style:{height:"100vh"},component:"section"},Yi=r.memo((0,a.$j)((e=>({bTutorial:e.app.bTutorial,bSplashScreen:e.app.bSplashScreen})))((({bSplashScreen:e,bTutorial:t})=>r.createElement(r.Fragment,null,r.createElement(qn,Object.assign({},Hi),r.createElement(xn,null),r.createElement(xi,null),r.createElement(Mn,null),r.createElement($n,null)),t&&r.createElement(Mi,null),e&&r.createElement(Pi,null),r.createElement(Gi,null)))))}}]);